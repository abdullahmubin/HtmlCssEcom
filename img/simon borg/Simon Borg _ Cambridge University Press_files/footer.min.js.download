function initListingTypes(){$(".refinePanel").length>0&&$(".refinePanel h3 a").each(function(){"block"==$(this).parent().parent().find(".optionsHidden").css("display")&&$(this).addClass("open")}),$("a.resultsListing").click(function(){return $(this).parent().parent().parent().removeClass("grid").addClass("listing"),clearResultsMaxHeight(),!1});var $windowWidth=$(window).width();750>=$windowWidth||767>=$windowWidth&&$.browser.webkit||($("a.resultsListing").css("display","block"),$("a.resultsGrid").css("display","block")),$("a.resultsGrid").click(function(){return $(this).parent().parent().parent().removeClass("listing").addClass("grid"),window.setTimeout(function(){setGridResultsToMaxHeight()},100),!1}),$(".refinePanel h3 a,.refinePanel p.facet-header a").not(".refineEnabled").click(function(){return"heading_Subjects"==this.id?($("#topSubjects").toggle("fast"),$("#topSubjects").next().toggle("fast"),$(this).toggleClass("open"),"Show All Subjects"==$("#heading_Subjects span").html()?$("#heading_Subjects span").html("Show Top Subjects"):$("#heading_Subjects span").html("Show All Subjects")):$(this).toggleClass("open").parent().next().slideToggle("fast"),!1}).addClass("refineEnabled"),$("#topSubjects h3 a").click(function(){return $(this).toggleClass("open").parent().next().slideToggle("fast"),!1})}function setGridResultsToMaxHeight(){CURRENT_THEME==LEARNING_THEME_HANDLE?1==$("#cambridgeenglishTab").length?$("#cambridgeenglishTab").hasClass("active")?$("#cambridgeenglishTab div.grid .bookCover").setAllToMaxHeight():($("#relatedTab div.relatedSearch.grid h2").setAllToMaxHeight(),$("#relatedTab div.relatedSearch.grid h3").setAllToMaxHeight()):$("div.grid .bookCover").setAllToMaxHeight():$(".productsItem").setAllToMaxHeight(),$(".productsItem .three .buyProduct:last-child").addClass("marginedBottom")}function clearResultsMaxHeight(){CURRENT_THEME==LEARNING_THEME_HANDLE?1==$("#cambridgeenglishTab").length?$("#cambridgeenglishTab").hasClass("active")?$("#cambridgeenglishTab .bookCover").css("height",""):($("#relatedTab .relatedSearch h2").css("height",""),$("#relatedTab .relatedSearch h3").css("height","")):$(".bookCover").css("height",""):$(".productsItem").css("height",""),$(".marginedBottom").removeClass("marginedBottom")}function changeToGrayArrows(){$(".homepageHero .flex-direction-nav li a").css("background","url("+grayArrows+") no-repeat"),$(".homepageHero .flex-direction-nav li .flex-prev").css("background-position","right 0")}function changeToWhiteArrows(){$(".homepageHero .flex-direction-nav li a").css("background","url("+whiteArrows+") no-repeat"),$(".homepageHero .flex-direction-nav li .flex-prev").css("background-position","right 0")}function changeToBlueArrows(){$(".homepageHero .flex-direction-nav li a").css("background","url("+blueArrows+") no-repeat"),$(".homepageHero .flex-direction-nav li .flex-prev").css("background-position","right 0")}function showSelectedTab(tabName){$("#"+tabName+"Tab").closest(".tabs-content").children("li").removeClass("active").hide(),$("#"+tabName+"Tab").css("display","block").addClass("active"),$("#product-tabs").children("dd").removeClass("active"),ucTabeName=tabName.charAt(0).toUpperCase()+tabName.slice(1),$(".tab"+ucTabeName).parent().addClass("active"),$(window).width()<768&&("contents"==tabName?$("#selected-tab").text("CONTENTS"):"authors"==tabName&&$("#selected-tab").text("ABOUT THE AUTHORS"))}function setFacetArrowsAndBoxes(){if($(".webSubjectCb").each(function(){var childCount="."+$(this).attr("id")+"_child",checkedChildCount="."+$(this).attr("id")+"_child:checked",webSubjArrow=$(this).parent().find("i.web-subject-arrow");$(childCount).length==$(checkedChildCount).length?($(this).attr("checked","checked"),$(this).parent().find("div.dark-checkbox-bg").attr("style","visibility: hidden;")):$(checkedChildCount).length>0?($(this).removeAttr("checked"),$(this).addClass("webSubjectGreyed"),$(this).parent().find("div.dark-checkbox-bg").removeAttr("style")):(webSubjArrow.removeClass("fa-angle-up"),webSubjArrow.addClass("fa-angle-down"),$(this).parent().find("div.dark-checkbox-bg").attr("style","visibility: hidden;"))}),"Academic_v1"==$("input[name='currentTheme']").val()){var filters=$(".refineChunk .optionsHidden .options input:checkbox:checked").map(function(){return $(this).val()}).get();filters.length>0||$("div.refinePanel div.refineChunk select").val()?$("div.refinePanel div.refineChunk a.clearLink").show():$("div.refinePanel div.refineChunk a.clearLink").hide()}else 0===$("input.pivotCb").length||$("input.pivotCb:checked").length>0?$("div.refinePanel div.refineChunk a.clearLink").removeClass("hide"):$("div.refinePanel div.refineChunk a.clearLink").addClass("hide");$("div.webSubject").each(function(){var clearAllLink=$(this).find("label.clear-all");$(this).find("ul.family-name-list li input.pivotCb:checked").length>0?clearAllLink.parent().show():clearAllLink.parent().hide()});for(var facetId in openedFacets){var facet=$("#"+openedFacets[facetId]),webSubjArrow=facet.parent().find("i.web-subject-arrow");webSubjArrow.removeClass("fa-angle-down"),webSubjArrow.addClass("fa-angle-up"),facet.attr("style","margin-left: 6%; display:block;")}}function changeLinks(){".authorPriceContainer".length&&$.each($(".authorPriceContainer > .pretty.dk"),function(){var parent=$(this).parent().parent();changeDkLabel(parent.find(".dk_container.dk_theme_default"),parent.find(".dk_container.dk_theme_default").find(".dk_label").text())}),$(".callToActions .dk_options_inner > li > a").click(function(){var callToActions=$(this).attr("data-dk-dropdown-value"),parent=$(this).parent().parent().parent().parent().parent().parent();changeHrefFormat(parent,callToActions)}),$.each($(".dynamicFormatCartMenu"),function(a,b){var parent=$(this).parent().parent();changeHrefFormat(parent,b.value)})}function renameProductLink(element){-1!==element.attr("href").indexOf("?format")&&element.attr("href",element.attr("href").substring(0,element.attr("href").indexOf("?format"))),-1!==element.attr("data-url").indexOf("?format")&&element.attr("data-url",element.attr("data-url").substring(0,element.attr("data-url").indexOf("?format")))}function changeHrefFormat(parent,callToActions){if(void 0!=parent&&void 0!=callToActions){var bookCover=parent.find(".bookCover > a"),bookDetails=parent.find(".bookDetailsWrap > h2 > a");renameProductLink(bookCover),renameProductLink(bookDetails),parts=callToActions.split("_");var isbn=$.isArray(parts)?parts[0]:"";if("Learning"==CURRENT_THEME)bookCover.attr("href",bookCover.attr("data-url")+"?format="+parts[1]+"&isbn="+isbn),bookDetails.attr("href",bookDetails.attr("data-url")+"?format="+parts[1]+"&isbn="+isbn);else{var has_param=GetURLParameter("format",bookCover.attr("data-url"));if("undefined"==typeof has_param)var new_bookCover=bookCover.attr("data-url")+"?format="+parts[1],new_bookDetails=bookDetails.attr("data-url")+"?format="+parts[1];else var new_bookCover=bookCover.attr("data-url").replace("?format="+has_param,"?format="+parts[1]),new_bookDetails=bookDetails.attr("data-url").replace("?format="+has_param,"?format="+parts[1]);-1!==$.inArray(parts[1].toUpperCase(),["WW","WX"])&&(new_bookCover+="&isbn="+isbn,new_bookDetails+="&isbn="+isbn,changeDkLabel(parent.find(".dk_container.dk_theme_default"),parent.find(".dk_container.dk_theme_default").find(".dk_label").text())),bookCover.attr("href",new_bookCover),bookDetails.attr("href",new_bookDetails),$(bookCover).find("img").attr("src",$("#"+callToActions).val())}var date=parent.find("#date_"+callToActions).val();(void 0==date||""==date)&&(date="No date available"),parent.find(".publicationDate").html("<strong>Publication date</strong>: "+date),parent.find(".ean").html("<strong>ISBN</strong>: "+isbn)}}function updateShareLinks(url,title){$("#share-link").val(url),""!=url&&(url=escape(url)),title=void 0!=title&&""!=title?escape(title):"";var defaultShareLinks=[{service:"StumbleUpon",className:"shareStumbleUpon",url:"http://www.stumbleupon.com/submit?url="+url+"&title="+title},{service:"Facebook",className:"shareFacebook",url:"http://www.facebook.com/sharer/sharer.php?s=100&p[url]="+url+"&p[title]="+title},{service:"Pinterest",className:"sharePinterest",url:"http://pinterest.com/pin/create/button/?url="+url+"&description="+title},{service:"Twitter",className:"shareTwitter",url:"http://twitter.com/home?status="+title+" "+url},{service:"Digg",className:"shareDigg",url:"http://www.digg.com/submit?url="+url+"&title="+title},{service:"Delicious",className:"shareDelicious",url:"http://del.icio.us/post?url="+url+"&title="+title}];for(var i in defaultShareLinks)link=defaultShareLinks[i],$("li."+link.className+" a").attr("href",link.url)}function attachPaginationAjaxFunctionality(){$(".ajaxPagination").size()>0&&$("div.listingPagination a").not(".ajaxEnabled").click(function(){var tab=$("dl.tabs dd.active > a").first().attr("id"),url=$(this).attr("href"),layout=$("#layout").val(),foundTab=!1,foundLayoutParam=!1,urlSplit=Array(),urlParts=Array();if(-1!==url.indexOf("?")){urlSplit=url.split("?"),urlParts=urlSplit[1],urlParts=urlParts.split("&");for(var i in urlParts){var fieldParts=urlParts[i].split("=");if("tab"==fieldParts[0]&&(urlParts[i]="tab="+tab,foundTab=!0),"layout"==fieldParts[0]&&(urlParts[i]="layout="+layout,foundLayoutParam=!0),foundLayoutParam&&foundTab)break}}else urlSplit.push(url);if(foundLayoutParam||urlParts.push("layout="+layout),foundTab||urlParts.push("tab="+tab),"undefined"!=typeof UrlUtil){var urlUtil=new UrlUtil,urlParams=urlUtil.getUrlParams(),addParameters=function(paramKey){$.each(urlParts,function(index,val){null!==val&&"undefined"!=typeof val&&-1!==val.indexOf(paramKey)&&urlParts.splice(index,1),$.isArray(urlParams[paramKey])&&$.each(urlParts,function(index,val){"string"==typeof val&&-1!==val.indexOf(paramKey)&&urlParts.splice(index,1)})}),$.isArray(urlParams[paramKey])&&$.each(urlParams[paramKey],function(index,val){-1===$.inArray(paramKey+"="+val,urlParts)&&urlParts.push(paramKey+"="+val)})};addParameters("expandedMoreOptions[]"),addParameters("thirdLvlFacetsExpand[]"),addParameters("openOptions[]")}return url=urlSplit[0]+"?"+urlParts.join("&"),window.history&&history.pushState&&window.history.pushState("Cambridge Search",$(document).attr("title"),url),updateShareLinks(url,$(document).attr("title")),$.ajax({url:url,dataType:"html"}).done(function(out){-1!==url.indexOf("cambridgeenglish/contact")?($("#filtersForm").replaceWith($(out).find("#filtersForm")),$(".ajaxPagination").replaceWith($(out).find(".ajaxPagination")),$.scrollTo(0,$("#filtersForm").parent().offset().top-50)):$("#"+tab+"Form").size()>0?($("#"+tab+"Form").replaceWith(out),$("div.headerPagination").not(":in-viewport").length>0&&!isTablet&&!isMobile&&$.scrollTo(0,$("#"+tab+"Form").offset().top-50)):($("div.headerPagination").not(":in-viewport").length>0&&!isTablet&&!isMobile&&$.scrollTo(0,$("#filtersForm").parent().offset().top-50),$("#filtersForm").replaceWith(out)),$(".optionsHidden .options li input").showSpinnerOnClick(),$(".refineResultsButton").not(".refineEnabled").click(function(){return $(".refinePanel").slideToggle("fast"),!1}).addClass("refineEnabled"),$(".refinePanel h3 a").not(".refineEnabled").click(function(){return $(this).toggleClass("open").parent().next().slideToggle("fast"),!1}).addClass("refineEnabled"),attachPaginationAjaxFunctionality(),initListingTypes(),$("html:not(.touch) .pretty").dropkick(),$("ul.productsList").addGridLayoutClasses(),$(".dynamicFormatCartMenu").formatSwitcher().change(),changeLinks(),toggleClearAll(),"undefined"!=typeof applyFacetFilters&&applyFacetFilters(),window.setTimeout(function(){setGridResultsToMaxHeight()},100)}),!1}).addClass("ajaxEnabled")}function splitFormatAndJump(el,ref,format){var selectedFormat=$("#"+ref).val(),oldHref=el.attr("href");if("string"==typeof selectedFormat){var parts=selectedFormat.split("_");if("Learning"==CURRENT_THEME)$(el).attr("href",oldHref+"?format="+parts[1]+"&isbn="+parts[0]);else{var has_param=GetURLParameter("format",$(el).attr("href"));if("undefined"==typeof has_param)$(el).attr("href",oldHref+"?format="+parts[1]);else{var new_href=$(el).attr("href").replace("?format="+has_param,"?format="+parts[1]);$(el).attr("href",new_href)}}}else{var has_param=GetURLParameter("format",$(el).attr("href"));if("undefined"==typeof has_param&&format)$(el).attr("href",oldHref+"?format="+format);else{var new_href=$(el).attr("href").replace("?format="+has_param,"?format="+format);$(el).attr("href",new_href)}}$(el).click()}function GetURLParameter(sParam,href){for(var sPageURL=href,sURLVariables=sPageURL.split("?"),sURLVariables1=sPageURL.split("&"),i=0;i<sURLVariables.length;i++){var sParameterName=sURLVariables[i].split("=");if(sParameterName[0]==sParam)return sParameterName[1]}if(void 0!=typeof sURLVariables1)for(var i=0;i<sURLVariables1.length;i++){var sParameterName=sURLVariables1[i].split("=");if(sParameterName[0]==sParam)return sParameterName[1]}}function getCookieValue(key){return currentcookie=document.cookie,currentcookie.length>0&&(firstidx=currentcookie.indexOf(key+"="),-1!=firstidx)?(firstidx=firstidx+key.length+1,lastidx=currentcookie.indexOf(";",firstidx),-1==lastidx&&(lastidx=currentcookie.length),unescape(currentcookie.substring(firstidx,lastidx))):""}function facetFieldChange(form,delay,checkBoxId){if("undefined"==typeof delay&&(delay=!0),$.browser.msie&&"8.0"==$.browser.version&&(delay=!1),window.clearTimeout(facetTimeoutObj),delay)return void(facetTimeoutObj=window.setTimeout(function(){facetFieldChange(form,!1,checkBoxId)},facetTimeout));var formData=form.serializeArray(),searchAjax=!1,listingAjax=!1,tab="";for(var ff in formData)ff=formData[ff],"currentTheme"==ff.name&&"Learning"==ff.value&&(searchAjax=!0),"tab"==ff.name&&(tab=ff.value);var currentUrl=window.location.href.split("?")[0],urlParts=currentUrl.split("/");for(var i in urlParts)if("cambridgeenglish"==urlParts[i]){listingAjax=!0;break}if(searchAjax||listingAjax){var open=new Array,closed=new Array,openOptions="",closedOptions="",otherOptions="";if($(".refinePanel h3 a").each(function(){""==$(this).parent().next().css("display")||"block"==$(this).parent().next().css("display")?open.push($(this).parent().next().find("ul").first().attr("id")):closed.push($(this).parent().next().find("ul").first().attr("id"))}),"undefined"!=typeof UrlUtil){var urlUtil=new UrlUtil,urlParams=urlUtil.getUrlParams(),addOtherOptions=function(keyParam){$.isArray(urlParams[keyParam])&&$.each(urlParams[keyParam],function(index,moreOption){-1===$.inArray(moreOption,open)&&-1===$.inArray(moreOption,closed)&&(otherOptions+="&"+keyParam+"="+moreOption)})};addOtherOptions("expandedMoreOptions[]"),addOtherOptions("thirdLvlFacetsExpand[]"),addOtherOptions("openOptions[]")}for(var id in open)openOptions+="&openOptions[]="+open[id];for(var id in closed)closedOptions+="&closedOptions[]="+closed[id];var url=window.location.href.split("?")[0],formParams=$(form).serializeArray(),clickedCheckBox=$("#"+checkBoxId),buildUrl=$(form).serialize();if("undefined"!=typeof checkBoxId&&"undefined"==typeof clickedCheckBox.attr("checked"))if(buildUrl="",clickedCheckBox.hasClass("noChildFacet")){for(var cleanClickedCheckBox=clickedCheckBox.attr("value").replace(/[\s,&]/g,"-").toLowerCase(),childrenBoxes=$("."+cleanClickedCheckBox+"-child"),filteredValues=[],c=0;c<childrenBoxes.length;c++)for(var param in formParams)formParams[param].value===childrenBoxes[c].value&&filteredValues.push(childrenBoxes[c].value);for(var param in formParams)-1===$.inArray(formParams[param].value,filteredValues)&&(buildUrl+="&"+formParams[param].name+"="+formParams[param].value)}else if(-1!==checkBoxId.indexOf("pivot_"))for(var param in formParams)formParams[param].value!=clickedCheckBox.attr("value")&&(buildUrl+="&"+formParams[param].name+"="+formParams[param].value);else if("webSubjAll[]"===clickedCheckBox.attr("name")){for(var webSubjectBoxes=clickedCheckBox.parent().parent().find($("input.webSubjectCb:checkbox")),pivotBoxes=clickedCheckBox.parent().parent().find($("input.pivotCb:checkbox")),filteredValues=[],c=0;c<webSubjectBoxes.length;c++)for(var param in formParams)formParams[param].value==webSubjectBoxes[c].value&&filteredValues.push(webSubjectBoxes[c].value);for(var c=0;c<pivotBoxes.length;c++)for(var param in formParams)formParams[param].value==pivotBoxes[c].value&&filteredValues.push(pivotBoxes[c].value);for(var param in formParams)-1===$.inArray(formParams[param].value,filteredValues)&&(buildUrl+="&"+formParams[param].name+"="+formParams[param].value)}else{for(var filteredFamilies=[],childBoxes=$("."+checkBoxId+"_child"),c=0;c<childBoxes.length;c++)for(var param in formParams)formParams[param].value==childBoxes[c].value&&filteredFamilies.push(childBoxes[c].value);for(var param in formParams)-1===$.inArray(formParams[param].value,filteredFamilies)&&(buildUrl+="&"+formParams[param].name+"="+formParams[param].value)}else if("undefined"!=typeof checkBoxId&&"undefined"!=typeof clickedCheckBox.attr("checked"))if(clickedCheckBox.hasClass("noChildFacet"))for(var cleanClickedCheckBox=clickedCheckBox.attr("value").replace(/[\s,&]/g,"-").toLowerCase(),childrenBoxes=$("."+cleanClickedCheckBox+"-child"),c=0;c<childrenBoxes.length;c++)-1===buildUrl.indexOf(childrenBoxes[c].value)&&(buildUrl+="&familyName[]="+encodeURIComponent(childrenBoxes[c].value));else if(-1!==checkBoxId.indexOf("pivot_"))$("#"+clickedCheckBox.attr("class").replace("_child pivotCb","")).addClass("webSubjectGreyed"),buildUrl+="&familyName[]="+clickedCheckBox.attr("value");else if("webSubjAll[]"===clickedCheckBox.attr("name")){for(var webSubjectBoxes=clickedCheckBox.parent().parent().find($("input.webSubjectCb:checkbox")),pivotBoxes=clickedCheckBox.parent().parent().find($("input.pivotCb:checkbox")),c=0;c<webSubjectBoxes.length;c++)-1===buildUrl.indexOf(webSubjectBoxes[c].value)&&(buildUrl+="&"+webSubjectBoxes[c].name+"="+encodeURIComponent(webSubjectBoxes[c].value));for(var c=0;c<pivotBoxes.length;c++)-1===buildUrl.indexOf(pivotBoxes[c].value)&&(buildUrl+="&"+pivotBoxes[c].name+"="+encodeURIComponent(pivotBoxes[c].value))}else for(var childrenBoxes=$("."+checkBoxId+"_child"),c=0;c<childrenBoxes.length;c++)-1===buildUrl.indexOf(childrenBoxes[c].value)&&(buildUrl+="&"+childrenBoxes[c].name+"="+encodeURIComponent(childrenBoxes[c].value));var fullUrl=url+"?"+buildUrl+openOptions+closedOptions+otherOptions;updateShareLinks(fullUrl,$(document).attr("title")),window.history&&history.pushState&&window.history.pushState("Cambridge Univesity Press - Products",$(document).attr("title"),url+"?"+buildUrl+openOptions+closedOptions+otherOptions),$.ajax({url:url,dataType:"html",data:buildUrl+openOptions+closedOptions}).done(function(out){searchAjax?($("#"+tab+"Tab").html(out),$("div.headerPagination").not(":in-viewport").length>0&&!isTablet&&!isMobile&&$.scrollTo(0,$("#"+tab+"Tab").offset().top-50)):listingAjax&&$("#filtersForm").replaceWith(out),$(".optionsHidden .options li input").showSpinnerOnClick(),$(".singleChildParentFacet").click(function(){$(this).parent().addClass("spinner")}),$(".refineResultsButton").not(".refineEnabled").click(function(){return $(".refinePanel").slideToggle("fast"),!1}).addClass("refineEnabled"),$(".refinePanel h3 a").not(".refineEnabled").click(function(){return $(this).toggleClass("open").parent().next().slideToggle("fast"),!1}).addClass("refineEnabled"),attachPaginationAjaxFunctionality(),initListingTypes(),$("html:not(.touch) .pretty").dropkick(),$("ul.productsList").addGridLayoutClasses(),$(".dynamicFormatCartMenu").formatSwitcher().change(),window.setTimeout(function(){setGridResultsToMaxHeight()},100),setFacetArrowsAndBoxes(),changeLinks(),toggleClearAll(),"undefined"!=typeof applyFacetFilters&&applyFacetFilters(),"undefined"!=typeof cwsAddToCartEvent&&$(".addToCartBtn").on("click",cwsAddToCartEvent)})}else $(form).submit()}function toggleClearAll(){$(".refinePanel input[type=checkbox]:checked").not(".hide").length>0?$(".clearLink").show():$(".clearLink").hide()}function loadExtTable(subject,id,checked,form){return $("#"+id).parent().parent().addClass("spinner"),$("#"+id).parent().find("h3").find("a").css({background:"none"}),"checked"!==checked?$("#"+id).attr("checked","true"):$("#"+id).removeAttr("checked"),facetFieldChange($("#"+form),"true",id),!1}function checkSubSubjects(id,checked){var $container=$("#"+id);$container.hasClass(id)?$("."+id).find("input:checkbox").prop("checked",checked):$container.find("input:checkbox").prop("checked",checked)}function uncheckShowAll(id){var $cboxShowAll=$("#"+id),$ulParent=$cboxShowAll.parent().parent();if($ulParent.hasClass($ulParent.prop("id"))){var ulParentClass=$ulParent.attr("class").split(/\s+/)[1];$("."+ulParentClass).find(".cboxShowAll").prop("checked",!1)}else $cboxShowAll.prop("checked",!1)}function changeDkLabel(dk,label){var isMixedMedia=dk.prev().hasClass("mixed-media");if(label=$.trim(label),1==isMixedMedia){if($(".mixed-media").parents(".authorPriceContainer").length)var shortText=label.substring(0,18)+"...";else var shortText=label.substring(0,14)+"...";dk.find(".dk_label").text(shortText)}}function doResize(){var $windowWidth=$(window).width();750>=$windowWidth||767>=$windowWidth&&$.browser.webkit?($(".openPageSlide").show(),$(".searchToggle").show(),$(".mainNavToggle").show(),$(".searchBox").addClass("searchBoxNone"),$(".mainNav").addClass("mainNavNone"),$(".listingHeader .results a.resultsListing").hide(),$(".listingHeader .results a.resultsGrid").hide()):($(".button.share").click(function(){return $("#share-link").select(),$("#share-link2").select(),!1}),$(".openPageSlide").hide(),$(".searchToggle").hide(),$(".mainNavToggle").hide(),$(".searchBox").removeClass("searchBoxNone"),$(".mainNav").removeClass("mainNavNone"),$(".listingHeader .results a.resultsListing").show(),$(".listingHeader .results a.resultsGrid").show(),$(".flexslider").flexslider({animation:"slide"})),$(".autocomplete-suggestions").each(function(){var $autocomplete=$(this);$autocomplete.css("width",$autocomplete.siblings("input:data(autocomplete)").width()+18)});var $navLocation=$("#content ul#nav li.navLocation a");$navLocation.removeClass("countryChooserFix");var $navItemsWidth=0;$("ul#nav > li").filter(":visible").each(function(){$navItemsWidth+=$(this).outerWidth()}),$navItemsWidth+5>$windowWidth&&$navLocation.addClass("countryChooserFix")}function googleTagManager(isbn){try{var gtm=new GoogleTagManager;$.isFunction(gtm.addToCart)&&$.post("/tools/packages/cambridge_core/titleService",{isbn:isbn,data:"gtm_data"},function(data,status){gtm.addToCart(data)})}catch(err){return}}function changePlaceholderAndFocus(element,text){text=text.charAt(0).toUpperCase()+text.slice(1),$("#"+element).attr("placeholder",text),$("#"+element).focus()}window.Modernizr=function(e,t,n){function r(e){d.cssText=e}function s(e,t){return typeof e===t}var v,T,k,a="2.6.0",f={},l=!0,c=t.documentElement,h="modernizr",p=t.createElement(h),d=p.style,m={}.toString,g=" -webkit- -moz- -o- -ms- ".split(" "),y={svg:"http://www.w3.org/2000/svg"},b={},S=[],x=S.slice,N=function(e,n,r,i){var s,o,u,a=t.createElement("div"),f=t.body,l=f?f:t.createElement("body");if(parseInt(r,10))for(;r--;)u=t.createElement("div"),u.id=i?i[r]:h+(r+1),a.appendChild(u);return s=["&#173;",'<style id="s',h,'">',e,"</style>"].join(""),a.id=h,(f?a:l).innerHTML+=s,l.appendChild(a),f||(l.style.background="",c.appendChild(l)),o=n(a,e),f?a.parentNode.removeChild(a):l.parentNode.removeChild(l),!!o},C={}.hasOwnProperty;k=s(C,"undefined")||s(C.call,"undefined")?function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")}:function(e,t){return C.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=x.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(x.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(x.call(arguments)))};return r}),b.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:N(["@media (",g.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n},b.svg=function(){return!!t.createElementNS&&!!t.createElementNS(y.svg,"svg").createSVGRect},b.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==y.svg},b.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(m.call(t.createElementNS(y.svg,"clipPath")))};for(var L in b)k(b,L)&&(T=L.toLowerCase(),f[T]=b[L](),S.push((f[T]?"":"no-")+T));return f.addTest=function(e,t){if("object"==typeof e)for(var r in e)k(e,r)&&f.addTest(r,e[r]);else{if(e=e.toLowerCase(),f[e]!==n)return f;t="function"==typeof t?t():t,l&&(c.className+=" "+(t?"":"no-")+e),f[e]=t}return f},r(""),p=v=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=g.elements;return"string"==typeof e?e.split(" "):e}function i(e){var t=v[e[p]];return t||(t={},d++,e[p]=d,v[d]=t),t}function s(e,n,r){if(n||(n=t),m)return n.createElement(e);r||(r=i(n));var s;return s=r.cache[e]?r.cache[e].cloneNode():c.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),s.canHaveChildren&&!l.test(e)?r.frag.appendChild(s):s}function o(e,n){if(e||(e=t),m)return e.createDocumentFragment();n=n||i(e);for(var s=n.frag.cloneNode(),o=0,u=r(),a=u.length;a>o;o++)s.createElement(u[o]);return s}function u(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function a(e){e||(e=t);var r=i(e);return g.shivCSS&&!h&&!r.hasCSS&&(r.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),m||u(e,r),e}var h,m,f=e.html5||{},l=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i,p="_html5shiv",d=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",h="hidden"in e,m=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){h=!0,m=!0}}();var g={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:m,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:a,createElement:s,createDocumentFragment:o};e.html5=g,a(t)}(this,t),f._version=a,f._prefixes=g,f.testStyles=N,c.className=c.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(l?" js "+S.join(" "):""),f}(this,this.document),function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c={},d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[],c=t.createElement(e)),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var C,k,c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};k=function(e){function t(e){var i,s,o,e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e};for(s=0;r>s;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;t>s;s++)n=x[s](n);return n}function o(e,i,s,o,a){var f=t(e),c=f.autoCallback;f.url.split(".").pop().split("?").shift(),f.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]||u),f.instead?f.instead(e,i,s,o,a):(T[f.url]?f.noexec=!0:T[f.url]=1,s.load(f.url,f.forceCSS||!f.forceJS&&"css"==f.url.split(".").pop().split("?").shift()?"c":n,f.noexec,f.attrs,f.timeout),(r(i)||r(c))&&s.load(function(){l(),i&&i(f.origUrl,a,o),c&&c(f.origUrl,a,o),T[f.url]=2})))}function a(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var n,t=0;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var h,p,u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s;n(u?e.yep:e.nope,!!a),a&&n(a)}var f,c,h=this.yepnope.loader;if(i(e))o(e,0,h,0);else if(S(e))for(f=0;f<e.length;f++)c=e[f],i(c)?o(c,0,h,0):S(c)?k(c):Object(c)===c&&a(c,h);else Object(e)===e&&a(e,h)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var c,d,l=t.createElement("script"),i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var f,i=t.createElement("link"),n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("ie8compat",function(){return!window.addEventListener&&document.documentMode&&7===document.documentMode}),function(d){function q(v){return!v||void 0!==v.allowPageScroll||void 0===v.swipe&&void 0===v.swipeStatus||(v.allowPageScroll=i),v||(v={}),v=d.extend({},d.fn.swipe.defaults,v),this.each(function(){var x=d(this),w=x.data(t);w||(w=new n(this,v),x.data(t,w))})}function n(J,R){function aa(ao){if(!L()){ao=ao.originalEvent;var an,am=a?ao.touches[0]:ao;return F=e,a?ai=ao.touches.length:ao.preventDefault(),P=0,E=null,ak=null,S=0,af=0,w=0,U=1,T=al(),!a||ai===R.fingers||R.fingers===f||W()?(T[0].start.x=T[0].end.x=am.pageX,T[0].start.y=T[0].end.y=am.pageY,B=x(),2==ai&&(T[1].start.x=T[1].end.x=ao.touches[1].pageX,T[1].start.y=T[1].end.y=ao.touches[1].pageY,af=w=N(T[0].start,T[1].start)),(R.swipeStatus||R.pinchStatus)&&(an=ah(ao,F))):(D(ao),
an=!1),an===!1?(F=m,ah(ao,F),an):(V(!0),A.bind(K,G),A.bind(ac,O),void 0)}}function G(ap){if(ap=ap.originalEvent,F!==g&&F!==m){var an,am=a?ap.touches[0]:ap;if(T[0].end.x=a?ap.touches[0].pageX:am.pageX,T[0].end.y=a?ap.touches[0].pageY:am.pageY,M=x(),E=Z(T[0].start,T[0].end),a&&(ai=ap.touches.length),F=h,2==ai&&(0==af?(T[1].start.x=ap.touches[1].pageX,T[1].start.y=ap.touches[1].pageY,af=w=N(T[0].start,T[1].start)):(T[1].end.x=ap.touches[1].pageX,T[1].end.y=ap.touches[1].pageY,w=N(T[0].end,T[1].end),ak=X(T[0].end,T[1].end)),U=v(af,w)),ai!==R.fingers&&R.fingers!==f&&a)F=m,ah(ap,F);else if(y(ap,E),P=z(T[0].start,T[0].end),S=C(T[0].start,T[0].end),(R.swipeStatus||R.pinchStatus)&&(an=ah(ap,F)),!R.triggerOnTouchEnd){var ao=!Y();Q()===!0?(F=g,an=ah(ap,F)):ao&&(F=m,ah(ap,F))}an===!1&&(F=m,ah(ap,F))}}function O(at){if(at=at.originalEvent,at.touches&&at.touches.length>0)return!0;if(at.preventDefault(),M=x(),0!=af&&(w=N(T[0].end,T[1].end),U=v(af,w),ak=X(T[0].end,T[1].end)),P=z(T[0].start,T[0].end),E=Z(T[0].start,T[0].end),S=C(),R.triggerOnTouchEnd||R.triggerOnTouchEnd===!1&&F===h){F=g;var ap=ad()||!W(),an=ai===R.fingers||R.fingers===f||!a,am=0!==T[0].end.x,ao=an&&am&&ap;if(ao){var aq=Y(),ar=Q();ar!==!0&&null!==ar||!aq?aq&&ar!==!1||(F=m,ah(at,F)):ah(at,F)}else F=m,ah(at,F)}else F===h&&(F=m,ah(at,F));A.unbind(K,G,!1),A.unbind(ac,O,!1),V(!1)}function D(){ai=0,M=0,B=0,af=0,w=0,U=1,V(!1)}function ah(ao,am){var an=void 0;if(R.swipeStatus&&(an=R.swipeStatus.call(A,ao,am,E||null,P||0,S||0,ai)),R.pinchStatus&&ad()&&(an=R.pinchStatus.call(A,ao,am,ak||null,w||0,S||0,ai,U)),am===m&&(!R.click||1!==ai&&a||!isNaN(P)&&0!==P||(an=R.click.call(A,ao,ao.target))),am==g){switch(R.swipe&&(an=R.swipe.call(A,ao,E,P,S,ai)),E){case l:R.swipeLeft&&(an=R.swipeLeft.call(A,ao,E,P,S,ai));break;case k:R.swipeRight&&(an=R.swipeRight.call(A,ao,E,P,S,ai));break;case c:R.swipeUp&&(an=R.swipeUp.call(A,ao,E,P,S,ai));break;case r:R.swipeDown&&(an=R.swipeDown.call(A,ao,E,P,S,ai))}switch(ak){case b:R.pinchIn&&(an=R.pinchIn.call(A,ao,ak||null,w||0,S||0,ai,U));break;case s:R.pinchOut&&(an=R.pinchOut.call(A,ao,ak||null,w||0,S||0,ai,U))}}return(am===m||am===g)&&D(ao),an}function Q(){return null!==R.threshold?P>=R.threshold:null}function Y(){var am;return am=R.maxTimeThreshold&&S>=R.maxTimeThreshold?!1:!0}function y(am,an){if(R.allowPageScroll===i||W())am.preventDefault();else{var ao=R.allowPageScroll===o;switch(an){case l:(R.swipeLeft&&ao||!ao&&R.allowPageScroll!=u)&&am.preventDefault();break;case k:(R.swipeRight&&ao||!ao&&R.allowPageScroll!=u)&&am.preventDefault();break;case c:(R.swipeUp&&ao||!ao&&R.allowPageScroll!=p)&&am.preventDefault();break;case r:(R.swipeDown&&ao||!ao&&R.allowPageScroll!=p)&&am.preventDefault()}}}function C(){return M-B}function N(ap,ao){var an=Math.abs(ap.x-ao.x),am=Math.abs(ap.y-ao.y);return Math.round(Math.sqrt(an*an+am*am))}function v(am,an){var ao=an/am*1;return ao.toFixed(2)}function X(){return 1>U?s:b}function z(an,am){return Math.round(Math.sqrt(Math.pow(am.x-an.x,2)+Math.pow(am.y-an.y,2)))}function ab(ap,an){var am=ap.x-an.x,ar=an.y-ap.y,ao=Math.atan2(ar,am),aq=Math.round(180*ao/Math.PI);return 0>aq&&(aq=360-Math.abs(aq)),aq}function Z(an,am){var ao=ab(an,am);return 45>=ao&&ao>=0?l:360>=ao&&ao>=315?l:ao>=135&&225>=ao?k:ao>45&&135>ao?r:c}function x(){var am=new Date;return am.getTime()}function H(){A.unbind(ae,aa),A.unbind(I,D),A.unbind(K,G),A.unbind(ac,O),V(!1)}function W(){return R.pinchStatus||R.pinchIn||R.pinchOut}function ad(){return ak&&W()}function L(){return A.data(t+"_intouch")===!0?!0:!1}function V(am){am=am===!0?!0:!1,A.data(t+"_intouch",am)}function al(){for(var am=[],an=0;5>=an;an++)am.push({start:{x:0,y:0},end:{x:0,y:0},delta:{x:0,y:0}});return am}var aj=a||!R.fallbackToMouseEvents,ae=aj?"touchstart":"mousedown",K=aj?"touchmove":"mousemove",ac=aj?"touchend":"mouseup",I="touchcancel",P=0,E=null,S=0,af=0,w=0,U=1,ak=0,A=d(J),F="start",ai=0,T=null,B=0,M=0;try{A.bind(ae,aa),A.bind(I,D)}catch(ag){d.error("events not supported "+ae+","+I+" on jQuery.swipe")}this.enable=function(){return A.bind(ae,aa),A.bind(I,D),A},this.disable=function(){return H(),A},this.destroy=function(){return H(),A.data(t,null),A}}var l="left",k="right",c="up",r="down",b="in",s="out",i="none",o="auto",u="horizontal",p="vertical",f="all",e="start",h="move",g="end",m="cancel",a="ontouchstart"in window,t="TouchSwipe",j={fingers:1,threshold:75,maxTimeThreshold:null,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,triggerOnTouchEnd:!0,allowPageScroll:"auto",fallbackToMouseEvents:!0};d.fn.swipe=function(x){var w=d(this),v=w.data(t);if(v&&"string"==typeof x){if(v[x])return v[x].apply(this,Array.prototype.slice.call(arguments,1));d.error("Method "+x+" does not exist on jQuery.swipe")}else if(!(v||"object"!=typeof x&&x))return q.apply(this,arguments);return w},d.fn.swipe.defaults=j,d.fn.swipe.phases={PHASE_START:e,PHASE_MOVE:h,PHASE_END:g,PHASE_CANCEL:m},d.fn.swipe.directions={LEFT:l,RIGHT:k,UP:c,DOWN:r,IN:b,OUT:s},d.fn.swipe.pageScroll={NONE:i,HORIZONTAL:u,VERTICAL:p,AUTO:o},d.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:f}}(jQuery),function(e){var t=function(){return{tmp:[],hidden:null,adjust:function(t){var n=this;n.hidden=t.parents().andSelf().filter(":hidden"),n.hidden.each(function(){var t=e(this);n.tmp.push(t.attr("style")),t.css({visibility:"hidden",display:"block"})})},reset:function(){var t=this;t.hidden.each(function(n){var r=e(this),i=t.tmp[n];void 0===i?r.removeAttr("style"):r.attr("style",i)}),t.tmp=[],t.hidden=null}}};jQuery.foundation=jQuery.foundation||{},jQuery.foundation.customForms=jQuery.foundation.customForms||{},e.foundation.customForms.appendCustomMarkup=function(n){function i(t,n){var r=e(n).hide(),i=r.attr("type"),s=r.next("span.custom."+i);0===s.length&&(s=e('<span class="custom '+i+'"></span>').insertAfter(r)),s.toggleClass("checked",r.is(":checked")),s.toggleClass("disabled",r.is(":disabled"))}function s(n,r){var d,i=t(),s=e(r),o=s.next("div.custom.dropdown"),u=o.find("ul"),f=(o.find(".current"),o.find(".selector")),l=s.find("option"),c=l.filter(":selected"),h=0,p="",v=!1;if(!s.hasClass("no-custom")){if(0===o.length){var m=s.hasClass("small")?"small":s.hasClass("medium")?"medium":s.hasClass("large")?"large":s.hasClass("expand")?"expand":"";o=e('<div class="'+["custom","dropdown",m].join(" ")+'"><a href="#" class="selector"></a><ul /></div>"'),f=o.find(".selector"),u=o.find("ul"),p=l.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join(""),u.append(p),v=o.prepend('<a href="#" class="current">'+c.html()+"</a>").find(".current"),s.after(o).hide()}else p=l.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join(""),u.html("").append(p);o.toggleClass("disabled",s.is(":disabled")),d=u.find("li"),l.each(function(t){this.selected&&(d.eq(t).addClass("selected"),v&&v.html(e(this).html()))}),u.css("width","inherit"),o.css("width","inherit"),o.is(".small, .medium, .large, .expand")||(o.addClass("open"),i.adjust(u),h=d.outerWidth()>h?d.outerWidth():h,i.reset(),o.removeClass("open"),o.width(h+18),u.width(h+16))}}var r={disable_class:"js-disable-custom"};n=e.extend(r,n),e("form.custom input:radio[data-customforms!=disabled]").each(i),e("form.custom input:checkbox[data-customforms!=disabled]").each(i),e("form.custom select[data-customforms!=disabled]").each(s)};var n=function(t){var n=0,r=t.next();$options=t.find("option"),r.find("ul").html(""),$options.each(function(){$li=e("<li>"+e(this).html()+"</li>"),r.find("ul").append($li)}),$options.each(function(t){this.selected&&(r.find("li").eq(t).addClass("selected"),r.find(".current").html(e(this).html()))}),r.removeAttr("style").find("ul").removeAttr("style"),r.find("li").each(function(){r.addClass("open"),e(this).outerWidth()>n&&(n=e(this).outerWidth()),r.removeClass("open")}),r.css("width",n+18+"px"),r.find("ul").css("width",n+16+"px")},r=function(e){var t=e.prev(),n=t[0];!1===t.is(":disabled")&&(n.checked=n.checked?!1:!0,e.toggleClass("checked"),t.trigger("change"))},i=function(t){var n=t.prev(),r=n[0];!1===n.is(":disabled")&&(e('input:radio[name="'+n.attr("name")+'"]').next().not(t).removeClass("checked"),t.hasClass("checked")||t.toggleClass("checked"),r.checked=t.hasClass("checked"),n.trigger("change"))};e(document).on("click","form.custom span.custom.checkbox",function(t){t.preventDefault(),t.stopPropagation(),r(e(this))}),e(document).on("click","form.custom span.custom.radio",function(t){t.preventDefault(),t.stopPropagation(),i(e(this))}),e(document).on("change","form.custom select[data-customforms!=disabled]",function(t){n(e(this))}),e(document).on("click","form.custom label",function(t){var s,o,n=e("#"+e(this).attr("for"));0!==n.length&&("checkbox"===n.attr("type")?(t.preventDefault(),s=e(this).find("span.custom.checkbox"),r(s)):"radio"===n.attr("type")&&(t.preventDefault(),o=e(this).find("span.custom.radio"),i(o)))}),e(document).on("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(t){var n=e(this),r=n.closest("div.custom.dropdown"),i=r.prev();return t.preventDefault(),e("div.dropdown").removeClass("open"),!1===i.is(":disabled")?(r.toggleClass("open"),r.hasClass("open")?e(document).bind("click.customdropdown",function(t){r.removeClass("open"),e(document).unbind(".customdropdown")}):e(document).unbind(".customdropdown"),!1):void 0}),e(document).on("click","form.custom div.custom.dropdown li",function(t){var n=e(this),r=n.closest("div.custom.dropdown"),i=r.prev(),s=0;t.preventDefault(),t.stopPropagation(),e("div.dropdown").removeClass("open"),n.closest("ul").find("li").removeClass("selected"),n.addClass("selected"),r.removeClass("open").find("a.current").html(n.html()),n.closest("ul").find("li").each(function(e){n[0]==this&&(s=e)}),i[0].selectedIndex=s,i.trigger("change")}),e.fn.foundationCustomForms=e.foundation.customForms.appendCustomMarkup}(jQuery),function(e){"use strict";var t=!1;e(document).on("click","a[data-reveal-id]",function(t){t.preventDefault();var n=e(this).attr("data-reveal-id");e("#"+n).reveal(e(this).data())}),e.fn.reveal=function(n){var i=(e(document),{animation:"fadeAndPop",animationSpeed:300,closeOnBackgroundClick:!0,dismissModalClass:"close-reveal-modal",open:e.noop,opened:e.noop,close:e.noop,closed:e.noop});return n=e.extend({},i,n),this.not(".reveal-modal.open").each(function(){function c(){u=!1}function h(){u=!0}function p(){var n=e(".reveal-modal.open");1===n.length&&(t=!0,n.trigger("reveal:close"))}function d(){u||(h(),p(),i.addClass("open"),"fadeAndPop"===n.animation&&(f.open.top=sTop-o,f.open.opacity=0,i.css(f.open),a.fadeIn(n.animationSpeed/2),i.delay(n.animationSpeed/2).animate({top:sTop+s+"px",opacity:1},n.animationSpeed,function(){i.trigger("reveal:opened")})),"fade"===n.animation&&(f.open.top=sTop()+s,f.open.opacity=0,i.css(f.open),a.fadeIn(n.animationSpeed/2),i.delay(n.animationSpeed/2).animate({opacity:1},n.animationSpeed,function(){i.trigger("reveal:opened")})),"none"===n.animation&&(f.open.top=sTop+s,f.open.opacity=1,i.css(f.open),a.css({display:"block"}),i.trigger("reveal:opened")))}function v(){var e=i.find(".flex-video"),t=e.find("iframe");t.length>0&&(t.attr("src",t.data("src")),e.fadeIn(100))}function m(){u||(h(),i.removeClass("open"),"fadeAndPop"===n.animation&&(i.animate({top:sTop-o+"px",opacity:0},n.animationSpeed/2,function(){i.css(f.close)}),t?i.trigger("reveal:closed"):a.delay(n.animationSpeed).fadeOut(n.animationSpeed,function(){i.trigger("reveal:closed")})),"fade"===n.animation&&(i.animate({opacity:0},n.animationSpeed,function(){i.css(f.close)}),t?i.trigger("reveal:closed"):a.delay(n.animationSpeed).fadeOut(n.animationSpeed,function(){i.trigger("reveal:closed")})),"none"===n.animation&&(i.css(f.close),t||a.css({display:"none"}),i.trigger("reveal:closed")),t=!1)}function g(){i.unbind(".reveal"),a.unbind(".reveal"),l.unbind(".reveal"),e("body").unbind(".reveal")}function y(){var e=i.find(".flex-video"),t=e.find("iframe");t.length>0&&(t.data("src",t.attr("src")),t.attr("src",""),e.fadeOut(100))}var l,sTop=document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0,i=e(this),s=parseInt(i.css("top"),10),o=i.height()+s,u=!1,a=e(".reveal-modal-bg"),f={open:{top:0,opacity:0,visibility:"visible",display:"block"},close:{top:s,opacity:1,visibility:"hidden",display:"none"}};0===a.length&&(a=e("<div />",{"class":"reveal-modal-bg"}).insertAfter(i),a.fadeTo("fast",.8)),i.bind("reveal:open.reveal",d),i.bind("reveal:open.reveal",v),i.bind("reveal:close.reveal",m),i.bind("reveal:closed.reveal",y),i.bind("reveal:opened.reveal reveal:closed.reveal",c),i.bind("reveal:closed.reveal",g),i.bind("reveal:open.reveal",n.open),i.bind("reveal:opened.reveal",n.opened),i.bind("reveal:close.reveal",n.close),i.bind("reveal:closed.reveal",n.closed),i.trigger("reveal:open"),l=e("."+n.dismissModalClass).bind("click.reveal",function(){i.trigger("reveal:close")}),n.closeOnBackgroundClick&&(a.css({cursor:"pointer"}),a.bind("click.reveal",function(){i.trigger("reveal:close")})),e("body").bind("keyup.reveal",function(e){27===e.which&&i.trigger("reveal:close")})})}}(jQuery),function($){"use strict";$.fn.findFirstImage=function(){return this.first().find("img").andSelf().filter("img").first()};var ORBIT={defaults:{animation:"horizontal-push",animationSpeed:600,timer:!0,advanceSpeed:4e3,pauseOnHover:!1,startClockOnMouseOut:!1,startClockOnMouseOutAfter:1e3,directionalNav:!0,directionalNavRightText:"Right",directionalNavLeftText:"Left",captions:!0,captionAnimation:"fade",captionAnimationSpeed:600,resetTimerOnClick:!1,bullets:!1,bulletThumbs:!1,bulletThumbLocation:"",afterSlideChange:$.noop,afterLoadComplete:$.noop,fluid:!0,centerBullets:!0,singleCycle:!1},activeSlide:0,numberSlides:0,orbitWidth:null,orbitHeight:null,locked:null,timerRunning:null,degrees:0,wrapperHTML:'<div class="orbit-wrapper" />',timerHTML:'<div class="timer"><span class="mask"><span class="rotator"></span></span><span class="pause"></span></div>',captionHTML:'<div class="orbit-caption"></div>',directionalNavHTML:'<div class="slider-nav"><span class="right"></span><span class="left"></span></div>',bulletHTML:'<ul class="orbit-bullets"></ul>',init:function(element,options){var $imageSlides,imagesLoadedCount=0,self=this;this.clickTimer=$.proxy(this.clickTimer,this),this.addBullet=$.proxy(this.addBullet,this),this.resetAndUnlock=$.proxy(this.resetAndUnlock,this),this.stopClock=$.proxy(this.stopClock,this),this.startTimerAfterMouseLeave=$.proxy(this.startTimerAfterMouseLeave,this),this.clearClockMouseLeaveTimer=$.proxy(this.clearClockMouseLeaveTimer,this),this.rotateTimer=$.proxy(this.rotateTimer,this),this.options=$.extend({},this.defaults,options),"false"===this.options.timer&&(this.options.timer=!1),"false"===this.options.captions&&(this.options.captions=!1),"false"===this.options.directionalNav&&(this.options.directionalNav=!1),this.$element=$(element),this.$wrapper=this.$element.wrap(this.wrapperHTML).parent(),this.$slides=this.$element.children("img, a, div, figure"),this.$element.bind("orbit.next",function(){self.shift("next")}),this.$element.bind("orbit.prev",function(){self.shift("prev")}),this.$element.bind("orbit.goto",function(event,index){self.shift(index)}),this.$element.bind("orbit.start",function(event,index){self.startClock()}),this.$element.bind("orbit.stop",function(event,index){self.stopClock()});var $ipadCont=this.$element;this.$element.swipe({swipeLeft:function(){$ipadCont.trigger("orbit.next")},swipeRight:function(){$ipadCont.trigger("orbit.prev")}}),$imageSlides=this.$slides.filter("img"),0===$imageSlides.length?this.loaded():$imageSlides.bind("imageready",function(){imagesLoadedCount+=1,imagesLoadedCount===$imageSlides.length&&self.loaded()})},loaded:function(){this.$element.addClass("orbit").css({width:"1px",height:"1px"}),this.$slides.addClass("orbit-slide"),this.setDimentionsFromLargestSlide(),this.updateOptionsIfOnlyOneSlide(),this.setupFirstSlide(),this.options.timer&&(this.setupTimer(),this.startClock()),this.options.captions&&this.setupCaptions(),this.options.directionalNav&&this.setupDirectionalNav(),this.options.bullets&&(this.setupBulletNav(),this.setActiveBullet()),this.options.afterLoadComplete.call(this),Holder.run()},currentSlide:function(){return this.$slides.eq(this.activeSlide)},setDimentionsFromLargestSlide:function(){var $fluidPlaceholder,self=this;if(self.$element.add(self.$wrapper).width(this.$slides.first().outerWidth()),self.$element.add(self.$wrapper).height(this.$slides.first().height()),self.$element.is(":hidden")){var hidden=this.$slides.first().parents("li:hidden").show();self.orbitWidth=this.$slides.first().outerWidth(),self.orbitHeight=this.$slides.first().height(),hidden.hide().css("")}else self.orbitWidth=this.$slides.first().outerWidth(),self.orbitHeight=this.$slides.first().height();if($fluidPlaceholder=this.$slides.first().findFirstImage().clone(),this.$slides.each(function(){var slide=$(this),slideWidth=slide.outerWidth(),slideHeight=slide.height();slideWidth>self.$element.outerWidth()&&(self.$element.add(self.$wrapper).width(slideWidth),self.orbitWidth=self.$element.outerWidth()),slideHeight>self.$element.height()&&(self.$element.add(self.$wrapper).height(slideHeight),self.orbitHeight=self.$element.height(),$fluidPlaceholder=$(this).findFirstImage().clone()),self.numberSlides+=1}),this.options.fluid){"string"==typeof this.options.fluid&&($fluidPlaceholder=$("<img>").attr("data-src","holder.js/"+this.options.fluid)),self.$element.prepend($fluidPlaceholder),$fluidPlaceholder.addClass("fluid-placeholder"),self.$element.add(self.$wrapper).css({width:"inherit"}),self.$element.add(self.$wrapper).css({height:"inherit"});var thisss=this;$(window).bind("resize",function(){if(self.$element.is(":hidden")){var hidden=thisss.$slides.first().parents("li:hidden").show();self.orbitWidth=self.$element.outerWidth(),self.orbitHeight=self.$element.height(),hidden.hide().css("")}else self.orbitWidth=self.$element.outerWidth(),self.orbitHeight=self.$element.height()})}},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},updateOptionsIfOnlyOneSlide:function(){1===this.$slides.length&&(this.options.directionalNav=!1,this.options.timer=!1,this.options.bullets=!1)},setupFirstSlide:function(){var self=this;this.$slides.first().css({"z-index":3}).fadeIn(function(){self.$slides.css({display:"block"})})},startClock:function(){var self=this;return this.options.timer?void(this.$timer.is(":hidden")?this.clock=setInterval(function(){self.$element.trigger("orbit.next")},this.options.advanceSpeed):(this.timerRunning=!0,this.$pause.removeClass("active"),this.clock=setInterval(this.rotateTimer,this.options.advanceSpeed/180,!1))):!1},rotateTimer:function(reset){var degreeCSS="rotate("+this.degrees+"deg)";this.degrees+=2,this.$rotator.css({"-webkit-transform":degreeCSS,"-moz-transform":degreeCSS,"-o-transform":degreeCSS,"-ms-transform":degreeCSS}),this.degrees>180&&(this.$rotator.addClass("move"),this.$mask.addClass("move")),(this.degrees>360||reset)&&(this.$rotator.removeClass("move"),this.$mask.removeClass("move"),this.degrees=0,this.$element.trigger("orbit.next"))},stopClock:function(){return this.options.timer?(this.timerRunning=!1,clearInterval(this.clock),this.$pause.addClass("active"),void 0):!1},setupTimer:function(){this.$timer=$(this.timerHTML),this.$wrapper.append(this.$timer),this.$rotator=this.$timer.find(".rotator"),this.$mask=this.$timer.find(".mask"),this.$pause=this.$timer.find(".pause"),this.$timer.click(this.clickTimer),this.options.startClockOnMouseOut&&(this.$wrapper.mouseleave(this.startTimerAfterMouseLeave),this.$wrapper.mouseenter(this.clearClockMouseLeaveTimer)),this.options.pauseOnHover&&this.$wrapper.mouseenter(this.stopClock)},startTimerAfterMouseLeave:function(){var self=this;this.outTimer=setTimeout(function(){self.timerRunning||self.startClock()},this.options.startClockOnMouseOutAfter)},clearClockMouseLeaveTimer:function(){clearTimeout(this.outTimer)},clickTimer:function(){this.timerRunning?this.stopClock():this.startClock()},setupCaptions:function(){this.$caption=$(this.captionHTML),this.$wrapper.append(this.$caption),this.setCaption()},setCaption:function(){var captionHTML,captionLocation=this.currentSlide().attr("data-caption");if(!this.options.captions)return!1;if(captionLocation){if($.trim($(captionLocation).text()).length<1)return!1;switch(captionHTML=$(captionLocation).html(),this.$caption.attr("id",captionLocation).html(captionHTML),this.options.captionAnimation){case"none":this.$caption.show();break;case"fade":this.$caption.fadeIn(this.options.captionAnimationSpeed);break;case"slideOpen":this.$caption.slideDown(this.options.captionAnimationSpeed)}}else switch(this.options.captionAnimation){case"none":this.$caption.hide();break;case"fade":this.$caption.fadeOut(this.options.captionAnimationSpeed);break;case"slideOpen":this.$caption.slideUp(this.options.captionAnimationSpeed)}},setupDirectionalNav:function(){var self=this,$directionalNav=$(this.directionalNavHTML);$directionalNav.find(".right").html(this.options.directionalNavRightText),$directionalNav.find(".left").html(this.options.directionalNavLeftText),this.$wrapper.append($directionalNav),this.$wrapper.find(".left").click(function(){self.stopClock(),self.options.resetTimerOnClick&&(self.rotateTimer(!0),self.startClock()),self.$element.trigger("orbit.prev")}),this.$wrapper.find(".right").click(function(){self.stopClock(),self.options.resetTimerOnClick&&(self.rotateTimer(!0),self.startClock()),self.$element.trigger("orbit.next")})},setupBulletNav:function(){this.$bullets=$(this.bulletHTML),this.$wrapper.append(this.$bullets),this.$slides.each(this.addBullet),this.$element.addClass("with-bullets"),this.options.centerBullets&&this.$bullets.css("margin-left",-this.$bullets.outerWidth()/2)},addBullet:function(index,slide){var thumbName,position=index+1,$li=$("<li>"+position+"</li>"),self=this;this.options.bulletThumbs&&(thumbName=$(slide).attr("data-thumb"),thumbName&&$li.addClass("has-thumb").css({background:"url("+this.options.bulletThumbLocation+thumbName+") no-repeat"})),this.$bullets.append($li),$li.data("index",index),$li.click(function(){self.stopClock(),self.options.resetTimerOnClick&&(self.rotateTimer(!0),self.startClock()),self.$element.trigger("orbit.goto",[$li.data("index")])})},setActiveBullet:function(){return this.options.bullets?void this.$bullets.find("li").removeClass("active").eq(this.activeSlide).addClass("active"):!1},resetAndUnlock:function(){this.$slides.eq(this.prevActiveSlide).css({"z-index":1}),this.unlock(),this.options.afterSlideChange.call(this,this.$slides.eq(this.prevActiveSlide),this.$slides.eq(this.activeSlide))},shift:function(direction){var slideDirection=direction;return this.prevActiveSlide=this.activeSlide,this.prevActiveSlide==slideDirection?!1:"1"==this.$slides.length?!1:(this.locked||(this.lock(),"next"==direction?(this.activeSlide++,this.activeSlide==this.numberSlides&&(this.activeSlide=0)):"prev"==direction?(this.activeSlide--,this.activeSlide<0&&(this.activeSlide=this.numberSlides-1)):(this.activeSlide=direction,this.prevActiveSlide<this.activeSlide?slideDirection="next":this.prevActiveSlide>this.activeSlide&&(slideDirection="prev")),this.setActiveBullet(),this.$slides.eq(this.prevActiveSlide).css({"z-index":2}),"fade"==this.options.animation&&this.$slides.eq(this.activeSlide).css({opacity:0,"z-index":3}).animate({opacity:1},this.options.animationSpeed,this.resetAndUnlock),"horizontal-slide"==this.options.animation&&("next"==slideDirection&&this.$slides.eq(this.activeSlide).css({left:this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock),"prev"==slideDirection&&this.$slides.eq(this.activeSlide).css({left:-this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock)),"vertical-slide"==this.options.animation&&("prev"==slideDirection&&this.$slides.eq(this.activeSlide).css({top:this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock),"next"==slideDirection&&this.$slides.eq(this.activeSlide).css({top:-this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock)),"horizontal-push"==this.options.animation&&("next"==slideDirection&&(this.$slides.eq(this.activeSlide).css({left:this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock),this.$slides.eq(this.prevActiveSlide).animate({left:-this.orbitWidth-10},this.options.animationSpeed)),"prev"==slideDirection&&(this.$slides.eq(this.activeSlide).css({left:-this.orbitWidth,"z-index":3}).animate({left:0},this.options.animationSpeed,this.resetAndUnlock),this.$slides.eq(this.prevActiveSlide).animate({left:this.orbitWidth+10},this.options.animationSpeed))),"vertical-push"==this.options.animation&&("next"==slideDirection&&(this.$slides.eq(this.activeSlide).css({top:-this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock),this.$slides.eq(this.prevActiveSlide).animate({top:this.orbitHeight},this.options.animationSpeed)),"prev"==slideDirection&&(this.$slides.eq(this.activeSlide).css({top:this.orbitHeight,"z-index":3}).animate({top:0},this.options.animationSpeed,this.resetAndUnlock),this.$slides.eq(this.prevActiveSlide).animate({top:-this.orbitHeight},this.options.animationSpeed))),this.setCaption()),void(this.$slides.last()&&this.options.singleCycle&&this.stopClock()))}};$.fn.orbit=function(options){return this.each(function(){var orbit=$.extend({},ORBIT);orbit.init(this,options)})}}(jQuery),function($){function bindToLoad(element,callback){var $this=$(element);$this.bind("load.imageready",function(){callback.apply(element,arguments),$this.unbind("load.imageready")})}var options={};$.event.special.imageready={setup:function(data,namespaces,eventHandle){options=data||options},add:function(handleObj){var src,$this=$(this);1===this.nodeType&&"img"===this.tagName.toLowerCase()&&""!==this.src&&(options.forceLoad?(src=$this.attr("src"),$this.attr("src",""),bindToLoad(this,handleObj.handler),$this.attr("src",src)):this.complete||4===this.readyState?handleObj.handler.apply(this,arguments):bindToLoad(this,handleObj.handler))},teardown:function(namespaces){$(this).unbind(".imageready")}}}(jQuery);var Holder=Holder||{};!function(app,win){function contentLoaded(n,t){var l="complete",s="readystatechange",u=!1,h=u,c=!0,i=n.document,a=i.documentElement,e=i.addEventListener?"addEventListener":"attachEvent",v=i.addEventListener?"removeEventListener":"detachEvent",f=i.addEventListener?"":"on",r=function(e){(e.type!=s||i.readyState==l)&&(("load"==e.type?n:i)[v](f+e.type,r,u),!h&&(h=!0)&&t.call(n,null))},o=function(){try{a.doScroll("left")}catch(n){return void setTimeout(o,50)}r("poll")};if(i.readyState==l)t.call(n,"lazy");else{if(i.createEventObject&&a.doScroll){try{c=!n.frameElement}catch(y){}c&&o()}i[e](f+"DOMContentLoaded",r,u),i[e](f+s,r,u),n[e](f+"load",r,u)}}function selector(a){a=a.match(/^(\W)?(.*)/);var b=document["getElement"+(a[1]?"#"==a[1]?"ById":"sByClassName":"sByTagName")](a[2]),ret=[];return null!=b&&(ret=b.length?b:0==b.length?b:[b]),ret}function extend(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}function draw(ctx,dimensions,template){var dimension_arr=[dimensions.height,dimensions.width].sort(),maxFactor=Math.round(dimension_arr[1]/16),minFactor=Math.round(dimension_arr[0]/16),text_height=Math.max(template.size,maxFactor);canvas.width=dimensions.width,canvas.height=dimensions.height,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle=template.background,ctx.fillRect(0,0,dimensions.width,dimensions.height),ctx.fillStyle=template.foreground,ctx.font="bold "+text_height+"px sans-serif";var text=template.text?template.text:dimensions.width+"x"+dimensions.height;return Math.round(ctx.measureText(text).width)/dimensions.width>1&&(text_height=Math.max(minFactor,template.size)),ctx.font="bold "+text_height+"px sans-serif",ctx.fillText(text,dimensions.width/2,dimensions.height/2,dimensions.width),canvas.toDataURL("image/png")}var preempted=!1,fallback=!1,canvas=document.createElement("canvas");if(canvas.getContext)if(canvas.toDataURL("image/png").indexOf("data:image/png")<0)fallback=!0;else var ctx=canvas.getContext("2d");else fallback=!0;var settings={domain:"holder.js",images:"img",themes:{gray:{background:"#eee",foreground:"#aaa",size:12},social:{background:"#3a5a97",foreground:"#fff",size:12},industrial:{background:"#434A52",foreground:"#C2F200",size:12}}};app.flags={dimensions:{regex:/([0-9]+)x([0-9]+)/,output:function(val){var exec=this.regex.exec(val);return{width:+exec[1],height:+exec[2]}}},colors:{regex:/#([0-9a-f]{3,})\:#([0-9a-f]{3,})/i,output:function(val){var exec=this.regex.exec(val);return{size:settings.themes.gray.size,foreground:"#"+exec[2],background:"#"+exec[1]}}},text:{regex:/text\:(.*)/,output:function(val){return this.regex.exec(val)[1]}}};for(var flag in app.flags)app.flags[flag].match=function(val){return val.match(this.regex)};app.add_theme=function(name,theme){return null!=name&&null!=theme&&(settings.themes[name]=theme),app},app.add_image=function(src,el){var node=selector(el);if(node.length)for(var i=0,l=node.length;l>i;i++){var img=document.createElement("img");img.setAttribute("data-src",src),node[i].appendChild(img)}return app},app.run=function(o){for(var options=extend(settings,o),images=selector(options.images),l=images.length,i=0;l>i;i++){var theme=settings.themes.gray,src=images[i].getAttribute("data-src")||images[i].getAttribute("src");if(~src.indexOf(options.domain)){var render=!1,dimensions=null,text=null,flags=src.substr(src.indexOf(options.domain)+options.domain.length+1).split("/");for(sl=flags.length,j=0;j<sl;j++)app.flags.dimensions.match(flags[j])?(render=!0,dimensions=app.flags.dimensions.output(flags[j])):app.flags.colors.match(flags[j])?theme=app.flags.colors.output(flags[j]):options.themes[flags[j]]?theme=options.themes[flags[j]]:app.flags.text.match(flags[j])&&(text=app.flags.text.output(flags[j]));if(render){images[i].setAttribute("data-src",src);var dimensions_caption=dimensions.width+"x"+dimensions.height;images[i].setAttribute("alt",text?text:theme.text?theme.text+" ["+dimensions_caption+"]":dimensions_caption),images[i].style.backgroundColor=theme.background;var theme=text?extend(theme,{text:text}):theme;fallback||images[i].setAttribute("src",draw(ctx,dimensions,theme))}}}return app},contentLoaded(win,function(){preempted||app.run()})}(Holder,window),function(e,t,n){"use strict";e.fn.foundationNavigation=function(t){var n=!1;Modernizr.touch||navigator.userAgent.match(/Windows Phone/i)?(e(document).on("click.fndtn touchstart.fndtn",".nav-bar a.flyout-toggle",function(t){t.preventDefault();var r=e(this).siblings(".flyout").first();n===!1&&(e(".nav-bar .flyout").not(r).slideUp(500),r.slideToggle(500,function(){n=!1})),n=!0}),e(".nav-bar>li.has-flyout",this).addClass("is-touch")):e(".nav-bar>li.has-flyout",this).hover(function(){e(this).children(".flyout").show()},function(){e(this).children(".flyout").hide()})}}(jQuery,this),function(e,t,n){"use strict";e.fn.foundationButtons=function(t){var n=e(document);n.on("click.fndtn",".button.disabled",function(e){e.preventDefault()}),e(".button.dropdown > ul",this).addClass("no-hover"),n.on("click.fndtn",".button.dropdown, .button.dropdown.split span",function(t){e(".button.dropdown").children("ul").removeClass("show-dropdown"),t.target===this&&t.stopPropagation()}),n.on("click.fndtn",".button.dropdown.split span",function(t){t.preventDefault(),e(".button.dropdown",this).not(e(this).parent()).children("ul").removeClass("show-dropdown"),e(this).siblings("ul").toggleClass("show-dropdown")}),n.on("click.fndtn",".button.dropdown:not(.split)",function(t){e(".button.dropdown",this).not(this).children("ul").removeClass("show-dropdown"),e(this).children("ul").toggleClass("show-dropdown")}),n.on("click.fndtn","body, html",function(){e(".button.dropdown ul").removeClass("show-dropdown");
});var r=e(".button.dropdown:not(.large):not(.small):not(.tiny)",this).outerHeight()-1,i=e(".button.large.dropdown",this).outerHeight()-1,s=e(".button.small.dropdown",this).outerHeight()-1,o=e(".button.tiny.dropdown",this).outerHeight()-1;e(".button.dropdown:not(.large):not(.small):not(.tiny) > ul",this).css("top",r),e(".button.dropdown.large > ul",this).css("top",i),e(".button.dropdown.small > ul",this).css("top",s),e(".button.dropdown.tiny > ul",this).css("top",o),e(".button.dropdown.up:not(.large):not(.small):not(.tiny) > ul",this).css("top","auto").css("bottom",r-2),e(".button.dropdown.up.large > ul",this).css("top","auto").css("bottom",i-2),e(".button.dropdown.up.small > ul",this).css("top","auto").css("bottom",s-2),e(".button.dropdown.up.tiny > ul",this).css("top","auto").css("bottom",o-2)}}(jQuery,this),function(e,t,n){"use strict";e.fn.foundationTabs=function(n){var r=e.extend({callback:e.noop},n),i=function(t){var n=t.closest("dl").find("dd.active"),r=t.children("a").attr("href"),i=/^#/.test(r),s="";i&&(s=r+"Tab",s=s.replace(/^.+#/,"#"),e(s).closest(".tabs-content").children("li").removeClass("active").hide(),e(s).css("display","block").addClass("active")),n.removeClass("active"),t.addClass("active")};e(document).on("click.fndtn","dl.tabs dd a",function(t){i(e(this).parent("dd"))}),t.location.hash&&(i(e('a[href="'+t.location.hash+'"]').parent("dd")),r.callback())}}(jQuery,this),1==CCM_EDIT_MODE||$("#ccm-toolbar").length>0?tooltipOffset=48:tooltipOffset=-1,function(e,t,n){"use strict";var r={bodyHeight:0,selector:".has-tip",additionalInheritableClasses:[],tooltipClass:".tooltip",tipTemplate:function(e,t){return'<span data-selector="'+e+'" class="'+r.tooltipClass.substring(1)+'">'+t+'<span class="nub"></span></span>'}},i={init:function(t){return r=e.extend(r,t),r.selector=r.targetClass?r.targetClass:r.selector,this.each(function(){var t=e("body");Modernizr.touch?(t.on("click.tooltip touchstart.tooltip touchend.tooltip",r.selector,function(t){t.preventDefault(),e(r.tooltipClass).hide(),i.showOrCreateTip(e(this))}),t.on("click.tooltip touchstart.tooltip touchend.tooltip",r.tooltipClass,function(t){t.preventDefault(),e(this).fadeOut(150)})):t.on("mouseenter.tooltip mouseleave.tooltip",r.selector,function(t){var n=e(this);"mouseenter"===t.type?i.showOrCreateTip(n):"mouseleave"===t.type&&i.hide(n)}),e(this).data("tooltips",!0)})},showOrCreateTip:function(e,t){var n=i.getTip(e);n&&n.length>0?i.show(e):i.create(e,t)},getTip:function(t){var n=i.selector(t),s=null;return n&&(s=e("span[data-selector="+n+"]"+r.tooltipClass)),s.length>0?s:!1},selector:function(e){var t=e.attr("id"),r=e.data("selector");return t===n&&r===n&&(r="tooltip"+Math.random().toString(36).substring(7),e.attr("data-selector",r)),t?t:r},create:function(t,n){var s=e(r.tipTemplate(i.selector(t),e("<div>").html(n?n:t.attr("title")).html())),o=i.inheritable_classes(t);s.addClass(o).appendTo("body"),Modernizr.touch&&s.append('<span class="tap-to-close">tap to close </span>'),t.removeAttr("title"),i.show(t)},reposition:function(n,r,i){var s,o,u,a,f,l;if(r.css("visibility","hidden").show(),s=n.data("width"),o=r.children(".nub"),u=o.outerHeight(),a=o.outerWidth(),l=function(e,t,n,r,i,s){return e.css({top:t,bottom:r,left:i,right:n,"max-width":s?s:"auto"}).end()},l(r,n.offset().top+n.outerHeight()+10,"auto","auto",n.offset().left,s),l(o,-u,"auto","auto",10),e(t).width()<767){if(n.data("mobile-width"))r.width(n.data("mobile-width")).css("left",15).addClass("tip-override");else if(f=n.closest(".columns"),f.length<0&&(f=e("body")),f.outerWidth())r.width(f.outerWidth()-25).css("left",15).addClass("tip-override");else{var c=Math.ceil(.9*e(t).width());r.width(c).css("left",15).addClass("tip-override")}l(o,-u,"auto","auto",n.offset().left)}else i&&i.indexOf("tip-top")>-1?(l(r,n.offset().top-r.outerHeight()-u,"auto","auto",n.offset().left,s).removeClass("tip-override"),l(o,"auto","auto",-u,"auto")):i&&i.indexOf("tip-left")>-1?(l(r,n.offset().top+n.outerHeight()/2-u,"auto","auto",n.offset().left-r.outerWidth()-10,s).removeClass("tip-override"),l(o,r.outerHeight()/2-u/2,-u,"auto","auto")):i&&i.indexOf("tip-right")>-1?(l(r,n.offset().top+n.outerHeight()/2-u,"auto","auto",n.offset().left+n.outerWidth()+10,s).removeClass("tip-override"),l(o,r.outerHeight()/2-u/2,"auto","auto",-u)):i&&i.indexOf("tip-upper-right")>-1?(l(r,n.offset().top+n.outerHeight()/2-u,"auto","auto",n.offset().left+n.outerWidth()+10,s).removeClass("tip-override"),l(o,r.outerHeight()/8-u/2,"auto","auto",-u)):i&&i.indexOf("tip-centered-top")>-1?(l(r,n.offset().top-r.outerHeight()-u,"auto","auto",n.offset().left+(n.outerWidth()-r.outerWidth())/2,s).removeClass("tip-override"),l(o,"auto",r.outerWidth()/2-u/2,-u,"auto")):i&&i.indexOf("tip-bottom-right")>-1?(l(r,n.offset().top+35,"auto","auto",n.offset().left-s+n.outerWidth(),s),l(o,-u,10,"auto","auto")):i&&i.indexOf("tip-centered-bottom")>-1&&(l(r,n.offset().top+n.outerHeight()+10,"auto","auto",n.offset().left+(n.outerWidth()-r.outerWidth())/2,s).removeClass("tip-override"),l(o,-u,r.outerWidth()/2-u/2,"auto","auto"));r.css("visibility","visible").hide()},inheritable_classes:function(t){var n=["tip-top","tip-left","tip-bottom","tip-right","tip-centered-top","tip-centered-bottom","tip-upper-right","tip-bottom-right","noradius"].concat(r.additionalInheritableClasses),i=t.attr("class"),s=i?e.map(i.split(" "),function(t,r){return-1!==e.inArray(t,n)?t:void 0}).join(" "):"";return e.trim(s)},show:function(e){var t=i.getTip(e);i.reposition(e,t,e.attr("class")),t.fadeIn(150)},hide:function(e){var t=i.getTip(e);t.fadeOut(150)},reload:function(){var t=e(this);return t.data("tooltips")?t.foundationTooltips("destroy").foundationTooltips("init"):t.foundationTooltips("init")},destroy:function(){return this.each(function(){e(t).off(".tooltip"),e(r.selector).off(".tooltip"),e(r.tooltipClass).each(function(t){e(e(r.selector).get(t)).attr("title",e(this).text())}).remove()})}};e.fn.foundationTooltips=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.foundationTooltips"):i.init.apply(this,arguments)}}(jQuery,this),function(e,t,n){"use strict";e.fn.foundationAccordion=function(t){e(".accordion li",this).on("click.fndtn",function(){var t=e(this).parent(),n=e(this).children(".content").first();e(".content",t).not(n).hide().parent("li").removeClass("active"),n.show(0,function(){n.parent("li").addClass("active")})})}}(jQuery,this),function(e,t,n){function f(e){var t={},r=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!r.test(n.name)&&(t[n.name]=n.value)}),t}function l(e,r){var i=this,s=n(i);if(i.value==s.attr("placeholder")&&s.hasClass("placeholder"))if(s.data("placeholder-password")){if(s=s.hide().next().show().attr("id",s.removeAttr("id").data("placeholder-id")),e===!0)return s[0].value=r;s.focus()}else i.value="",s.removeClass("placeholder"),i==t.activeElement&&i.select()}function c(){var e,t=this,r=n(t),s=this.id;if(""==t.value){if("password"==t.type){if(!r.data("placeholder-textinput")){try{e=r.clone().attr({type:"text"})}catch(o){e=n("<input>").attr(n.extend(f(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":s}).bind("focus.placeholder",l),r.data({"placeholder-textinput":e,"placeholder-id":s}).before(e)}r=r.removeAttr("id").hide().prev().attr("id",s).show()}r.addClass("placeholder"),r[0].value=r.attr("placeholder")}else r.removeClass("placeholder")}var u,a,r="placeholder"in t.createElement("input"),i="placeholder"in t.createElement("textarea"),s=n.fn,o=n.valHooks;r&&i?(a=s.placeholder=function(){return this},a.input=a.textarea=!0):(a=s.placeholder=function(){var e=this;return e.filter((r?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":l,"blur.placeholder":c}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},a.input=r,a.textarea=i,u={get:function(e){var t=n(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,r){var i=n(e);return i.data("placeholder-enabled")?(""==r?(e.value=r,e!=t.activeElement&&c.call(e)):i.hasClass("placeholder")?l.call(e,!0,r)||(e.value=r):e.value=r,i):e.value=r}},r||(o.input=u),i||(o.textarea=u),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(l);setTimeout(function(){e.each(c)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),function(e,t,n){"use strict";e.fn.foundationAlerts=function(t){var n=e.extend({callback:e.noop},t);e(document).on("click",".alert-box a.close",function(t){t.preventDefault(),e(this).closest(".alert-box").fadeOut(function(){e(this).remove(),n.callback()})})}}(jQuery,this),function(e,t,n){"use strict";var r={index:0,initialized:!1},i={init:function(n){return this.each(function(){r=e.extend(r,n),r.$w=e(t),r.$topbar=e("nav.top-bar"),r.$titlebar=r.$topbar.children("ul:first");var s=e("<div class='top-bar-js-breakpoint'/>").appendTo("body");r.breakPoint=s.width(),s.remove(),r.initialized||(i.assemble(),r.initialized=!0),r.height||i.largestUL(),e(".top-bar .toggle-topbar").live("click.fndtn",function(e){e.preventDefault(),i.breakpoint()&&(r.$topbar.toggleClass("expanded"),r.$topbar.css("min-height",""))}),e(".top-bar .has-dropdown>a").live("click.fndtn",function(t){if(t.preventDefault(),i.breakpoint()){var n=e(this),s=n.closest("li"),u=(s.children("ul"),n.closest("section"));r.index+=1,s.addClass("moved"),u.css({left:-(100*r.index)+"%"}),u.find(">.name").css({left:100*r.index+"%"}),n.siblings("ul").height(r.height+r.$titlebar.outerHeight(!0)),r.$topbar.css("min-height",r.height+2*r.$titlebar.outerHeight(!0))}}),e(".top-bar .has-dropdown .back").live("click.fndtn",function(t){t.preventDefault();var n=e(this),i=n.closest("li.moved"),s=n.closest("section");i.parent();r.index-=1,s.css({left:-(100*r.index)+"%"}),s.find(">.name").css({left:100*r.index+"%"}),0===r.index&&r.$topbar.css("min-height",0),setTimeout(function(){i.removeClass("moved")},300)})})},breakpoint:function(){return r.$w.width()<r.breakPoint},assemble:function(){var t=r.$topbar.children("section");t.detach(),t.find(".has-dropdown>a").each(function(){var t=e(this),n=t.siblings(".dropdown"),r=e('<li class="title back js-generated"><h5><a href="#"></a></h5></li>');r.find("h5>a").html(t.html()),n.prepend(r)}),t.appendTo(r.$topbar)},largestUL:function(){var t=r.$topbar.find("section ul ul"),n=t.first(),i=0;t.each(function(){e(this).children("li").length>n.children("li").length&&(n=e(this))}),n.children("li").each(function(){i+=e(this).outerHeight(!0)}),r.height=i}};e.fn.foundationTopBar=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.foundationTopBar"):i.init.apply(this,arguments)}}(jQuery,this),$(window).load(function(){$(".orbit-wrapper").parents(".tabs-content.products-slider-tabs").css("overflow","visible"),$(".orbit-wrapper").parents(".tabs-content.products-slider-tabs").parent(":not(.ccm-page-list)").css("overflow-x","hidden"),$(".orbit-wrapper").parents(".tabScroll.product-area.product-details").css("overflow","visible"),$(".orbit-wrapper").parents(".tabScroll.product-area.product-details").parent(":not(.ccm-page-list)").css("overflow-x","hidden")}),function(e,t,n){"use strict";e.fn.foundationAccordion=function(t){e(".accordion li .title",this).on("click.fndtn",function(){var t=e(this).parent(),n=t.children(".content").first();e(this).children(".title").first();n.parent("li").hasClass("active")?n.hide(0,function(){n.parent("li").removeClass("active")}):n.show(0,function(){n.parent("li").addClass("active")})})}}(jQuery,this),$(".reveal-modal").bind("reveal:close",function(){$(".reveal-modal-bg").length>0&&$(".reveal-modal-bg").remove()}),function(b){function j(e,a){if(0===e.indexOf("#"))b(e).clone(!0).appendTo(c.empty()).show();else{if(a){var d=b("<iframe />").attr({src:e,frameborder:0,hspace:0}).css({width:"100%",height:"100%"});c.html(d)}else c.load(e);c.data("localEl",!1)}}function k(b,a){var d=c.outerWidth(!0),f={},g={};if(!c.is(":visible")&&!h){switch(h=!0,b){case"left":c.css({left:"auto",right:"-"+d+"px"}),f["margin-left"]="-="+d,g.right="+="+d;break;default:c.css({left:"-"+d+"px",right:"auto"}),f["margin-left"]="+="+d,g.left="+="+d}l.animate(f,a),c.show().animate(g,a,function(){h=!1})}}var m,l=b("body"),c=b("#pageslide"),h=!1;0==c.length&&(c=b("<div />").attr("id","pageslide").css("display","none").appendTo(b("body"))),b.fn.pageslide=function(e){this.click(function(a){var d=b(this),f=b.extend({href:d.attr("href")},e);a.preventDefault(),a.stopPropagation(),c.is(":visible")&&d[0]==m?b.pageslide.close():(b.pageslide(f),m=d[0])})},b.fn.pageslide.defaults={speed:200,direction:"right",modal:!1,iframe:!0,href:null},b.pageslide=function(e){var a=b.extend({},b.fn.pageslide.defaults,e);c.is(":visible")&&c.data("direction")!=a.direction?b.pageslide.close(function(){j(a.href,a.iframe),k(a.direction,a.speed)}):(j(a.href,a.iframe),c.is(":hidden")&&k(a.direction,a.speed)),c.data(a)},b.pageslide.close=function(c){var a=b("#pageslide"),d=a.outerWidth(!0),f=a.data("speed"),g={},i={};if(!a.is(":hidden")&&!h){switch(h=!0,a.data("direction")){case"left":g["margin-left"]="+="+d,i.right="-="+d;break;default:g["margin-left"]="-="+d,i.left="-="+d}a.animate(i,f),l.animate(g,f,function(){a.hide(),h=!1,"undefined"!=typeof c&&c()})}},c.click(function(b){b.stopPropagation()}),b(document).bind("click keyup",function(e){"keyup"==e.type&&27!=e.keyCode||c.is(":visible")&&!c.data("modal")&&b.pageslide.close()})}(jQuery);var base_url=location.protocol+"//"+location.hostname+(location.port&&":"+location.port)+"/",whiteArrows=base_url+"packages/cambridge_themes/images/english/hero-nav_white.png",grayArrows=base_url+"packages/cambridge_themes/images/english/hero-nav.png",blueArrows=base_url+"packages/cambridge_themes/images/english/hero-nav_blue.png";if(!LEARNING_THEME_HANDLE)var LEARNING_THEME_HANDLE;$(document).ready(function(){$(".post-triage").flexslider({animation:"slide",slideshow:!0,after:function(){var arrowColour=$(".arrowColour",".flex-active-slide").val();"white"==arrowColour?changeToWhiteArrows():"blue"==arrowColour?changeToBlueArrows():changeToGrayArrows()}}),"white"==$(".arrowColour",".flex-active-slide").val()?changeToWhiteArrows():"blue"==$(".arrowColour",".flex-active-slide").val()?changeToBlueArrows():changeToGrayArrows(),$(".hubslide ul.flex-direction-nav li a.flex-next").on("touchstart",function(){$(this).css("background-color","#777")}),$(".hubslide ul.flex-direction-nav li a.flex-prev").on("touchstart",function(){$(this).css("background-color","#777")}),$(".hubslide ul.flex-direction-nav li a.flex-next").on("touchend",function(){$(this).css("background-color","#fff")}),$(".hubslide ul.flex-direction-nav li a.flex-prev").on("touchend",function(){$(this).css("background-color","#fff")});var $elemPageSlide=CCP_ENABLED?$("#ccpOpenPageSlide"):$(".openPageSlide");$elemPageSlide.pageslide(),$elemPageSlide.click(function(){$("#content").toggleClass("contentFixed"),$(".mainNav").slideUp(400),$(".mainNavToggle").removeClass("mainNavToggleOpen"),$("#ccm-cookiesDisclosure").toggleClass("labelHidden")}),$("#content").click(function(){return!$(this).hasClass("contentFixed")}),$("input[name$='searchOption']").click(function(){var radio_value=$(this).val();"dictionary"==radio_value?($(".dictionarySearch").show(),$(".productsSearch").hide()):"products"==radio_value&&($(".dictionarySearch").hide(),$(".productsSearch").show())}),$(".searchTabs").show(),$(".searchToggle").click(function(){return $(this).toggleClass("searchToggleOpen"),$(".searchBox").slideToggle("fast"),!1}),$(".mainNavToggle").click(function(){return $(this).toggleClass("mainNavToggleOpen"),$(".mainNavWrap > .mainNav").slideToggle("fast"),!1}),$("html:not(.touch) .pretty").dropkick(),$(".dk_toggle").css("width","100%"),$(".mainNav li ul").hide(),$(".mainNav li ul li ul").hide(),$(".mainNav li a span.navExpander").click(function(event){$(window).width()<768&&(event.preventDefault(),$(this).toggleClass("active").parent().next().slideToggle("medium"))}),$(".mainNav li h3 span.navExpander").click(function(event){$(window).width()<768&&(event.preventDefault(),$(this).toggleClass("active").parent().next().slideToggle("medium"))}),$(".pressSearch").hide(),$(".pressToggle").click(function(){return $(".pressSearch").slideToggle("fast"),!1}),$(".contentToggle").click(function(){return $(this).parent().find(".contentHidden").slideToggle("fast",function(){$(".contentToggle").text(function(index,text){return"Close"==text?"Read more":"Close"})}),!1}),$(".contentToggleReviews").click(function(){return $(this).parents("#descriptionTab").find(".contentHiddenReviews").slideToggle("fast",function(){$(".contentToggleReviews").text(function(index,text){return"Close"==text?"See all reviews":"Close"})}),!1}),$(".contentToggleCustomerReviews").click(function(){return $(this).parent().find(".contentHiddenCustomerReviews").slideToggle("fast",function(){$(".contentToggleCustomerReviews").text(function(index,text){return"Close"==text?"See all reviews":"Close"})}),!1}),$(".bookPeopleLink").click(function(){return $(this).parent().find(".bookPeopleHidden").slideToggle("fast",function(){$(".bookPeopleLink").text(function(index,text){return"Close"==text?"See all":"Close"})}),!1}),$(".bookPeopleLink2").click(function(){return $(this).parent().find(".bookPeopleHidden").slideToggle("fast",function(){$(".bookPeopleLink2").text(function(index,text){return"Close"==text?"See all":"Close"})}),!1}),$(".htmlToggle").click(function(){return $(this).parent().find(".contentHidden").slideToggle("fast",function(){$(".htmlToggle").text(function(index,text){return"Hide HTML"==text?"View HTML":"Hide HTML"})}),!1}),1==CCM_EDIT_MODE?$("#landingContent").orbit({bullets:!0,directionalNav:!1,timer:!1,fluid:"965x348",captions:!0,pauseOnHover:!0,startClockOnMouseOut:!0}):$("#landingContent").orbit({bullets:!0,directionalNav:!1,advanceSpeed:6e3,fluid:"965x348",captions:!0,pauseOnHover:!0,startClockOnMouseOut:!0}),1==CCM_EDIT_MODE?($("#homepageSliderButtons").orbit({bullets:!0,directionalNav:!0,captions:!0,timer:!1,pauseOnHover:!0,startClockOnMouseOut:!0}),$("#place-holder").remove()):$("#homepageSliderButtons").orbit({bullets:!0,directionalNav:!0,advanceSpeed:6e3,captions:!0,pauseOnHover:!0,startClockOnMouseOut:!0}),$(".topicsListHidden").hide(),$(".topicsListHiddenBottom").hide(),initListingTypes(),$(".seeSubjects").click(function(){var $topicsListWrapper=$(this).parents("div.seeMoreWrapper").prev("div.subjectTitlesWrapper.main-topics");if($topicsListWrapper.length>0)jQuery(".subjectTitlesWrapper.main-topics").toggle();else{$topicsListWrapper=$(this).parents("div.seeMoreWrapper").prev("div.subjectTitlesWrapper");var $topicsArray=new Array,topicsCount=0,isExpanded=$topicsListWrapper.hasClass("expanded");$topicsListWrapper.find(".topicsList .topTopics").each(function(){var $topic=$(this);$topicsArray[$topic.data("col-index")]=$topic,topicsCount++});for(var noCols=3,noRows=(Math.ceil(topicsCount/noCols),isExpanded?4:Math.ceil(topicsCount/noCols)),row=0;noRows>row;row++){var $rowTo=$topicsListWrapper.find("div#row"+row);if($rowTo.length<=0&&!isExpanded){var $newRow="<div class='row topicsList' id='row"+row+"'></div>";$topicsListWrapper.append($newRow),$rowTo=$topicsListWrapper.find("div#row"+row)}for(var extraCols=topicsCount%noCols,remCols=row!=noRows-1||isExpanded||0==extraCols?noCols:extraCols,column=0;remCols>column;column++){var index=row+column*noRows;column>extraCols&&0!=extraCols&&!isExpanded&&(index-=1),$topicsArray[index].appendTo($rowTo)}}if(isExpanded)for(var i=noRows*noCols;topicsCount>i;i++){var $rowTo=$topicsListWrapper.find(".topicsList.hidden");$topicsArray[i].appendTo($rowTo)}$topicsListWrapper.toggleClass("expanded")}$(this).text(function(index,text){return"See fewer topics"==text?"See more topics":"See fewer topics"})}),$(window).load(function(){$(".seriesGrid li").setAllToMaxHeight()}),$("ul.productsList").addGridLayoutClasses(),$(".refineResultsButton").click(function(){return $(".refinePanel").slideToggle("fast"),!1}),$(".refineResultsButton2").click(function(){return $(".mobileRefine").slideToggle("fast"),!1}),$("a.removeButton").click(function(){return $(this).parent().parent().parent().parent().slideUp(),!1}),$(".rowReveal").hide(),$(".formRevealButton").click(function(){return $(this).addClass("open").parent().hide().next().slideDown("fast"),!1}),$("#change-password-save").click(function(){return $(this).parent().slideUp("fast").prev().show().children().next().removeClass("open"),!1}),$("#change-password-cancel").click(function(){return $(this).parent().slideUp("fast").prev().show().children().next().removeClass("open"),!1}),$(".video-play").on("click",function(){var $this=$(this),video=$(this).data("video");return $this.siblings("iframe").attr("src",video+"?autoplay=1"),$this.hide().siblings("img").hide(),!1}),$(".review-preview").click(function(){return $(".createReviewWrapper").hide(),$(".previewReviewWrapper").show(),!1}),$(".edit-review").click(function(){return $(".previewReviewWrapper").hide(),$(".createReviewWrapper").show(),!1}),$(".button.share").show(),$(".button.share").click(function(){return $(".shareWrap").not($(this).next()).hide(),$(this).next().fadeToggle("fast"),!1}),$(document.body).on("click",function(e){var $share=$(".shareWrap");$share.is(":visible")&&!$(e.target).closest(".shareWrap").length&&$share.fadeOut("fast")}),$(document).on("keyup",function(e){var $share=$(".shareWrap");$share.is(":visible")&&27==e.keyCode&&$share.fadeOut("fast")}),$(".footerShareWrap").show(),$(".optionsHidden .options li input").showSpinnerOnClick(),$(".mainHero").hover(function(){$(".mainHero .orbit-wrapper .slider-nav").fadeIn("fast")},function(){$(".mainHero .orbit-wrapper .slider-nav").fadeOut("fast")}),$(".orderDetailsToggle").click(function(){return $(this).parent().parent().parent().next().slideToggle("fast"),!1}),$(".videos-slider").flexslider(),$("#requestTeacherAccessButton").click(function(){$.ajax({type:"post",data:data,dataType:"json",url:CCM_BASE_URL+"/tools/packages/cambridge_themes/requestTeacherAccess"}),$("#requestTeacherAccess h3").text("Thank you. Your request is now being processed."),$("#requestTeacherAccess .formRow.lastRow.fullRow").html(" "),setTimeout(function(){$("#requestTeacherAccess").trigger("reveal:close")},5e3)}),$.fn.setAllToMaxHeight=function(options){var settings=$.extend({debug:!1},options),height=Math.max.apply(this,$.map(this,function(e){return $(e).outerHeight()}));return settings.debug&&console.log("[.fn.setAllToMaxHeight] Setting height to "+height+"px"),this.height(height)};var layout=getCookieValue("layout");"grid"==layout||$("#result-container").hasClass("grid")?("grid"==layout&&$("#result-container").removeClass("listing").addClass("grid"),window.setTimeout(function(){setGridResultsToMaxHeight()},100)):"listing"==layout&&($("#result-container").removeClass("grid").addClass("listing"),clearResultsMaxHeight()),$("a.resultsGrid").click(function(){document.cookie="layout=grid"}),$("a.resultsListing").click(function(){document.cookie="layout=listing"}),$("#ccpOpenPageSlide").click(function(e){$(this).toggleClass("globalnav_close")}),$("#pageslide").on("click",".submenu:not(.expanded)",function(e){return $(this).toggleClass("open"),$(this).next().slideToggle(250),!1})}),$(window).width()<768&&$(".productDetails li span a").attr("href","#selected-tab"),$(document).ready(function(){if("true"==$("#academicSearchListings").val()){var ovdiv=document.createElement("div");ovdiv.className="optionsHidden",ovdiv.id="topSubjects";var oul=document.createElement("ul");oul.className="options",oul.id="facet_webSubjects";var topSubjCount=1;for(i=1;i<=5;i++){var topSubject=document.querySelector('li[data-subject-rank="'+i+'"]');if(topSubject){var topSubjectClone=topSubject.cloneNode(!0);oul.appendChild(topSubjectClone),topSubjCount=i}}ovdiv.appendChild(oul),$('a.refineEnabled:contains("Subjects")').parent(1).after(ovdiv),initListingTypes(),5>topSubjCount?($("#heading_Subjects span").hide(),$("#heading_Subjects").removeAttr("id")):"false"==$("#academicSubjectsShowAll").val()?($("#topSubjects").show(),$("#topSubjects").next().hide(),$("#heading_Subjects span").html("Show All Subjects"),$('a.refineEnabled:contains("Subjects")').removeClass("open")):($("#topSubjects").hide(),$("#topSubjects").next().show(),$("#heading_Subjects span").html("Show Top Subjects"),$('a.refineEnabled:contains("Subjects")').addClass("open"))}}),navigator.userAgent.match(/iPad/i)&&($(document).ready(function(){768==$(window).width()&&($("ul#nav > li.right").css({display:"none"}),$("ul#nav > li.right > ul > li.navLocation").css({"text-indent":"-9999px",width:"20px",display:"block"}),$("ul#nav > li.right").css({display:"block"}))}),window.onorientationchange=function(){1==$("#filtersForm > div").hasClass("grid")&&($(".bookCover").css("height",""),$(".bookCover").setAllToMaxHeight(),$(".relatedSearch h2").setAllToMaxHeight(),$(".relatedSearch h3").setAllToMaxHeight());window.orientation;1024==$(window).width()?($("ul#nav > li.right > ul > li.navLocation").css({"text-indent":"0",width:"auto"}),$("ul#nav > li.right").css({display:"block"})):768==$(window).width()&&($("ul#nav > li.right > ul > li.navLocation").css({"text-indent":"-9999px",width:"20px",display:"block"}),$("ul#nav > li.right").css({display:"block"})),$("div.products-slider.orbit").trigger("orbit.goto",0)}),function($){"use strict";var isLocationFormLoaded=!1;$(document).on("click.cmbrdg",".navLocation a[data-ajax-reveal-id], .mobileHeader a[data-ajax-reveal-id], a.countryChooser[data-ajax-reveal-id], .mobile-icons a[data-ajax-reveal-id]",function(event){event.preventDefault();var $containerId=$(this).data("ajax-reveal-id"),$container=$("#"+$containerId);if(isLocationFormLoaded)$container.reveal({animation:"none",open:function(){$("#featuredContent").trigger("orbit.stop")},close:function(){$("#featuredContent").trigger("orbit.start")},opened:function(){$.browser.msie||window.opera&&"function"==typeof window.opera.buildNumber||-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")||$("#localeText").focus()},closed:function(){navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/i)||($("#localeText").val(""),$("#locale").val(""),$("#localeForm").validationEngine("hide"))}});else{"undefined"!=typeof uID&&(data.uID=uID);var $opt={url:CCM_REL+"/tools/packages/cambridge_themes/ajax_load_helper",data:data,success:renderAndReveal($container)};$.ajax($opt)}});var renderAndReveal=function($container){return function(data,textStatus){var $anchor=$(CCP_ENABLED?"#global-nav .mobile-icons":".mobileHeader");$anchor.before(data).queue(function(){$("#locationOptions").appendTo("body");var currentURL=$(location).attr("href");currentURL.indexOf("index.php")>0&&$("#localeForm").attr("method","post"),$("#locationOptions").reveal({animation:"none",open:function(){var $localeText=$("#localeText");$.browser.msie||window.opera&&"function"==typeof window.opera.buildNumber||-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")||$localeText.focus(),$localeText.placeholder(),$("#featuredContent").trigger("orbit.stop")},close:function(){$("#featuredContent").trigger("orbit.start")},closed:function(){navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/i)||($("#localeText").val(""),$("#locale").val(""),$("#localeForm").validationEngine("hide"))}});var customErrorMessages={"#localeText":{required:{message:"Please select a country."}}};$(".autocomplete-suggestions").css("width",$("#localeText").width()+18),$("#localeForm").validationEngine("attach",{promptPosition:"inline",validationEventTrigger:"submit",custom_error_messages:customErrorMessages}),$("#localeText").change(function(){""===$(this).val()&&$("#locale").val("")}),isLocationFormLoaded=!0})}}}(jQuery),function($){$(".load-more-books").on("click",function(){$(this).closest(".loadMoreWrap").hide().siblings("div.last-product-item").removeClass("last-product-item").closest(".products-slider").children(":hidden:first").slideDown()})}(jQuery),function($){!isTablet&&isMobile&&$(".homepageSlide").on("click",function(event){$(event.target).not("a.heroButton").length&&(window.location=$(this).find("a.heroButton").attr("href"))})}(jQuery),function($){$.extend($.expr[":"],{hasHiResSprite:function(el){return-1!==$(el).css("background-image").indexOf("images/sprite@2x.png")}}),$("<img>").attr("src","/packages/cambridge_themes/images/sprite@2x.png").error(function(){$(":hasHiResSprite").each(function(){var newUrl=$(this).css("background-image").replace("sprite@2x.png","sprite.png");$(this).attr("style",($(this).attr("style")?$(this).attr("style"):"")+"background-image: "+newUrl+" !important;")})})}(jQuery),function($){$.fn.showSpinner=function(options){var settings=$.extend({targetElem:null,spinnerClass:"spinner",timeout:0,debug:!1},options);return settings.targetElem||(settings.targetElem=$(this).parent()),settings.debug&&console.log("[.fn.showSpinnerOnClick] Adding  '"+settings.spinnerClass+"'"),settings.targetElem.addClass(settings.spinnerClass),settings.timeout&&setTimeout(function(){settings.targetElem.removeClass(settings.spinnerclass)},settings.timeout),this},$.fn.showSpinnerOnClick=function(options){var settings=$.extend({targetElem:null,spinnerClass:"spinner",timeout:0,debug:!1},options);return settings.debug&&console.log("[.fn.showSpinnerOnClick] binding event to click"),$(this).bind("click",function(){$(this).showSpinner(options)}),this},$.fn.addGridLayoutClasses=function(options){var settings=$.extend({elem:"li",numCols:4,breakClass:"noMargin",clearClass:"clearLeft",lastClass:"lastChunk",debug:!1},options);return settings.debug&&console.log("[.fn.addGridLayoutClasses] Adding grid layout classes"),$(settings.elem+":nth-child("+settings.numCols+"n+"+settings.numCols+")",this).addClass(settings.breakClass),$(settings.elem+":nth-child("+settings.numCols+"n+"+(settings.numCols+1)+")",this).addClass(settings.clearClass),$(settings.elem+":last-child",this).addClass(settings.lastClass),this},$.fn.formatSwitcher=function(options){var settings=$.extend({selectorClass:".addCartButton",optionPrefix:"addCart_",debug:!1},options);return settings.debug&&console.log("[.fn.formatSwitcher] binding on change event"),$(this).change(function(){var selectedVal=$(this).val();settings.debug&&console.log("[.fn.formatSwitcher] option "+$(this).val()+" selected"),$(this).siblings(settings.selectorClass).each(function(){$(this).hasClass(settings.optionPrefix+selectedVal)?$(this).show():$(this).hide()});var pubDateWrapper=$(this).parent().prev(".bookDetailsWrap").find("h3 > span.pubDate_"+selectedVal);pubDateWrapper.length>0&&($(pubDateWrapper).siblings(".pubDateButton").each(function(){$(this).hide()}),pubDateWrapper.show())}),this},$.fn.waitUntilExists=function(handler,shouldRunHandlerOnce,isChild){var found="found",$this=$(this.selector),$elements=$this.not(function(){return $(this).data(found)}).each(handler).data(found,!0);return isChild?shouldRunHandlerOnce&&$elements.length&&window.clearInterval(window.waitUntilExists_Intervals[this.selector]):(window.waitUntilExists_Intervals=window.waitUntilExists_Intervals||{})[this.selector]=window.setInterval(function(){$this.waitUntilExists(handler,shouldRunHandlerOnce,!0)},1500),$this}}(jQuery),$(document).ready(function(){$(document).on("focusin","#globalnav li a.submenu",function(){$(this).addClass("hovered").attr("aria-expanded","true")}),$(document).on("focusout","#globalnav li > ul li:last-child",function(){$("#globalnav li a.submenu").removeClass("hovered").attr("aria-expanded","false")}),$(document).on("click",function(e){$target=$(e.target);var a="#globalnav li a.submenu";$target.closest(a).length||$(a).removeClass("hovered").attr("aria-expanded","false")}),$(document).on("mouseenter","#globalnav li a.submenu",function(){
$(this).attr("aria-expanded","true")}),$(document).on("mouseleave","#globalnav li > ul",function(){$("#globalnav li a.submenu").attr("aria-expanded","false")})});var openedFacets=[];$(document).ready(function(){setFacetArrowsAndBoxes(),$(".contentToggleContributors").click(function(){return $(this).parent().find(".contentHiddenContributors").slideToggle("fast",function(){$(".contentToggleContributors").text(function(index,text){return"Hide all contributors"==text?"View all contributors":"Hide all contributors"})}),!1}),$(document).on("click","i.web-subject-arrow",function(){var urlUtil,webSubjArrow=$(this).parent().find("i.web-subject-arrow"),familyListId=$(this).parent().find("ul.family-name-list").attr("id"),inputId=$(this).parent().find("input.webSubjectCb").attr("id");webSubjArrow.hasClass("fa-angle-down")?("undefined"!=typeof UrlUtil&&(urlUtil=new UrlUtil,urlUtil.updateQueryStringParameter(window.location.href,"thirdLvlFacetsExpand[]",$(this).parent().find("ul.thirdLvlFacets").attr("data-facet-title"),!0)),webSubjArrow.removeClass("fa-angle-down"),webSubjArrow.addClass("fa-angle-up"),openedFacets.push(familyListId)):("undefined"!=typeof UrlUtil&&(urlUtil=new UrlUtil,urlUtil.removeQueryStringParameter(window.location.href,"thirdLvlFacetsExpand[]",$(this).parent().find("ul.thirdLvlFacets").attr("data-facet-title"),!0)),webSubjArrow.removeClass("fa-angle-up"),webSubjArrow.addClass("fa-angle-down"),openedFacets.splice($.inArray(familyListId,openedFacets),1)),$("ul#"+inputId+"_list").slideToggle("fast")}),$(".dynamicFormatCartMenu").dropkick(),$(".dynamicFormatCartMenu").formatSwitcher().change(),attachPaginationAjaxFunctionality(),$(".contributorsPeopleLink").click(function(){return $(this).parent().find(".contributorsPeopleHidden").slideToggle("fast",function(){$(this).parent().find(".contributorsPeopleLink").text(function(index,text){return"Hide all contributors"==text?"View all contributors":"Hide all contributors"})}),!1}),$(".titleLinksLink").click(function(){return $(this).parent().find(".titleLinksHidden").slideToggle("fast",function(){$(this).parent().find(".titleLinksLink").text(function(index,text){return"Close"==text?"View all links":"Close"})}),!1}),$("ul.journalsList").addGridLayoutClasses(),$(".blogWrap a.more").click(function(){return $(this).parent().prev().slideDown(400),$(this).parent().hide().next().show(),!1}),$(".blogWrap a.close").click(function(){return $(this).parent().prev().prev().slideUp(400),$(this).parent().hide().prev().show(),$(".slideArrow").hide(),!1}),$(".blogWrap a.more").hover(function(){return $(this).next().slideToggle(50),!1}),changeLinks(),$(".cboxAcademicSs").unbind(),$(".cboxAcademicSs").bind("click",function(){var ssId=$(this).attr("class").split(/\s+/)[0];$(this).is(":checked")?$("."+ssId).prop("checked","checked"):$("."+ssId).prop("checked",!1)}),toggleClearAll()}),$(window).load(function(){$(".orbit-wrapper").parents(".tabs-content.products-slider-tabs").css("overflow","visible"),$(".orbit-wrapper").parents(".tabs-content.products-slider-tabs").parent(":not(.ccm-page-list)").css("overflow-x","hidden"),$(".orbit-wrapper").parents(".tabScroll.product-area.product-details").css("overflow","visible"),$(".orbit-wrapper").parents(".tabScroll.product-area.product-details").parent(":not(.ccm-page-list)").css("overflow-x","hidden"),$(".orbit-slide .product-item").mouseenter(function(){$(this).parent(".orbit-slide").css("z-index","4")}).mouseleave(function(){$(this).parent(".orbit-slide").css("z-index","3")})});var facetTimeoutObj,facetTimeout=750;if($(document).ready(function(){$(".homeTeasers").hover(function(){},function(){$(".homeTeasers>li").fadeTo(150,1)}),$(".homeTeasers>li").hoverIntent(function(){$(this).addClass("Current"),$(this).siblings().fadeTo(150,.5),$(this).fadeTo(150,1)},function(){$(this).removeClass("current"),$(this).fadeTo(50,1)}),$(".navLocation a").on("click",function(){setTimeout(function(){$("#dk_container_select-region").focus()},500)})}),$(document).ready(function(){doResize(),$(window).smartresize(doResize)}),function($,sr){var debounce=function(func,threshold,execAsap){var timeout;return function(){function delayed(){execAsap||func.apply(obj,args),timeout=null}var obj=this,args=arguments;timeout?clearTimeout(timeout):execAsap&&func.apply(obj,args),timeout=setTimeout(delayed,threshold||100)}};jQuery.fn[sr]=function(fn){return fn?this.bind("resize",debounce(fn)):this.trigger(sr)}}(jQuery,"smartresize"),function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:1,interval:10,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY,track=function(ev){cX=ev.pageX,cY=ev.pageY},compare=function(ev,ob){return ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),Math.abs(pX-cX)+Math.abs(pY-cY)<cfg.sensitivity?($(ob).unbind("mousemove",track),ob.hoverIntent_s=1,cfg.over.apply(ob,[ev])):(pX=cX,pY=cY,ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval),void 0)},delay=function(ev,ob){return ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),ob.hoverIntent_s=0,cfg.out.apply(ob,[ev])},handleHover=function(e){var ev=jQuery.extend({},e),ob=this;ob.hoverIntent_t&&(ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)),"mouseenter"==e.type?(pX=ev.pageX,pY=ev.pageY,$(ob).bind("mousemove",track),1!=ob.hoverIntent_s&&(ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval))):($(ob).unbind("mousemove",track),1==ob.hoverIntent_s&&(ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)))};return this.bind("mouseenter",handleHover).bind("mouseleave",handleHover)}}(jQuery),function($,window,document){"use strict";var msVersion=navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/),msie=!!msVersion,ie6=msie&&parseFloat(msVersion[1])<7,isMobile=navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i),methods={},lists=[],keyMap={left:37,up:38,right:39,down:40,enter:13,tab:9,zero:48,z:90,last:221},dropdownTemplate=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','<a class="dk_toggle">','<span class="dk_label">{{ label }}</span>',"</a>",'<div class="dk_options">','<ul class="dk_options_inner">',"</ul>","</div>","</div>"].join(""),optionTemplate='<li class="{{ current }} {{ disabled }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',defaults={startSpeed:400,theme:!1,changes:!1,syncReverse:!0,nativeMobile:!0},$opened=null,$focused=null,updateFields=function(option,$dk,reset){var value,label,data,$select;value=option.attr("data-dk-dropdown-value"),label=option.text(),data=$dk.data("dropkick"),$select=data.$select,$select.val(value).trigger("change"),$dk.find(".dk_label").text(label),reset=reset||!1,!data.settings.change||reset||data.settings.syncReverse||data.settings.change.call($select,value,label),$.isFunction(changeDkLabel)&&changeDkLabel($dk,label)},closeDropdown=function($dk){$dk.removeClass("dk_open"),$opened=null},enoughSpace=function($dk){return!0},setScrollPos=function($dk,anchor,e){var wrapper=$dk.find(".dk_options_inner"),height=anchor.prevAll("li").outerHeight()*anchor.prevAll("li").length,minHeight=wrapper.scrollTop(),maxHeight=wrapper.height()+wrapper.scrollTop()-anchor.outerHeight();(e&&"keydown"===e.type||minHeight>height||height>maxHeight)&&wrapper.scrollTop(height)},openDropdown=function($dk,e){var hasSpace=enoughSpace($dk);$dk.find(".dk_options").css({top:hasSpace?$dk.find(".dk_toggle").outerHeight()-1:"",bottom:hasSpace?"":$dk.find(".dk_toggle").outerHeight()-1}),$opened=$dk.toggleClass("dk_open"),setScrollPos($dk,$dk.find(".dk_option_current"),e)},setCurrent=function($current,$dk,e){$dk.find(".dk_option_current").removeClass("dk_option_current"),$current.addClass("dk_option_current"),setScrollPos($dk,$current,e)},handleKeyBoardNav=function(e,$dk){var next,prev,now,list,i,l,$a,code=e.keyCode,data=$dk.data("dropkick"),letter=String.fromCharCode(code),options=$dk.find(".dk_options"),open=$dk.hasClass("dk_open"),lis=options.find("li"),current=$dk.find(".dk_option_current"),first=lis.first(),last=lis.last();switch(code){case keyMap.enter:open?current.hasClass("disabled")||(updateFields(current.find("a"),$dk),closeDropdown($dk)):openDropdown($dk,e),e.preventDefault();break;case keyMap.tab:open&&(updateFields(current.find("a"),$dk),closeDropdown($dk));break;case keyMap.up:prev=current.prev("li"),open?prev.length?setCurrent(prev,$dk,e):setCurrent(last,$dk,e):openDropdown($dk,e),e.preventDefault();break;case keyMap.down:open?(next=current.next("li").first(),next.length?setCurrent(next,$dk,e):setCurrent(first,$dk,e)):openDropdown($dk,e),e.preventDefault()}if(code>=keyMap.zero&&code<=keyMap.z){for(now=(new Date).getTime(),null===data.finder||"undefined"==typeof data.finder?(data.finder=letter.toUpperCase(),data.timer=now):now>parseInt(data.timer,10)+1e3?(data.finder=letter.toUpperCase(),data.timer=now):(data.finder=data.finder+letter.toUpperCase(),data.timer=now),list=lis.not(".disabled").find("a"),i=0,l=list.length;l>i;i++)if($a=$(list[i]),0===$a.html().toUpperCase().indexOf(data.finder)){updateFields($a,$dk),setCurrent($a.parent(),$dk,e);break}$dk.data("dropkick",data)}},notBlank=function(text){return $.trim(text).length>0?text:!1},build=function(tpl,view){var $dk,i,l,$option,oTemplate,template=tpl.replace("{{ id }}",view.id).replace("{{ label }}",view.label).replace("{{ tabindex }}",view.tabindex),options=[];if(view.options&&view.options.length)for(i=0,l=view.options.length;l>i;i++)$option=$(view.options[i]),oTemplate=0===i&&void 0!==$option.attr("selected")&&void 0!==$option.attr("disabled")?null:optionTemplate.replace("{{ value }}",$option.val()).replace("{{ current }}",notBlank($option.val())===view.value?"dk_option_current":"").replace("{{ disabled }}",void 0!==$option.attr("disabled")?"disabled":"").replace("{{ text }}",jQuery.trim($option.html())),options[options.length]=oTemplate;return $dk=$(template),$dk.find(".dk_options_inner").html(options.join("")),$dk};ie6||(document.documentElement.className=document.documentElement.className+" dk_fouc"),methods.init=function(settings){return settings=$.extend({},defaults,settings),this.each(function(){var theme,$form,$select=$(this),$original=$select.find(":selected").first(),$options=$select.find("option"),data=$select.data("dropkick")||{},id=$select.attr("id")||$select.attr("name"),width=settings.width||$select.outerWidth(),tabindex=$select.attr("tabindex")||"0",$dk=!1;return data.id?$select:(data.settings=settings,data.tabindex=tabindex,data.id=id,data.$original=$original,data.$select=$select,data.value=notBlank($select.val())||notBlank($original.attr("value")),data.label=$original.text(),data.options=$options,$dk=build(dropdownTemplate,data),$dk.find(".dk_toggle").css({width:width+"px"}),$select.before($dk),$dk=$('div[id="dk_container_'+id+'"]').fadeIn(settings.startSpeed),theme=settings.theme||"default",$dk.addClass("dk_theme_"+theme),data.theme=theme,data.$dk=$dk,$select.data("dropkick",data),$dk.data("dropkick",data),lists[lists.length]=$select,$dk.bind("focus.dropkick",function(){$focused=$dk.addClass("dk_focus")}).bind("blur.dropkick",function(){$dk.removeClass("dk_focus"),$focused=null}),isMobile&&data.settings.nativeMobile&&$dk.addClass("dk_mobile"),data.settings.syncReverse&&$select.on("change",function(e){var value=$select.val(),option=$('a[data-dk-dropdown-value="'+value+'"]',$dk),label=option.text();$dk.find(".dk_label").text(label),data.settings.change&&data.settings.change.call($select,value,label),setCurrent(option.parent(),$dk,e)}),($select.attr("form")||$select.closest("form").length)&&($form=$select.attr("form")?$("#"+$select.attr("form").replace(" ",", #")):$select.closest("form"),$form.on("reset",function(){$select.dropkick("reset")})),void setTimeout(function(){$select.hide()},0))})},methods.theme=function(newTheme){var data=$(this).data("dropkick"),$dk=data.$dk,oldtheme="dk_theme_"+data.theme;$dk.removeClass(oldtheme).addClass("dk_theme_"+newTheme),data.theme=newTheme},methods.reset=function(){return this.each(function(){var data=$(this).data("dropkick"),$dk=data.$dk,$current=$('a[data-dk-dropdown-value="'+data.value+'"]',$dk);!data.$original.eq(0).prop("selected")&&data.$original.eq(0).prop("selected",!0),$dk.find(".dk_label").text(data.label),setCurrent($current.parent(),$dk)})},methods.setValue=function(value){var $dk=$(this).data("dropkick").$dk,$option=$('.dk_options a[data-dk-dropdown-value="'+value+'"]',$dk);$option.length?(updateFields($option,$dk),setCurrent($option.parent(),$dk)):console.warn("There is no option with this value in the <select>")},methods.refresh=function(){return this.each(function(){var data=$(this).data("dropkick");if("undefined"!=typeof data){var $select=data.$select,$dk=data.$dk;data.settings.startSpeed=0,$select.removeData("dropkick").insertAfter($dk),$dk.remove(),$select.dropkick(data.settings)}})},$.fn.dropkick=function(method){if(!ie6){if(methods[method])return methods[method].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof method||!method)return methods.init.apply(this,arguments)}},$(function(){$(document).on(msie?"mousedown":"click",".dk_options a",function(){var $option=$(this),$dk=$option.parents(".dk_container").first();return $option.parent().hasClass("disabled")||(updateFields($option,$dk),setCurrent($option.parent(),$dk),closeDropdown($dk)),!1}),$(document).bind("keydown.dk_nav",function(e){var $dk=null;$opened?$dk=$opened:$focused&&!$opened&&($dk=$focused),$dk&&handleKeyBoardNav(e,$dk)}),$(document).on("click",null,function(e){if($opened&&0===$(e.target).closest(".dk_container").length)closeDropdown($opened);else if($(e.target).is(".dk_toggle, .dk_label")){var $dk=$(e.target).parents(".dk_container").first();return $dk.hasClass("dk_open")?closeDropdown($dk):($opened&&closeDropdown($opened),openDropdown($dk,e)),!1}});var wheelSupport="onwheel"in window?"wheel":"onmousewheel"in document?"mousewheel":"MouseScrollEvent"in window?"DOMMouseScroll MozMousePixelScroll":!1;wheelSupport&&$(document).on(wheelSupport,".dk_options_inner",function(event){var delta=event.originalEvent.wheelDelta||-event.originalEvent.deltaY||-event.originalEvent.detail;return msie?(this.scrollTop-=Math.round(delta/10),!1):delta>0&&this.scrollTop<=0||0>delta&&this.scrollTop>=this.scrollHeight-this.offsetHeight?!1:!0})})}(jQuery,window,document),function($){$.flexslider=function(el,options){var slider=$(el),vars=$.extend({},$.flexslider.defaults,options),namespace=vars.namespace,touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,eventType=touch?"touchend":"click",vertical="vertical"===vars.direction,reverse=vars.reverse,carousel=vars.itemWidth>0,fade="fade"===vars.animation,asNav=""!==vars.asNavFor,methods={};$.data(el,"flexslider",slider),methods={init:function(){slider.animating=!1,slider.currentSlide=vars.startAt,slider.animatingTo=slider.currentSlide,slider.atEnd=0===slider.currentSlide||slider.currentSlide===slider.last,slider.containerSelector=vars.selector.substr(0,vars.selector.search(" ")),slider.slides=$(vars.selector,slider),slider.container=$(slider.containerSelector,slider),slider.count=slider.slides.length,slider.syncExists=$(vars.sync).length>0,"slide"===vars.animation&&(vars.animation="swing"),slider.prop=vertical?"top":"marginLeft",slider.args={},slider.manualPause=!1,slider.transitions=!vars.video&&!fade&&vars.useCSS&&function(){var obj=document.createElement("div"),props=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in props)if(void 0!==obj.style[props[i]])return slider.pfx=props[i].replace("Perspective","").toLowerCase(),slider.prop="-"+slider.pfx+"-transform",!0;return!1}(),""!==vars.controlsContainer&&(slider.controlsContainer=$(vars.controlsContainer).length>0&&$(vars.controlsContainer)),""!==vars.manualControls&&(slider.manualControls=$(vars.manualControls).length>0&&$(vars.manualControls)),vars.randomize&&(slider.slides.sort(function(){return Math.round(Math.random())-.5}),slider.container.empty().append(slider.slides)),slider.doMath(),asNav&&methods.asNav.setup(),slider.setup("init"),vars.controlNav&&methods.controlNav.setup(),vars.directionNav&&methods.directionNav.setup(),vars.keyboard&&(1===$(slider.containerSelector).length||vars.multipleKeyboard)&&$(document).bind("keyup",function(event){var keycode=event.keyCode;if(!slider.animating&&(39===keycode||37===keycode)){var target=39===keycode?slider.getTarget("next"):37===keycode?slider.getTarget("prev"):!1;slider.flexAnimate(target,vars.pauseOnAction)}}),vars.mousewheel&&slider.bind("mousewheel",function(event,delta,deltaX,deltaY){event.preventDefault();var target=0>delta?slider.getTarget("next"):slider.getTarget("prev");slider.flexAnimate(target,vars.pauseOnAction)}),vars.pausePlay&&methods.pausePlay.setup(),vars.slideshow&&(vars.pauseOnHover&&slider.hover(function(){slider.manualPlay||slider.manualPause||slider.pause()},function(){slider.manualPause||slider.manualPlay||slider.play()}),vars.initDelay>0?setTimeout(slider.play,vars.initDelay):slider.play()),touch&&vars.touch&&methods.touch(),(!fade||fade&&vars.smoothHeight)&&$(window).bind("resize focus",methods.resize),setTimeout(function(){vars.start(slider)},200)},asNav:{setup:function(){slider.asNav=!0,slider.animatingTo=Math.floor(slider.currentSlide/slider.move),slider.currentItem=slider.currentSlide,slider.slides.removeClass(namespace+"active-slide").eq(slider.currentItem).addClass(namespace+"active-slide"),slider.slides.click(function(e){e.preventDefault();var $slide=$(this),target=$slide.index();$(vars.asNavFor).data("flexslider").animating||$slide.hasClass("active")||(slider.direction=slider.currentItem<target?"next":"prev",slider.flexAnimate(target,vars.pauseOnAction,!1,!0,!0))})}},controlNav:{setup:function(){slider.manualControls?methods.controlNav.setupManual():methods.controlNav.setupPaging()},setupPaging:function(){var item,type="thumbnails"===vars.controlNav?"control-thumbs":"control-paging",j=1;if(slider.controlNavScaffold=$('<ol class="'+namespace+"control-nav "+namespace+type+'"></ol>'),slider.pagingCount>1)for(var i=0;i<slider.pagingCount;i++)item="thumbnails"===vars.controlNav?'<img src="'+slider.slides.eq(i).attr("data-thumb")+'"/>':"<a>"+j+"</a>",slider.controlNavScaffold.append("<li>"+item+"</li>"),j++;slider.controlsContainer?$(slider.controlsContainer).append(slider.controlNavScaffold):slider.append(slider.controlNavScaffold),methods.controlNav.set(),methods.controlNav.active(),slider.controlNavScaffold.delegate("a, img",eventType,function(event){event.preventDefault();var $this=$(this),target=slider.controlNav.index($this);$this.hasClass(namespace+"active")||(slider.direction=target>slider.currentSlide?"next":"prev",slider.flexAnimate(target,vars.pauseOnAction))}),touch&&slider.controlNavScaffold.delegate("a","click touchstart",function(event){event.preventDefault()})},setupManual:function(){slider.controlNav=slider.manualControls,methods.controlNav.active(),slider.controlNav.live(eventType,function(event){event.preventDefault();var $this=$(this),target=slider.controlNav.index($this);$this.hasClass(namespace+"active")||(target>slider.currentSlide?slider.direction="next":slider.direction="prev",slider.flexAnimate(target,vars.pauseOnAction))}),touch&&slider.controlNav.live("click touchstart",function(event){event.preventDefault()})},set:function(){var selector="thumbnails"===vars.controlNav?"img":"a";slider.controlNav=$("."+namespace+"control-nav li "+selector,slider.controlsContainer?slider.controlsContainer:slider)},active:function(){slider.controlNav.removeClass(namespace+"active").eq(slider.animatingTo).addClass(namespace+"active")},update:function(action,pos){slider.pagingCount>1&&"add"===action?slider.controlNavScaffold.append($("<li><a>"+slider.count+"</a></li>")):1===slider.pagingCount?slider.controlNavScaffold.find("li").remove():slider.controlNav.eq(pos).closest("li").remove(),methods.controlNav.set(),slider.pagingCount>1&&slider.pagingCount!==slider.controlNav.length?slider.update(pos,action):methods.controlNav.active()}},directionNav:{setup:function(){var directionNavScaffold=$('<ul class="'+namespace+'direction-nav"><li><a class="'+namespace+'prev" href="#">'+vars.prevText+'</a></li><li><a class="'+namespace+'next" href="#">'+vars.nextText+"</a></li></ul>");slider.controlsContainer?($(slider.controlsContainer).append(directionNavScaffold),slider.directionNav=$("."+namespace+"direction-nav li a",slider.controlsContainer)):(slider.append(directionNavScaffold),slider.directionNav=$("."+namespace+"direction-nav li a",slider)),methods.directionNav.update(),slider.directionNav.bind(eventType,function(event){event.preventDefault();var target=$(this).hasClass(namespace+"next")?slider.getTarget("next"):slider.getTarget("prev");slider.flexAnimate(target,vars.pauseOnAction)}),touch&&slider.directionNav.bind("click touchstart",function(event){event.preventDefault()})},update:function(){var disabledClass=namespace+"disabled";1===slider.pagingCount?slider.directionNav.addClass(disabledClass):vars.animationLoop?slider.directionNav.removeClass(disabledClass):0===slider.animatingTo?slider.directionNav.removeClass(disabledClass).filter("."+namespace+"prev").addClass(disabledClass):slider.animatingTo===slider.last?slider.directionNav.removeClass(disabledClass).filter("."+namespace+"next").addClass(disabledClass):slider.directionNav.removeClass(disabledClass)}},pausePlay:{setup:function(){var pausePlayScaffold=$('<div class="'+namespace+'pauseplay"><a></a></div>');slider.controlsContainer?(slider.controlsContainer.append(pausePlayScaffold),slider.pausePlay=$("."+namespace+"pauseplay a",slider.controlsContainer)):(slider.append(pausePlayScaffold),slider.pausePlay=$("."+namespace+"pauseplay a",slider)),methods.pausePlay.update(vars.slideshow?namespace+"pause":namespace+"play"),slider.pausePlay.bind(eventType,function(event){event.preventDefault(),$(this).hasClass(namespace+"pause")?(slider.manualPause=!0,slider.manualPlay=!1,slider.pause()):(slider.manualPause=!1,slider.manualPlay=!0,slider.play())}),touch&&slider.pausePlay.bind("click touchstart",function(event){event.preventDefault()})},update:function(state){"play"===state?slider.pausePlay.removeClass(namespace+"pause").addClass(namespace+"play").text(vars.playText):slider.pausePlay.removeClass(namespace+"play").addClass(namespace+"pause").text(vars.pauseText)}},touch:function(){function onTouchStart(e){slider.animating?e.preventDefault():1===e.touches.length&&(slider.pause(),cwidth=vertical?slider.h:slider.w,startT=Number(new Date),offset=carousel&&reverse&&slider.animatingTo===slider.last?0:carousel&&reverse?slider.limit-(slider.itemW+vars.itemMargin)*slider.move*slider.animatingTo:carousel&&slider.currentSlide===slider.last?slider.limit:carousel?(slider.itemW+vars.itemMargin)*slider.move*slider.currentSlide:reverse?(slider.last-slider.currentSlide+slider.cloneOffset)*cwidth:(slider.currentSlide+slider.cloneOffset)*cwidth,startX=vertical?e.touches[0].pageY:e.touches[0].pageX,startY=vertical?e.touches[0].pageX:e.touches[0].pageY,el.addEventListener("touchmove",onTouchMove,!1),el.addEventListener("touchend",onTouchEnd,!1))}function onTouchMove(e){dx=vertical?startX-e.touches[0].pageY:startX-e.touches[0].pageX,scrolling=vertical?Math.abs(dx)<Math.abs(e.touches[0].pageX-startY):Math.abs(dx)<Math.abs(e.touches[0].pageY-startY),(!scrolling||Number(new Date)-startT>500)&&(e.preventDefault(),!fade&&slider.transitions&&(vars.animationLoop||(dx/=0===slider.currentSlide&&0>dx||slider.currentSlide===slider.last&&dx>0?Math.abs(dx)/cwidth+2:1),slider.setProps(offset+dx,"setTouch")))}function onTouchEnd(e){if(el.removeEventListener("touchmove",onTouchMove,!1),slider.animatingTo===slider.currentSlide&&!scrolling&&null!==dx){var updateDx=reverse?-dx:dx,target=updateDx>0?slider.getTarget("next"):slider.getTarget("prev");slider.canAdvance(target)&&(Number(new Date)-startT<550&&Math.abs(updateDx)>50||Math.abs(updateDx)>cwidth/2)?slider.flexAnimate(target,vars.pauseOnAction):fade||slider.flexAnimate(slider.currentSlide,vars.pauseOnAction,!0)}el.removeEventListener("touchend",onTouchEnd,!1),startX=null,startY=null,dx=null,offset=null}var startX,startY,offset,cwidth,dx,startT,scrolling=!1;el.addEventListener("touchstart",onTouchStart,!1)},resize:function(){!slider.animating&&slider.is(":visible")&&(carousel||slider.doMath(),fade?methods.smoothHeight():carousel?(slider.slides.width(slider.computedW),slider.update(slider.pagingCount),slider.setProps()):vertical?(slider.viewport.height(slider.h),slider.setProps(slider.h,"setTotal")):(vars.smoothHeight&&methods.smoothHeight(),slider.newSlides.width(slider.computedW),slider.setProps(slider.computedW,"setTotal")))},smoothHeight:function(dur){if(!vertical||fade){var $obj=fade?slider:slider.viewport;dur?$obj.animate({height:slider.slides.eq(slider.animatingTo).height()},dur):$obj.height(slider.slides.eq(slider.animatingTo).height())}},sync:function(action){var $obj=$(vars.sync).data("flexslider"),target=slider.animatingTo;switch(action){case"animate":$obj.flexAnimate(target,vars.pauseOnAction,!1,!0);break;case"play":$obj.playing||$obj.asNav||$obj.play();break;case"pause":$obj.pause()}}},slider.flexAnimate=function(target,pause,override,withSync,fromNav){if(asNav&&1===slider.pagingCount&&(slider.direction=slider.currentItem<target?"next":"prev"),!slider.animating&&(slider.canAdvance(target,fromNav)||override)&&slider.is(":visible")){if(asNav&&withSync){var master=$(vars.asNavFor).data("flexslider");if(slider.atEnd=0===target||target===slider.count-1,master.flexAnimate(target,!0,!1,!0,fromNav),slider.direction=slider.currentItem<target?"next":"prev",master.direction=slider.direction,Math.ceil((target+1)/slider.visible)-1===slider.currentSlide||0===target)return slider.currentItem=target,slider.slides.removeClass(namespace+"active-slide").eq(target).addClass(namespace+"active-slide"),!1;slider.currentItem=target,slider.slides.removeClass(namespace+"active-slide").eq(target).addClass(namespace+"active-slide"),target=Math.floor(target/slider.visible)}if(slider.animating=!0,slider.animatingTo=target,vars.before(slider),pause&&slider.pause(),slider.syncExists&&!fromNav&&methods.sync("animate"),vars.controlNav&&methods.controlNav.active(),carousel||slider.slides.removeClass(namespace+"active-slide").eq(target).addClass(namespace+"active-slide"),slider.atEnd=0===target||target===slider.last,vars.directionNav&&methods.directionNav.update(),target===slider.last&&(vars.end(slider),vars.animationLoop||slider.pause()),fade)touch?(slider.slides.eq(slider.currentSlide).css({opacity:0,zIndex:1}),slider.slides.eq(target).css({opacity:1,zIndex:2}),slider.animating=!1,slider.currentSlide=slider.animatingTo):(slider.slides.eq(slider.currentSlide).fadeOut(vars.animationSpeed,vars.easing),slider.slides.eq(target).fadeIn(vars.animationSpeed,vars.easing,slider.wrapup));else{var margin,slideString,calcNext,dimension=vertical?slider.slides.filter(":first").height():slider.computedW;carousel?(margin=vars.itemWidth>slider.w?2*vars.itemMargin:vars.itemMargin,calcNext=(slider.itemW+margin)*slider.move*slider.animatingTo,slideString=calcNext>slider.limit&&1!==slider.visible?slider.limit:calcNext):slideString=0===slider.currentSlide&&target===slider.count-1&&vars.animationLoop&&"next"!==slider.direction?reverse?(slider.count+slider.cloneOffset)*dimension:0:slider.currentSlide===slider.last&&0===target&&vars.animationLoop&&"prev"!==slider.direction?reverse?0:(slider.count+1)*dimension:reverse?(slider.count-1-target+slider.cloneOffset)*dimension:(target+slider.cloneOffset)*dimension,slider.setProps(slideString,"",vars.animationSpeed),slider.transitions?(vars.animationLoop&&slider.atEnd||(slider.animating=!1,slider.currentSlide=slider.animatingTo),slider.container.unbind("webkitTransitionEnd transitionend"),slider.container.bind("webkitTransitionEnd transitionend",function(){slider.wrapup(dimension)})):slider.container.animate(slider.args,vars.animationSpeed,vars.easing,function(){slider.wrapup(dimension)})}vars.smoothHeight&&methods.smoothHeight(vars.animationSpeed)}},slider.wrapup=function(dimension){fade||carousel||(0===slider.currentSlide&&slider.animatingTo===slider.last&&vars.animationLoop?slider.setProps(dimension,"jumpEnd"):slider.currentSlide===slider.last&&0===slider.animatingTo&&vars.animationLoop&&slider.setProps(dimension,"jumpStart")),slider.animating=!1,slider.currentSlide=slider.animatingTo,vars.after(slider)},slider.animateSlides=function(){slider.animating||slider.flexAnimate(slider.getTarget("next"))},slider.pause=function(){clearInterval(slider.animatedSlides),slider.playing=!1,vars.pausePlay&&methods.pausePlay.update("play"),slider.syncExists&&methods.sync("pause")},slider.play=function(){slider.animatedSlides=setInterval(slider.animateSlides,vars.slideshowSpeed),slider.playing=!0,vars.pausePlay&&methods.pausePlay.update("pause"),slider.syncExists&&methods.sync("play")},slider.canAdvance=function(target,fromNav){var last=asNav?slider.pagingCount-1:slider.last;return fromNav?!0:asNav&&slider.currentItem===slider.count-1&&0===target&&"prev"===slider.direction?!0:asNav&&0===slider.currentItem&&target===slider.pagingCount-1&&"next"!==slider.direction?!1:target!==slider.currentSlide||asNav?vars.animationLoop?!0:slider.atEnd&&0===slider.currentSlide&&target===last&&"next"!==slider.direction?!1:slider.atEnd&&slider.currentSlide===last&&0===target&&"next"===slider.direction?!1:!0:!1},slider.getTarget=function(dir){return slider.direction=dir,"next"===dir?slider.currentSlide===slider.last?0:slider.currentSlide+1:0===slider.currentSlide?slider.last:slider.currentSlide-1},slider.setProps=function(pos,special,dur){var target=function(){var posCheck=pos?pos:(slider.itemW+vars.itemMargin)*slider.move*slider.animatingTo,posCalc=function(){if(carousel)return"setTouch"===special?pos:reverse&&slider.animatingTo===slider.last?0:reverse?slider.limit-(slider.itemW+vars.itemMargin)*slider.move*slider.animatingTo:slider.animatingTo===slider.last?slider.limit:posCheck;switch(special){case"setTotal":return reverse?(slider.count-1-slider.currentSlide+slider.cloneOffset)*pos:(slider.currentSlide+slider.cloneOffset)*pos;case"setTouch":return reverse?pos:pos;case"jumpEnd":return reverse?pos:slider.count*pos;case"jumpStart":return reverse?slider.count*pos:pos;default:return pos}}();return-1*posCalc+"px"}();slider.transitions&&(target=vertical?"translate3d(0,"+target+",0)":"translate3d("+target+",0,0)",dur=void 0!==dur?dur/1e3+"s":"0s",slider.container.css("-"+slider.pfx+"-transition-duration",dur)),slider.args[slider.prop]=target,(slider.transitions||void 0===dur)&&slider.container.css(slider.args)},slider.setup=function(type){if(fade)slider.slides.css({width:"100%","float":"left",marginRight:"-100%",position:"relative"}),"init"===type&&(touch?slider.slides.css({opacity:0,display:"block",webkitTransition:"opacity "+vars.animationSpeed/1e3+"s ease",zIndex:1}).eq(slider.currentSlide).css({opacity:1,zIndex:2}):slider.slides.eq(slider.currentSlide).fadeIn(vars.animationSpeed,vars.easing)),vars.smoothHeight&&methods.smoothHeight();else{var sliderOffset,arr;"init"===type&&(slider.viewport=$('<div class="'+namespace+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(slider).append(slider.container),slider.cloneCount=0,slider.cloneOffset=0,reverse&&(arr=$.makeArray(slider.slides).reverse(),slider.slides=$(arr),slider.container.empty().append(slider.slides))),vars.animationLoop&&!carousel&&(slider.cloneCount=2,slider.cloneOffset=1,"init"!==type&&slider.container.find(".clone").remove(),slider.container.append(slider.slides.first().clone().addClass("clone")).prepend(slider.slides.last().clone().addClass("clone"))),slider.newSlides=$(vars.selector,slider),sliderOffset=reverse?slider.count-1-slider.currentSlide+slider.cloneOffset:slider.currentSlide+slider.cloneOffset,vertical&&!carousel?(slider.container.height(200*(slider.count+slider.cloneCount)+"%").css("position","absolute").width("100%"),setTimeout(function(){slider.newSlides.css({display:"block"}),
slider.doMath(),slider.viewport.height(slider.h),slider.setProps(sliderOffset*slider.h,"init")},"init"===type?100:0)):(slider.container.width(200*(slider.count+slider.cloneCount)+"%"),slider.setProps(sliderOffset*slider.computedW,"init"),setTimeout(function(){slider.doMath(),slider.newSlides.css({width:slider.computedW,"float":"left",display:"block"}),vars.smoothHeight&&methods.smoothHeight()},"init"===type?100:0))}carousel||slider.slides.removeClass(namespace+"active-slide").eq(slider.currentSlide).addClass(namespace+"active-slide")},slider.doMath=function(){var slide=slider.slides.first(),slideMargin=vars.itemMargin,minItems=vars.minItems,maxItems=vars.maxItems;slider.w=slider.width(),slider.h=slide.height(),slider.boxPadding=slide.outerWidth()-slide.width(),carousel?(slider.itemT=vars.itemWidth+slideMargin,slider.minW=minItems?minItems*slider.itemT:slider.w,slider.maxW=maxItems?maxItems*slider.itemT:slider.w,slider.itemW=slider.minW>slider.w?(slider.w-slideMargin*minItems)/minItems:slider.maxW<slider.w?(slider.w-slideMargin*maxItems)/maxItems:vars.itemWidth>slider.w?slider.w:vars.itemWidth,slider.visible=Math.floor(slider.w/(slider.itemW+slideMargin)),slider.move=vars.move>0&&vars.move<slider.visible?vars.move:slider.visible,slider.pagingCount=Math.ceil((slider.count-slider.visible)/slider.move+1),slider.last=slider.pagingCount-1,slider.limit=1===slider.pagingCount?0:vars.itemWidth>slider.w?(slider.itemW+2*slideMargin)*slider.count-slider.w-slideMargin:(slider.itemW+slideMargin)*slider.count-slider.w-slideMargin):(slider.itemW=slider.w,slider.pagingCount=slider.count,slider.last=slider.count-1),slider.computedW=slider.itemW-slider.boxPadding},slider.update=function(pos,action){slider.doMath(),carousel||(pos<slider.currentSlide?slider.currentSlide+=1:pos<=slider.currentSlide&&0!==pos&&(slider.currentSlide-=1),slider.animatingTo=slider.currentSlide),vars.controlNav&&!slider.manualControls&&("add"===action&&!carousel||slider.pagingCount>slider.controlNav.length?methods.controlNav.update("add"):("remove"===action&&!carousel||slider.pagingCount<slider.controlNav.length)&&(carousel&&slider.currentSlide>slider.last&&(slider.currentSlide-=1,slider.animatingTo-=1),methods.controlNav.update("remove",slider.last))),vars.directionNav&&methods.directionNav.update()},slider.addSlide=function(obj,pos){var $obj=$(obj);slider.count+=1,slider.last=slider.count-1,vertical&&reverse?void 0!==pos?slider.slides.eq(slider.count-pos).after($obj):slider.container.prepend($obj):void 0!==pos?slider.slides.eq(pos).before($obj):slider.container.append($obj),slider.update(pos,"add"),slider.slides=$(vars.selector+":not(.clone)",slider),slider.setup(),vars.added(slider)},slider.removeSlide=function(obj){var pos=isNaN(obj)?slider.slides.index($(obj)):obj;slider.count-=1,slider.last=slider.count-1,isNaN(obj)?$(obj,slider.slides).remove():vertical&&reverse?slider.slides.eq(slider.last).remove():slider.slides.eq(obj).remove(),slider.doMath(),slider.update(pos,"remove"),slider.slides=$(vars.selector+":not(.clone)",slider),slider.setup(),vars.removed(slider)},methods.init()},$.flexslider.defaults={namespace:"flex-",selector:".slides > li",animation:"fade",easing:"swing",direction:"horizontal",reverse:!1,animationLoop:!0,smoothHeight:!1,startAt:0,slideshow:!1,slideshowSpeed:7e3,animationSpeed:600,initDelay:0,randomize:!1,pauseOnAction:!0,pauseOnHover:!1,useCSS:!1,touch:!0,video:!1,controlNav:!0,directionNav:!0,prevText:"Previous",nextText:"Next",keyboard:!0,multipleKeyboard:!1,mousewheel:!1,pausePlay:!1,pauseText:"Pause",playText:"Play",controlsContainer:"",manualControls:"",sync:"",asNavFor:"",itemWidth:0,itemMargin:0,minItems:0,maxItems:0,move:0,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){}},$.fn.flexslider=function(options){if(void 0===options&&(options={}),"object"==typeof options)return this.each(function(){var $this=$(this),selector=options.selector?options.selector:".slides > li",$slides=$this.find(selector);1===$slides.length?($slides.fadeIn(400),options.start&&options.start($this)):void 0===$this.data("flexslider")&&new $.flexslider(this,options)});var $slider=$(this).data("flexslider");switch(options){case"play":$slider.play();break;case"pause":$slider.pause();break;case"next":$slider.flexAnimate($slider.getTarget("next"),!0);break;case"prev":case"previous":$slider.flexAnimate($slider.getTarget("prev"),!0);break;default:"number"==typeof options&&$slider.flexAnimate(options,!0)}}}(jQuery),!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function d(b,c){var e=function(){},f=this,g={autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:d.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:e,onSearchComplete:e,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",lookupFilter:function(a,b,c){return-1!==a.value.toLowerCase().indexOf(c)},paramName:"query",transformResult:function(b){return"string"==typeof b?a.parseJSON(b):b}};f.element=b,f.el=a(b),f.suggestions=[],f.badQueries=[],f.selectedIndex=-1,f.currentValue=f.element.value,f.intervalId=0,f.cachedResponse=[],f.onChangeInterval=null,f.onChange=null,f.ignoreValueChange=!1,f.isLocal=!1,f.suggestionsContainer=null,f.options=a.extend({},g,c),f.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},f.initialize(),f.setOptions(c)}var b=function(){return{extend:function(b,c){return a.extend(b,c)},createNode:function(a){var b=document.createElement("div");return b.innerHTML=a,b.firstChild}}}(),c={ESC:27,TAB:9,RETURN:13,UP:38,DOWN:40};d.utils=b,a.Autocomplete=d,d.formatResult=function(a,b){var c=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),d="("+b.replace(c,"\\$1")+")";return a.value.replace(new RegExp(d,"gi"),"<strong>$1</strong>")},d.prototype={killerFn:null,initialize:function(){var g,b=this,c="."+b.classes.suggestion,e=b.classes.selected,f=b.options;b.element.setAttribute("autocomplete","off"),b.killerFn=function(c){0===a(c.target).closest("."+b.options.containerClass).length&&(b.killSuggestions(),b.disableKillerFn())},f.width&&"auto"!==f.width||(f.width=b.el.outerWidth()),b.suggestionsContainer=d.utils.createNode('<div class="'+f.containerClass+'" style="position: absolute; display: none;"></div>'),g=a(b.suggestionsContainer),g.appendTo(f.appendTo).width(f.width),g.on("mouseover.autocomplete",c,function(){b.activate(a(this).data("index"))}),g.on("mouseout.autocomplete",function(){b.selectedIndex=-1,g.children("."+e).removeClass(e)}),g.on("click.autocomplete",c,function(){b.select(a(this).data("index"),!1)}),b.fixPosition(),b.el.on("keydown.autocomplete",function(a){b.onKeyPress(a)}),window.opera="undefined"!=typeof window.opera?window.opera:new Object({}),window.opera.version="function"==typeof window.opera.version?window.opera.version:function(){},window.opera&&window.opera.version()<12.14&&(b.el.unbind("keydown.autocomplete"),b.el.on("keypress.autocomplete",function(a){b.onKeyPress(a)})),b.el.on("keyup.autocomplete",function(a){b.onKeyUp(a)}),b.el.on("blur.autocomplete",function(){b.onBlur()}),b.el.on("focus.autocomplete",function(){b.fixPosition()})},onBlur:function(){this.enableKillerFn()},setOptions:function(c){var d=this,e=d.options;b.extend(e,c),d.isLocal=a.isArray(e.lookup),d.isLocal&&(e.lookup=d.verifySuggestionsFormat(e.lookup)),a(d.suggestionsContainer).css({"max-height":e.maxHeight+"px",width:e.width+"px","z-index":e.zIndex})},clearCache:function(){this.cachedResponse=[],this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue=null,this.suggestions=[]},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},fixPosition:function(){var c,b=this;"body"===b.options.appendTo&&(c=b.el.offset(),a(b.suggestionsContainer).css({top:c.top+b.el.outerHeight()+"px",left:c.left+"px"}))},enableKillerFn:function(){var b=this;a(document).on("click.autocomplete",b.killerFn)},disableKillerFn:function(){var b=this;a(document).off("click.autocomplete",b.killerFn)},killSuggestions:function(){var a=this;a.stopKillSuggestions(),a.intervalId=window.setInterval(function(){a.hide(),a.stopKillSuggestions()},300)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},onKeyPress:function(a){var b=this;if(!b.disabled&&!b.visible&&a.keyCode===c.DOWN&&b.currentValue)return void b.suggest();if(!b.disabled&&b.visible){switch(a.keyCode){case c.ESC:b.el.val(b.currentValue),b.hide();break;case c.TAB:case c.RETURN:if(-1===b.selectedIndex)return void b.hide();if(b.select(b.selectedIndex,a.keyCode===c.RETURN),a.keyCode===c.TAB&&this.options.tabDisabled===!1)return;break;case c.UP:b.moveUp();break;case c.DOWN:b.moveDown();break;default:return}a.stopImmediatePropagation(),a.preventDefault()}},onKeyUp:function(a){var b=this;if(!b.disabled){switch(a.keyCode){case c.UP:case c.DOWN:return}clearInterval(b.onChangeInterval),b.currentValue!==b.el.val()&&(b.options.deferRequestBy>0?b.onChangeInterval=setInterval(function(){b.onValueChange()},b.options.deferRequestBy):b.onValueChange())}},onValueChange:function(){var b,a=this;return clearInterval(a.onChangeInterval),a.currentValue=a.element.value,b=a.getQuery(a.currentValue),a.selectedIndex=-1,a.ignoreValueChange?void(a.ignoreValueChange=!1):void(b.length<a.options.minChars?a.hide():a.getSuggestions(b))},getQuery:function(b){var d,c=this.options.delimiter;return c?(d=b.split(c),a.trim(d[d.length-1])):a.trim(b)},getSuggestionsLocal:function(b){var c=this,d=b.toLowerCase(),e=c.options.lookupFilter;return{suggestions:a.grep(c.options.lookup,function(a){return e(a,b,d)})}},getSuggestions:function(b){var c,d=this,e=d.options,f=e.serviceUrl;if(c=d.isLocal?d.getSuggestionsLocal(b):d.cachedResponse[b],c&&a.isArray(c.suggestions))d.suggestions=c.suggestions,d.suggest();else if(!d.isBadQuery(b)){if(e.params[e.paramName]=b,e.onSearchStart.call(d.element,e.params)===!1)return;a.isFunction(e.serviceUrl)&&(f=e.serviceUrl.call(d.element,b)),a.ajax({url:f,data:e.ignoreParams?null:e.params,type:e.type,dataType:e.dataType}).done(function(a){d.processResponse(a,b),e.onSearchComplete.call(d.element,b)})}},isBadQuery:function(a){for(var b=this.badQueries,c=b.length;c--;)if(0===a.indexOf(b[c]))return!0;return!1},hide:function(){var b=this;b.visible=!1,b.selectedIndex=-1,a(b.suggestionsContainer).hide()},suggest:function(){if(0===this.suggestions.length)return void this.hide();var b=this,c=b.options.formatResult,d=b.getQuery(b.currentValue),e=b.classes.suggestion,f=b.classes.selected,g=a(b.suggestionsContainer),h="";a.each(b.suggestions,function(a,b){h+='<div class="'+e+'" data-index="'+a+'">'+c(b,d)+"</div>"}),g.html(h).show(),b.visible=!0,b.options.autoSelectFirst&&(b.selectedIndex=0,g.children().first().addClass(f))},verifySuggestionsFormat:function(b){return b.length&&"string"==typeof b[0]?a.map(b,function(a){return{value:a,data:null}}):b},processResponse:function(a,b){var c=this,d=c.options,e=d.transformResult(a,b);e.suggestions=c.verifySuggestionsFormat(e.suggestions),d.noCache||(c.cachedResponse[e[d.paramName]]=e,0===e.suggestions.length&&c.badQueries.push(e[d.paramName])),b===c.getQuery(c.currentValue)&&(c.suggestions=e.suggestions,c.suggest())},activate:function(b){var d,c=this,e=c.classes.selected,f=a(c.suggestionsContainer),g=f.children();return f.children("."+e).removeClass(e),c.selectedIndex=b,-1!==c.selectedIndex&&g.length>c.selectedIndex?(d=g.get(c.selectedIndex),a(d).addClass(e),d):null},select:function(a,b){var c=this,d=c.suggestions[a];d&&(c.el.val(d),c.ignoreValueChange=b,c.hide(),c.onSelect(a))},moveUp:function(){var b=this;return-1!==b.selectedIndex?0===b.selectedIndex?(a(b.suggestionsContainer).children().first().removeClass(b.classes.selected),b.selectedIndex=-1,void b.el.val(b.currentValue)):void b.adjustScroll(b.selectedIndex-1):void 0},moveDown:function(){var a=this;a.selectedIndex!==a.suggestions.length-1&&a.adjustScroll(a.selectedIndex+1)},adjustScroll:function(b){var e,f,g,c=this,d=c.activate(b),h=25;d&&(e=d.offsetTop,f=a(c.suggestionsContainer).scrollTop(),g=f+c.options.maxHeight-h,f>e?a(c.suggestionsContainer).scrollTop(e):e>g&&a(c.suggestionsContainer).scrollTop(e-c.options.maxHeight+h),c.el.val(c.getValue(c.suggestions[b].value)))},onSelect:function(b){var c=this,d=c.options.onSelect,e=c.suggestions[b];c.el.val(c.getValue(e.value)),a.isFunction(d)&&d.call(c.element,e)},getValue:function(a){var d,e,b=this,c=b.options.delimiter;return c?(d=b.currentValue,e=d.split(c),1===e.length?a:d.substr(0,d.length-e[e.length-1].length)+a):a},dispose:function(){var b=this;b.el.off(".autocomplete").removeData("autocomplete"),b.disableKillerFn(),a(b.suggestionsContainer).remove()}},a.fn.dAutocomplete=function(b,c){var e="autocomplete";return 0===arguments.length?this.first().data(e):this.each(function(){var f=a(this),g=f.data(e);"string"==typeof b?g&&"function"==typeof g[b]&&g[b](c):(g&&g.dispose&&g.dispose(),g=new d(this,b),f.data(e,g))})}}),function(window,document,$,undefined){"use strict";var W=$(window),D=$(document),F=$.fancybox=function(){F.open.apply(this,arguments)},didUpdate=null,isTouch=document.createTouch!==undefined,isQuery=function(obj){return obj&&obj.hasOwnProperty&&obj instanceof $},isString=function(str){return str&&"string"===$.type(str)},isPercentage=function(str){return isString(str)&&str.indexOf("%")>0},isScrollable=function(el){return el&&!(el.style.overflow&&"hidden"===el.style.overflow)&&(el.clientWidth&&el.scrollWidth>el.clientWidth||el.clientHeight&&el.scrollHeight>el.clientHeight)},getScalar=function(orig,dim){var value=parseInt(orig,10)||0;return dim&&isPercentage(orig)&&(value=F.getViewport()[dim]/100*value),Math.ceil(value)},getValue=function(value,dim){return getScalar(value,dim)+"px"};$.extend(F,{version:"2.1.3",defaults:{padding:10,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!isTouch,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+($.browser.msie?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:$.noop,beforeLoad:$.noop,afterLoad:$.noop,beforeShow:$.noop,afterShow:$.noop,beforeChange:$.noop,beforeClose:$.noop,afterClose:$.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(group,opts){return group&&($.isPlainObject(opts)||(opts={}),!1!==F.close(!0))?($.isArray(group)||(group=isQuery(group)?$(group).get():[group]),$.each(group,function(i,element){var href,title,content,type,rez,hrefParts,selector,obj={};"object"===$.type(element)&&(element.nodeType&&(element=$(element)),isQuery(element)?(obj={href:element.data("fancybox-href")||element.attr("href"),title:element.data("fancybox-title")||element.attr("title"),isDom:!0,element:element},$.metadata&&$.extend(!0,obj,element.metadata())):obj=element),href=opts.href||obj.href||(isString(element)?element:null),title=opts.title!==undefined?opts.title:obj.title||"",content=opts.content||obj.content,type=content?"html":opts.type||obj.type,!type&&obj.isDom&&(type=element.data("fancybox-type"),type||(rez=element.prop("class").match(/fancybox\.(\w+)/),type=rez?rez[1]:null)),isString(href)&&(type||(F.isImage(href)?type="image":F.isSWF(href)?type="swf":"#"===href.charAt(0)?type="inline":isString(element)&&(type="html",content=element)),"ajax"===type&&(hrefParts=href.split(/\s+/,2),href=hrefParts.shift(),selector=hrefParts.shift())),content||("inline"===type?href?content=$(isString(href)?href.replace(/.*(?=#[^\s]+$)/,""):href):obj.isDom&&(content=element):"html"===type?content=href:type||href||!obj.isDom||(type="inline",content=element)),$.extend(obj,{href:href,type:type,content:content,title:title,selector:selector}),group[i]=obj}),F.opts=$.extend(!0,{},F.defaults,opts),opts.keys!==undefined&&(F.opts.keys=opts.keys?$.extend({},F.defaults.keys,opts.keys):!1),F.group=group,F._start(F.opts.index)):void 0},cancel:function(){var coming=F.coming;coming&&!1!==F.trigger("onCancel")&&(F.hideLoading(),F.ajaxLoad&&F.ajaxLoad.abort(),F.ajaxLoad=null,F.imgPreload&&(F.imgPreload.onload=F.imgPreload.onerror=null),coming.wrap&&coming.wrap.stop(!0,!0).trigger("onReset").remove(),F.coming=null,F.current||F._afterZoomOut(coming))},close:function(event){F.cancel(),!1!==F.trigger("beforeClose")&&(F.unbindEvents(),F.isActive&&(F.isOpen&&event!==!0?(F.isOpen=F.isOpened=!1,F.isClosing=!0,$(".fancybox-item, .fancybox-nav").remove(),F.wrap.stop(!0,!0).removeClass("fancybox-opened"),F.transitions[F.current.closeMethod]()):($(".fancybox-wrap").stop(!0).trigger("onReset").remove(),F._afterZoomOut())))},play:function(action){var clear=function(){clearTimeout(F.player.timer)},set=function(){clear(),F.current&&F.player.isActive&&(F.player.timer=setTimeout(F.next,F.current.playSpeed))},stop=function(){clear(),$("body").unbind(".player"),F.player.isActive=!1,F.trigger("onPlayEnd")},start=function(){F.current&&(F.current.loop||F.current.index<F.group.length-1)&&(F.player.isActive=!0,$("body").bind({"afterShow.player onUpdate.player":set,"onCancel.player beforeClose.player":stop,"beforeLoad.player":clear}),set(),F.trigger("onPlayStart"))};action===!0||!F.player.isActive&&action!==!1?start():stop()},next:function(direction){var current=F.current;current&&(isString(direction)||(direction=current.direction.next),F.jumpto(current.index+1,direction,"next"))},prev:function(direction){var current=F.current;current&&(isString(direction)||(direction=current.direction.prev),F.jumpto(current.index-1,direction,"prev"))},jumpto:function(index,direction,router){var current=F.current;current&&(index=getScalar(index),F.direction=direction||current.direction[index>=current.index?"next":"prev"],F.router=router||"jumpto",current.loop&&(0>index&&(index=current.group.length+index%current.group.length),index%=current.group.length),current.group[index]!==undefined&&(F.cancel(),F._start(index)))},reposition:function(e,onlyAbsolute){var pos,current=F.current,wrap=current?current.wrap:null;wrap&&(pos=F._getPosition(onlyAbsolute),e&&"scroll"===e.type?(delete pos.position,wrap.stop(!0,!0).animate(pos,200)):(wrap.css(pos),current.pos=$.extend({},current.dim,pos)))},update:function(e){var type=e&&e.type,anyway=!type||"orientationchange"===type;anyway&&(clearTimeout(didUpdate),didUpdate=null),F.isOpen&&!didUpdate&&(didUpdate=setTimeout(function(){var current=F.current;current&&!F.isClosing&&(F.wrap.removeClass("fancybox-tmp"),(anyway||"load"===type||"resize"===type&&current.autoResize)&&F._setDimension(),"scroll"===type&&current.canShrink||F.reposition(e),F.trigger("onUpdate"),didUpdate=null)},anyway&&!isTouch?0:300))},toggle:function(action){F.isOpen&&(F.current.fitToView="boolean"===$.type(action)?action:!F.current.fitToView,isTouch&&(F.wrap.removeAttr("style").addClass("fancybox-tmp"),F.trigger("onUpdate")),F.update())},hideLoading:function(){D.unbind(".loading"),$("#fancybox-loading").remove()},showLoading:function(){var el,viewport;F.hideLoading(),el=$('<div id="fancybox-loading"><div></div></div>').click(F.cancel).appendTo("body"),D.bind("keydown.loading",function(e){27===(e.which||e.keyCode)&&(e.preventDefault(),F.cancel())}),F.defaults.fixed||(viewport=F.getViewport(),el.css({position:"absolute",top:.5*viewport.h+viewport.y,left:.5*viewport.w+viewport.x}))},getViewport:function(){var locked=F.current&&F.current.locked||!1,rez={x:W.scrollLeft(),y:W.scrollTop()};return locked?(rez.w=locked[0].clientWidth,rez.h=locked[0].clientHeight):(rez.w=isTouch&&window.innerWidth?window.innerWidth:W.width(),rez.h=isTouch&&window.innerHeight?window.innerHeight:W.height()),rez},unbindEvents:function(){F.wrap&&isQuery(F.wrap)&&F.wrap.unbind(".fb"),D.unbind(".fb"),W.unbind(".fb")},bindEvents:function(){var keys,current=F.current;current&&(W.bind("orientationchange.fb"+(isTouch?"":" resize.fb")+(current.autoCenter&&!current.locked?" scroll.fb":""),F.update),keys=current.keys,keys&&D.bind("keydown.fb",function(e){var code=e.which||e.keyCode,target=e.target||e.srcElement;return 27===code&&F.coming?!1:void(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||target&&(target.type||$(target).is("[contenteditable]"))||$.each(keys,function(i,val){return current.group.length>1&&val[code]!==undefined?(F[i](val[code]),e.preventDefault(),!1):$.inArray(code,val)>-1?(F[i](),e.preventDefault(),!1):void 0}))}),$.fn.mousewheel&&current.mouseWheel&&F.wrap.bind("mousewheel.fb",function(e,delta,deltaX,deltaY){for(var target=e.target||null,parent=$(target),canScroll=!1;parent.length&&!(canScroll||parent.is(".fancybox-skin")||parent.is(".fancybox-wrap"));)canScroll=isScrollable(parent[0]),parent=$(parent).parent();0===delta||canScroll||F.group.length>1&&!current.canShrink&&(deltaY>0||deltaX>0?F.prev(deltaY>0?"down":"left"):(0>deltaY||0>deltaX)&&F.next(0>deltaY?"up":"right"),e.preventDefault())}))},trigger:function(event,o){var ret,obj=o||F.coming||F.current;if(obj){if($.isFunction(obj[event])&&(ret=obj[event].apply(obj,Array.prototype.slice.call(arguments,1))),ret===!1)return!1;obj.helpers&&$.each(obj.helpers,function(helper,opts){opts&&F.helpers[helper]&&$.isFunction(F.helpers[helper][event])&&(opts=$.extend(!0,{},F.helpers[helper].defaults,opts),F.helpers[helper][event](opts,obj))}),$.event.trigger(event+".fb")}},isImage:function(str){return isString(str)&&str.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp)((\?|#).*)?$)/i)},isSWF:function(str){return isString(str)&&str.match(/\.(swf)((\?|#).*)?$/i)},_start:function(index){var obj,href,type,margin,padding,coming={};if(index=getScalar(index),obj=F.group[index]||null,!obj)return!1;if(coming=$.extend(!0,{},F.opts,obj),margin=coming.margin,padding=coming.padding,"number"===$.type(margin)&&(coming.margin=[margin,margin,margin,margin]),"number"===$.type(padding)&&(coming.padding=[padding,padding,padding,padding]),coming.modal&&$.extend(!0,coming,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),coming.autoSize&&(coming.autoWidth=coming.autoHeight=!0),"auto"===coming.width&&(coming.autoWidth=!0),"auto"===coming.height&&(coming.autoHeight=!0),coming.group=F.group,coming.index=index,F.coming=coming,!1===F.trigger("beforeLoad"))return void(F.coming=null);if(type=coming.type,href=coming.href,!type)return F.coming=null,F.current&&F.router&&"jumpto"!==F.router?(F.current.index=index,F[F.router](F.direction)):!1;if(F.isActive=!0,("image"===type||"swf"===type)&&(coming.autoHeight=coming.autoWidth=!1,coming.scrolling="visible"),"image"===type&&(coming.aspectRatio=!0),"iframe"===type&&isTouch&&(coming.scrolling="scroll"),coming.wrap=$(coming.tpl.wrap).addClass("fancybox-"+(isTouch?"mobile":"desktop")+" fancybox-type-"+type+" fancybox-tmp "+coming.wrapCSS).appendTo(coming.parent||"body"),$.extend(coming,{skin:$(".fancybox-skin",coming.wrap),outer:$(".fancybox-outer",coming.wrap),inner:$(".fancybox-inner",coming.wrap)}),$.each(["Top","Right","Bottom","Left"],function(i,v){coming.skin.css("padding"+v,getValue(coming.padding[i]))}),F.trigger("onReady"),"inline"===type||"html"===type){if(!coming.content||!coming.content.length)return F._error("content")}else if(!href)return F._error("href");"image"===type?F._loadImage():"ajax"===type?F._loadAjax():"iframe"===type?F._loadIframe():F._afterLoad()},_error:function(type){$.extend(F.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:type,content:F.coming.tpl.error}),F._afterLoad()},_loadImage:function(){var img=F.imgPreload=new Image;img.onload=function(){this.onload=this.onerror=null,F.coming.width=this.width,F.coming.height=this.height,F._afterLoad()},img.onerror=function(){this.onload=this.onerror=null,F._error("image")},img.src=F.coming.href,img.complete!==!0&&F.showLoading()},_loadAjax:function(){var coming=F.coming;F.showLoading(),F.ajaxLoad=$.ajax($.extend({},coming.ajax,{url:coming.href,error:function(jqXHR,textStatus){F.coming&&"abort"!==textStatus?F._error("ajax",jqXHR):F.hideLoading()},success:function(data,textStatus){"success"===textStatus&&(coming.content=data,F._afterLoad())}}))},_loadIframe:function(){var coming=F.coming,iframe=$(coming.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",isTouch?"auto":coming.iframe.scrolling).attr("src",coming.href);$(coming.wrap).bind("onReset",function(){try{$(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),coming.iframe.preload&&(F.showLoading(),iframe.one("load",function(){$(this).data("ready",1),isTouch||$(this).bind("load.fb",F.update),$(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),F._afterLoad()})),coming.content=iframe.appendTo(coming.inner),coming.iframe.preload||F._afterLoad()},_preloadImages:function(){var item,i,group=F.group,current=F.current,len=group.length,cnt=current.preload?Math.min(current.preload,len-1):0;for(i=1;cnt>=i;i+=1)item=group[(current.index+i)%len],"image"===item.type&&item.href&&((new Image).src=item.href)},_afterLoad:function(){var current,content,type,scrolling,href,embed,coming=F.coming,previous=F.current,placeholder="fancybox-placeholder";if(F.hideLoading(),coming&&F.isActive!==!1){if(!1===F.trigger("afterLoad",coming,previous))return coming.wrap.stop(!0).trigger("onReset").remove(),void(F.coming=null);switch(previous&&(F.trigger("beforeChange",previous),previous.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),F.unbindEvents(),current=coming,content=coming.content,type=coming.type,scrolling=coming.scrolling,$.extend(F,{wrap:current.wrap,skin:current.skin,outer:current.outer,inner:current.inner,current:current,previous:previous}),href=current.href,type){case"inline":case"ajax":case"html":current.selector?content=$("<div>").html(content).find(current.selector):isQuery(content)&&(content.data(placeholder)||content.data(placeholder,$('<div class="'+placeholder+'"></div>').insertAfter(content).hide()),content=content.show().detach(),current.wrap.bind("onReset",function(){$(this).find(content).length&&content.hide().replaceAll(content.data(placeholder)).data(placeholder,!1)}));break;case"image":content=current.tpl.image.replace("{href}",href);break;case"swf":content='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+href+'"></param>',embed="",$.each(current.swf,function(name,val){content+='<param name="'+name+'" value="'+val+'"></param>',embed+=" "+name+'="'+val+'"'}),content+='<embed src="'+href+'" type="application/x-shockwave-flash" width="100%" height="100%"'+embed+"></embed></object>"}isQuery(content)&&content.parent().is(current.inner)||current.inner.append(content),F.trigger("beforeShow"),current.inner.css("overflow","yes"===scrolling?"scroll":"no"===scrolling?"hidden":scrolling),F._setDimension(),F.reposition(),F.isOpen=!1,F.coming=null,F.bindEvents(),F.isOpened?previous.prevMethod&&F.transitions[previous.prevMethod]():$(".fancybox-wrap").not(current.wrap).stop(!0).trigger("onReset").remove(),F.transitions[F.isOpened?current.nextMethod:current.openMethod](),F._preloadImages()}},_setDimension:function(){var wPadding,hPadding,wSpace,hSpace,origWidth,origHeight,origMaxWidth,origMaxHeight,ratio,width_,height_,maxWidth_,maxHeight_,iframe,body,viewport=F.getViewport(),steps=0,canShrink=!1,canExpand=!1,wrap=F.wrap,skin=F.skin,inner=F.inner,current=F.current,width=current.width,height=current.height,minWidth=current.minWidth,minHeight=current.minHeight,maxWidth=current.maxWidth,maxHeight=current.maxHeight,scrolling=current.scrolling,scrollOut=current.scrollOutside?current.scrollbarWidth:0,margin=current.margin,wMargin=getScalar(margin[1]+margin[3]),hMargin=getScalar(margin[0]+margin[2]);if(wrap.add(skin).add(inner).width("auto").height("auto").removeClass("fancybox-tmp"),wPadding=getScalar(skin.outerWidth(!0)-skin.width()),hPadding=getScalar(skin.outerHeight(!0)-skin.height()),wSpace=wMargin+wPadding,hSpace=hMargin+hPadding,origWidth=isPercentage(width)?(viewport.w-wSpace)*getScalar(width)/100:width,origHeight=isPercentage(height)?(viewport.h-hSpace)*getScalar(height)/100:height,"iframe"===current.type){if(iframe=current.content,current.autoHeight&&1===iframe.data("ready"))try{iframe[0].contentWindow.document.location&&(inner.width(origWidth).height(9999),body=iframe.contents().find("body"),scrollOut&&body.css("overflow-x","hidden"),origHeight=body.height())}catch(e){}}else(current.autoWidth||current.autoHeight)&&(inner.addClass("fancybox-tmp"),current.autoWidth||inner.width(origWidth),current.autoHeight||inner.height(origHeight),current.autoWidth&&(origWidth=inner.width()),current.autoHeight&&(origHeight=inner.height()),inner.removeClass("fancybox-tmp"));if(width=getScalar(origWidth),height=getScalar(origHeight),ratio=origWidth/origHeight,minWidth=getScalar(isPercentage(minWidth)?getScalar(minWidth,"w")-wSpace:minWidth),maxWidth=getScalar(isPercentage(maxWidth)?getScalar(maxWidth,"w")-wSpace:maxWidth),minHeight=getScalar(isPercentage(minHeight)?getScalar(minHeight,"h")-hSpace:minHeight),maxHeight=getScalar(isPercentage(maxHeight)?getScalar(maxHeight,"h")-hSpace:maxHeight),origMaxWidth=maxWidth,origMaxHeight=maxHeight,current.fitToView&&(maxWidth=Math.min(viewport.w-wSpace,maxWidth),maxHeight=Math.min(viewport.h-hSpace,maxHeight)),maxWidth_=viewport.w-wMargin,maxHeight_=viewport.h-hMargin,current.aspectRatio?(width>maxWidth&&(width=maxWidth,height=getScalar(width/ratio)),height>maxHeight&&(height=maxHeight,width=getScalar(height*ratio)),minWidth>width&&(width=minWidth,height=getScalar(width/ratio)),minHeight>height&&(height=minHeight,width=getScalar(height*ratio))):(width=Math.max(minWidth,Math.min(width,maxWidth)),current.autoHeight&&"iframe"!==current.type&&(inner.width(width),height=inner.height()),height=Math.max(minHeight,Math.min(height,maxHeight))),current.fitToView)if(inner.width(width).height(height),wrap.width(width+wPadding),width_=wrap.width(),height_=wrap.height(),current.aspectRatio)for(;(width_>maxWidth_||height_>maxHeight_)&&width>minWidth&&height>minHeight&&!(steps++>19);)height=Math.max(minHeight,Math.min(maxHeight,height-10)),
width=getScalar(height*ratio),minWidth>width&&(width=minWidth,height=getScalar(width/ratio)),width>maxWidth&&(width=maxWidth,height=getScalar(width/ratio)),inner.width(width).height(height),wrap.width(width+wPadding),width_=wrap.width(),height_=wrap.height();else width=Math.max(minWidth,Math.min(width,width-(width_-maxWidth_))),height=Math.max(minHeight,Math.min(height,height-(height_-maxHeight_)));scrollOut&&"auto"===scrolling&&origHeight>height&&maxWidth_>width+wPadding+scrollOut&&(width+=scrollOut),inner.width(width).height(height),wrap.width(width+wPadding),width_=wrap.width(),height_=wrap.height(),canShrink=(width_>maxWidth_||height_>maxHeight_)&&width>minWidth&&height>minHeight,canExpand=current.aspectRatio?origMaxWidth>width&&origMaxHeight>height&&origWidth>width&&origHeight>height:(origMaxWidth>width||origMaxHeight>height)&&(origWidth>width||origHeight>height),$.extend(current,{dim:{width:getValue(width_),height:getValue(height_)},origWidth:origWidth,origHeight:origHeight,canShrink:canShrink,canExpand:canExpand,wPadding:wPadding,hPadding:hPadding,wrapSpace:height_-skin.outerHeight(!0),skinSpace:skin.height()-height}),!iframe&&current.autoHeight&&height>minHeight&&maxHeight>height&&!canExpand&&inner.height("auto")},_getPosition:function(onlyAbsolute){var current=F.current,viewport=F.getViewport(),margin=current.margin,width=F.wrap.width()+margin[1]+margin[3],height=F.wrap.height()+margin[0]+margin[2],rez={position:"absolute",top:margin[0],left:margin[3]};return current.autoCenter&&current.fixed&&!onlyAbsolute&&height<=viewport.h&&width<=viewport.w?rez.position="fixed":current.locked||(rez.top+=viewport.y,rez.left+=viewport.x),rez.top=getValue(Math.max(rez.top,rez.top+(viewport.h-height)*current.topRatio)),rez.left=getValue(Math.max(rez.left,rez.left+(viewport.w-width)*current.leftRatio)),rez},_afterZoomIn:function(){var current=F.current;current&&(F.isOpen=F.isOpened=!0,F.wrap.css("overflow","visible").addClass("fancybox-opened"),F.update(),(current.closeClick||current.nextClick&&F.group.length>1)&&F.inner.css("cursor","pointer").bind("click.fb",function(e){$(e.target).is("a")||$(e.target).parent().is("a")||(e.preventDefault(),F[current.closeClick?"close":"next"]())}),current.closeBtn&&$(current.tpl.closeBtn).appendTo(F.skin).bind(isTouch?"touchstart.fb":"click.fb",function(e){e.preventDefault(),F.close()}),current.arrows&&F.group.length>1&&((current.loop||current.index>0)&&$(current.tpl.prev).appendTo(F.outer).bind("click.fb",F.prev),(current.loop||current.index<F.group.length-1)&&$(current.tpl.next).appendTo(F.outer).bind("click.fb",F.next)),F.trigger("afterShow"),current.loop||current.index!==current.group.length-1?F.opts.autoPlay&&!F.player.isActive&&(F.opts.autoPlay=!1,F.play()):F.play(!1))},_afterZoomOut:function(obj){obj=obj||F.current,$(".fancybox-wrap").trigger("onReset").remove(),$.extend(F,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),F.trigger("afterClose",obj)}}),F.transitions={getOrigPosition:function(){var current=F.current,element=current.element,orig=current.orig,pos={},width=50,height=50,hPadding=current.hPadding,wPadding=current.wPadding,viewport=F.getViewport();return!orig&&current.isDom&&element.is(":visible")&&(orig=element.find("img:first"),orig.length||(orig=element)),isQuery(orig)?(pos=orig.offset(),orig.is("img")&&(width=orig.outerWidth(),height=orig.outerHeight())):(pos.top=viewport.y+(viewport.h-height)*current.topRatio,pos.left=viewport.x+(viewport.w-width)*current.leftRatio),("fixed"===F.wrap.css("position")||current.locked)&&(pos.top-=viewport.y,pos.left-=viewport.x),pos={top:getValue(pos.top-hPadding*current.topRatio),left:getValue(pos.left-wPadding*current.leftRatio),width:getValue(width+wPadding),height:getValue(height+hPadding)}},step:function(now,fx){var ratio,padding,value,prop=fx.prop,current=F.current,wrapSpace=current.wrapSpace,skinSpace=current.skinSpace;("width"===prop||"height"===prop)&&(ratio=fx.end===fx.start?1:(now-fx.start)/(fx.end-fx.start),F.isClosing&&(ratio=1-ratio),padding="width"===prop?current.wPadding:current.hPadding,value=now-padding,F.skin[prop](getScalar("width"===prop?value:value-wrapSpace*ratio)),F.inner[prop](getScalar("width"===prop?value:value-wrapSpace*ratio-skinSpace*ratio)))},zoomIn:function(){var current=F.current,startPos=current.pos,effect=current.openEffect,elastic="elastic"===effect,endPos=$.extend({opacity:1},startPos);delete endPos.position,elastic?(startPos=this.getOrigPosition(),current.openOpacity&&(startPos.opacity=.1)):"fade"===effect&&(startPos.opacity=.1),F.wrap.css(startPos).animate(endPos,{duration:"none"===effect?0:current.openSpeed,easing:current.openEasing,step:elastic?this.step:null,complete:F._afterZoomIn})},zoomOut:function(){var current=F.current,effect=current.closeEffect,elastic="elastic"===effect,endPos={opacity:.1};elastic&&(endPos=this.getOrigPosition(),current.closeOpacity&&(endPos.opacity=.1)),F.wrap.animate(endPos,{duration:"none"===effect?0:current.closeSpeed,easing:current.closeEasing,step:elastic?this.step:null,complete:F._afterZoomOut})},changeIn:function(){var field,current=F.current,effect=current.nextEffect,startPos=current.pos,endPos={opacity:1},direction=F.direction,distance=200;startPos.opacity=.1,"elastic"===effect&&(field="down"===direction||"up"===direction?"top":"left","down"===direction||"right"===direction?(startPos[field]=getValue(getScalar(startPos[field])-distance),endPos[field]="+="+distance+"px"):(startPos[field]=getValue(getScalar(startPos[field])+distance),endPos[field]="-="+distance+"px")),"none"===effect?F._afterZoomIn():F.wrap.css(startPos).animate(endPos,{duration:current.nextSpeed,easing:current.nextEasing,complete:function(){setTimeout(F._afterZoomIn,20)}})},changeOut:function(){var previous=F.previous,effect=previous.prevEffect,endPos={opacity:.1},direction=F.direction,distance=200;"elastic"===effect&&(endPos["down"===direction||"up"===direction?"top":"left"]=("up"===direction||"left"===direction?"-":"+")+"="+distance+"px"),previous.wrap.animate(endPos,{duration:"none"===effect?0:previous.prevSpeed,easing:previous.prevEasing,complete:function(){$(this).trigger("onReset").remove()}})}},F.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!isTouch,fixed:!0},overlay:null,fixed:!1,create:function(opts){opts=$.extend({},this.defaults,opts),this.overlay&&this.close(),this.overlay=$('<div class="fancybox-overlay"></div>').appendTo("body"),this.fixed=!1,opts.fixed&&F.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(opts){var that=this;opts=$.extend({},this.defaults,opts),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(opts),this.fixed||(W.bind("resize.overlay",$.proxy(this.update,this)),this.update()),opts.closeClick&&this.overlay.bind("click.overlay",function(e){$(e.target).hasClass("fancybox-overlay")&&(F.isActive?F.close():that.close())}),this.overlay.css(opts.css).show()},close:function(){$(".fancybox-overlay").remove(),W.unbind("resize.overlay"),this.overlay=null,this.margin!==!1&&($("body").css("margin-right",this.margin),this.margin=!1),this.el&&this.el.removeClass("fancybox-lock")},update:function(){var offsetWidth,width="100%";this.overlay.width(width).height("100%"),$.browser.msie?(offsetWidth=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),D.width()>offsetWidth&&(width=D.width())):D.width()>W.width()&&(width=D.width()),this.overlay.width(width).height(D.height())},onReady:function(opts,obj){$(".fancybox-overlay").stop(!0,!0),this.overlay||(this.margin=D.height()>W.height()||"scroll"===$("body").css("overflow-y")?$("body").css("margin-right"):!1,this.el=$(document.all&&!document.querySelector?"html":"body"),this.create(opts)),opts.locked&&this.fixed&&(obj.locked=this.overlay.append(obj.wrap),obj.fixed=!1),opts.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(opts,obj){obj.locked&&(this.el.addClass("fancybox-lock"),this.margin!==!1&&$("body").css("margin-right",getScalar(this.margin)+obj.scrollbarWidth)),this.open(opts)},onUpdate:function(){this.fixed||this.update()},afterClose:function(opts){this.overlay&&!F.isActive&&this.overlay.fadeOut(opts.speedOut,$.proxy(this.close,this))}},F.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(opts){var title,target,current=F.current,text=current.title,type=opts.type;if($.isFunction(text)&&(text=text.call(current.element,current)),isString(text)&&""!==$.trim(text)){switch(title=$('<div class="fancybox-title fancybox-title-'+type+'-wrap">'+text+"</div>"),type){case"inside":target=F.skin;break;case"outside":target=F.wrap;break;case"over":target=F.inner;break;default:target=F.skin,title.appendTo("body"),$.browser.msie&&title.width(title.width()),title.wrapInner('<span class="child"></span>'),F.current.margin[2]+=Math.abs(getScalar(title.css("margin-bottom")))}title["top"===opts.position?"prependTo":"appendTo"](target)}}},$.fn.fancybox=function(options){var index,that=$(this),selector=this.selector||"",run=function(e){var relType,relVal,what=$(this).blur(),idx=index;e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||what.is(".fancybox-wrap")||(relType=options.groupAttr||"data-fancybox-group",relVal=what.attr(relType),relVal||(relType="rel",relVal=what.get(0)[relType]),relVal&&""!==relVal&&"nofollow"!==relVal&&(what=selector.length?$(selector):that,what=what.filter("["+relType+'="'+relVal+'"]'),idx=what.index(this)),options.index=idx,F.open(what,options)!==!1&&e.preventDefault())};return options=options||{},index=options.index||0,selector&&options.live!==!1?D.undelegate(selector,"click.fb-start").delegate(selector+":not('.fancybox-item, .fancybox-nav')","click.fb-start",run):that.unbind("click.fb-start").bind("click.fb-start",run),this.filter("[data-fancybox-start=1]").trigger("click"),this},D.ready(function(){$.scrollbarWidth===undefined&&($.scrollbarWidth=function(){var parent=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),child=parent.children(),width=child.innerWidth()-child.height(99).innerWidth();return parent.remove(),width}),$.support.fixedPosition===undefined&&($.support.fixedPosition=function(){var elem=$('<div style="position:fixed;top:20px;"></div>').appendTo("body"),fixed=20===elem[0].offsetTop||15===elem[0].offsetTop;return elem.remove(),fixed}()),$.extend(F.defaults,{scrollbarWidth:$.scrollbarWidth(),fixed:$.support.fixedPosition,parent:$("body")})})}(window,document,jQuery),function($){var F=$.fancybox;F.helpers.buttons={defaults:{skipSingle:!1,position:"top",tpl:'<div id="fancybox-buttons"><ul><li><a class="btnPrev" title="Previous" href="javascript:;"></a></li><li><a class="btnPlay" title="Start slideshow" href="javascript:;"></a></li><li><a class="btnNext" title="Next" href="javascript:;"></a></li><li><a class="btnToggle" title="Toggle size" href="javascript:;"></a></li><li><a class="btnClose" title="Close" href="javascript:jQuery.fancybox.close();"></a></li></ul></div>'},list:null,buttons:null,beforeLoad:function(opts,obj){return opts.skipSingle&&obj.group.length<2?(obj.helpers.buttons=!1,void(obj.closeBtn=!0)):void(obj.margin["bottom"===opts.position?2:0]+=30)},onPlayStart:function(){this.buttons&&this.buttons.play.attr("title","Pause slideshow").addClass("btnPlayOn")},onPlayEnd:function(){this.buttons&&this.buttons.play.attr("title","Start slideshow").removeClass("btnPlayOn")},afterShow:function(opts,obj){var buttons=this.buttons;buttons||(this.list=$(opts.tpl).addClass(opts.position).appendTo("body"),buttons={prev:this.list.find(".btnPrev").click(F.prev),next:this.list.find(".btnNext").click(F.next),play:this.list.find(".btnPlay").click(F.play),toggle:this.list.find(".btnToggle").click(F.toggle)}),obj.index>0||obj.loop?buttons.prev.removeClass("btnDisabled"):buttons.prev.addClass("btnDisabled"),obj.loop||obj.index<obj.group.length-1?(buttons.next.removeClass("btnDisabled"),buttons.play.removeClass("btnDisabled")):(buttons.next.addClass("btnDisabled"),buttons.play.addClass("btnDisabled")),this.buttons=buttons,this.onUpdate(opts,obj)},onUpdate:function(opts,obj){var toggle;this.buttons&&(toggle=this.buttons.toggle.removeClass("btnDisabled btnToggleOn"),obj.canShrink?toggle.addClass("btnToggleOn"):obj.canExpand||toggle.addClass("btnDisabled"))},beforeClose:function(){this.list&&this.list.remove(),this.list=null,this.buttons=null}}}(jQuery),function($){function touchHandler(event){var touches=event.originalEvent.changedTouches,first=touches[0],type="";switch(event.type){case"touchmove":type="mousemove";break;case"touchend":type="mouseup";break;default:return}var simulatedEvent=document.createEvent("MouseEvent");simulatedEvent.initMouseEvent(type,!0,!0,window,1,first.screenX,first.screenY,first.clientX,first.clientY,!1,!1,!1,!1,0,null),first.target.dispatchEvent(simulatedEvent),event.preventDefault()}$.fn.rateit=function(p1,p2){var options={},mode="init",capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.substr(1)};if(0==this.length)return this;var tp1=$.type(p1);if("object"==tp1||void 0===p1||null==p1)options=$.extend({},$.fn.rateit.defaults,p1);else{if("string"==tp1&&void 0===p2)return this.data("rateit"+capitaliseFirstLetter(p1));"string"==tp1&&(mode="setvalue")}return this.each(function(){var item=$(this),itemdata=function(key,value){return arguments[0]="rateit"+capitaliseFirstLetter(key),item.data.apply(item,arguments)};item.hasClass("rateit")||item.addClass("rateit");var ltr="rtl"!=item.css("direction");if("setvalue"==mode){if(!itemdata("init"))throw"Can't set value before init";if("readonly"!=p1||itemdata("readonly")||(item.find(".rateit-range").unbind(),itemdata("wired",!1)),"value"==p1&&null==p2&&(p2=itemdata("min")),itemdata("backingfld")){var fld=$(itemdata("backingfld"));"value"==p1&&fld.val(p2),"min"==p1&&fld[0].min&&(fld[0].min=p2),"max"==p1&&fld[0].max&&(fld[0].max=p2),"step"==p1&&fld[0].step&&(fld[0].step=p2)}itemdata(p1,p2)}if(!itemdata("init")){if(itemdata("min",itemdata("min")||options.min),itemdata("max",itemdata("max")||options.max),itemdata("step",itemdata("step")||options.step),itemdata("readonly",void 0!==itemdata("readonly")?itemdata("readonly"):options.readonly),itemdata("resetable",void 0!==itemdata("resetable")?itemdata("resetable"):options.resetable),itemdata("backingfld",itemdata("backingfld")||options.backingfld),itemdata("starwidth",itemdata("starwidth")||options.starwidth),itemdata("starheight",itemdata("starheight")||options.starheight),itemdata("value",itemdata("value")||options.value||options.min),itemdata("ispreset",void 0!==itemdata("ispreset")?itemdata("ispreset"):options.ispreset),itemdata("backingfld")){var fld=$(itemdata("backingfld"));itemdata("value",fld.hide().val()),(fld.attr("disabled")||fld.attr("readonly"))&&itemdata("readonly",!0),"INPUT"==fld[0].nodeName&&("range"==fld[0].type||"text"==fld[0].type)&&(itemdata("min",parseInt(fld.attr("min"))||itemdata("min")),itemdata("max",parseInt(fld.attr("max"))||itemdata("max")),itemdata("step",parseInt(fld.attr("step"))||itemdata("step"))),"SELECT"==fld[0].nodeName&&fld[0].options.length>1&&(itemdata("min",Number(fld[0].options[0].value)),itemdata("max",Number(fld[0].options[fld[0].length-1].value)),itemdata("step",Number(fld[0].options[1].value)-Number(fld[0].options[0].value)))}item.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+itemdata("starheight")+'px"></div><div class="rateit-hover" style="height:'+itemdata("starheight")+'px"></div></div>'),ltr||(item.find(".rateit-reset").css("float","right"),item.find(".rateit-selected").addClass("rateit-selected-rtl"),item.find(".rateit-hover").addClass("rateit-hover-rtl")),itemdata("init",!0)}var range=item.find(".rateit-range");range.width(itemdata("starwidth")*(itemdata("max")-itemdata("min"))).height(itemdata("starheight"));var presetclass="rateit-preset"+(ltr?"":"-rtl");if(itemdata("ispreset")?item.find(".rateit-selected").addClass(presetclass):item.find(".rateit-selected").removeClass(presetclass),null!=itemdata("value")){var score=(itemdata("value")-itemdata("min"))*itemdata("starwidth");item.find(".rateit-selected").width(score)}var resetbtn=item.find(".rateit-reset");resetbtn.data("wired")!==!0&&resetbtn.click(function(){itemdata("value",itemdata("min")),range.find(".rateit-hover").hide().width(0),range.find(".rateit-selected").width(0).show(),itemdata("backingfld")&&$(itemdata("backingfld")).val(itemdata("min")),item.trigger("reset")}).data("wired",!0);var calcRawScore=function(element,event){var pageX=event.changedTouches?event.changedTouches[0].pageX:event.pageX,offsetx=pageX-$(element).offset().left;return ltr||(offsetx=range.width()-offsetx),offsetx>range.width()&&(offsetx=range.width()),0>offsetx&&(offsetx=0),score=Math.ceil(offsetx/itemdata("starwidth")*(1/itemdata("step")))};itemdata("readonly")?resetbtn.hide():(itemdata("resetable")||resetbtn.hide(),itemdata("wired")||(range.bind("touchmove touchend",touchHandler),range.mousemove(function(e){var score=calcRawScore(this,e),w=score*itemdata("starwidth")*itemdata("step"),h=range.find(".rateit-hover");if(h.data("width")!=w){range.find(".rateit-selected").hide(),h.width(w).show().data("width",w);var data=[score*itemdata("step")+itemdata("min")];item.trigger("hover",data).trigger("over",data)}}),range.mouseleave(function(e){range.find(".rateit-hover").hide().width(0).data("width",""),item.trigger("hover",[null]).trigger("over",[null]),range.find(".rateit-selected").show()}),range.mouseup(function(e){var score=calcRawScore(this,e),newvalue=score*itemdata("step")+itemdata("min");itemdata("value",newvalue),itemdata("backingfld")&&$(itemdata("backingfld")).val(newvalue),itemdata("ispreset")&&(range.find(".rateit-selected").removeClass(presetclass),itemdata("ispreset",!1)),range.find(".rateit-hover").hide(),range.find(".rateit-selected").width(score*itemdata("starwidth")*itemdata("step")).show(),item.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[newvalue])}),itemdata("wired",!0)),itemdata("resetable")&&resetbtn.show())})},$.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},$(function(){$("div.rateit").rateit()})}(jQuery),function($){function Datepicker(){this._defaults={pickerClass:"",showOnFocus:!0,showTrigger:null,showAnim:"show",showOptions:{},showSpeed:"normal",popupContainer:null,alignment:"bottom",fixedWeeks:!1,firstDay:0,calculateWeek:this.iso8601Week,monthsToShow:1,monthsOffset:0,monthsToStep:1,monthsToJump:12,useMouseWheel:!0,changeMonth:!0,yearRange:"c-10:c+10",shortYearCutoff:"+10",showOtherMonths:!1,selectOtherMonths:!1,defaultDate:null,selectDefaultDate:!1,minDate:null,maxDate:null,dateFormat:"mm/dd/yyyy",autoSize:!1,rangeSelect:!1,rangeSeparator:" - ",multiSelect:0,multiSeparator:",",onDate:null,onShow:null,onChangeMonthYear:null,onSelect:null,onClose:null,altField:null,altFormat:null,constrainInput:!0,commandsAsDateFormat:!1,commands:this.commands},this.regional={"":{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dateFormat:"mm/dd/yyyy",firstDay:0,renderer:this.defaultRenderer,prevText:"&lt;Prev",prevStatus:"Show the previous month",prevJumpText:"&lt;&lt;",prevJumpStatus:"Show the previous year",nextText:"Next&gt;",nextStatus:"Show the next month",nextJumpText:"&gt;&gt;",nextJumpStatus:"Show the next year",currentText:"Current",currentStatus:"Show the current month",todayText:"Today",todayStatus:"Show today's month",clearText:"Clear",clearStatus:"Clear all the dates",closeText:"Close",closeStatus:"Close the datepicker",yearStatus:"Change the year",monthStatus:"Change the month",weekText:"Wk",weekStatus:"Week of the year",dayStatus:"Select DD, M d, yyyy",defaultStatus:"Select a date",isRTL:!1}},$.extend(this._defaults,this.regional[""]),this._disabled=[]}function extendRemove(target,props){$.extend(target,props);for(var name in props)(null==props[name]||void 0==props[name])&&(target[name]=props[name]);return target}$.extend(Datepicker.prototype,{dataName:"datepick",markerClass:"hasDatepick",_popupClass:"datepick-popup",_triggerClass:"datepick-trigger",_disableClass:"datepick-disable",_coverClass:"datepick-cover",_monthYearClass:"datepick-month-year",_curMonthClass:"datepick-month-",_anyYearClass:"datepick-any-year",_curDoWClass:"datepick-dow-",commands:{prev:{text:"prevText",status:"prevStatus",keystroke:{keyCode:33},enabled:function(inst){var minDate=inst.curMinDate();return!minDate||$.datepick.add($.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),1-inst.get("monthsToStep"),"m"),inst),1),-1,"d").getTime()>=minDate.getTime()},date:function(inst){return $.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),-inst.get("monthsToStep"),"m"),inst),1)},action:function(inst){$.datepick.changeMonth(this,-inst.get("monthsToStep"))}},prevJump:{text:"prevJumpText",status:"prevJumpStatus",keystroke:{keyCode:33,ctrlKey:!0},enabled:function(inst){var minDate=inst.curMinDate();return!minDate||$.datepick.add($.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),1-inst.get("monthsToJump"),"m"),inst),1),-1,"d").getTime()>=minDate.getTime()},date:function(inst){return $.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),-inst.get("monthsToJump"),"m"),inst),1)},action:function(inst){$.datepick.changeMonth(this,-inst.get("monthsToJump"))}},next:{text:"nextText",status:"nextStatus",keystroke:{keyCode:34},enabled:function(inst){var maxDate=inst.get("maxDate");return!maxDate||$.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),inst.get("monthsToStep"),"m"),inst),1).getTime()<=maxDate.getTime()},date:function(inst){return $.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),inst.get("monthsToStep"),"m"),inst),1)},action:function(inst){$.datepick.changeMonth(this,inst.get("monthsToStep"))}},nextJump:{text:"nextJumpText",status:"nextJumpStatus",keystroke:{keyCode:34,ctrlKey:!0},enabled:function(inst){var maxDate=inst.get("maxDate");return!maxDate||$.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),inst.get("monthsToJump"),"m"),inst),1).getTime()<=maxDate.getTime()},date:function(inst){return $.datepick.day($.datepick._applyMonthsOffset($.datepick.add($.datepick.newDate(inst.drawDate),inst.get("monthsToJump"),"m"),inst),1)},action:function(inst){$.datepick.changeMonth(this,inst.get("monthsToJump"))}},current:{text:"currentText",status:"currentStatus",keystroke:{keyCode:36,ctrlKey:!0},enabled:function(inst){var minDate=inst.curMinDate(),maxDate=inst.get("maxDate"),curDate=inst.selectedDates[0]||$.datepick.today();return(!minDate||curDate.getTime()>=minDate.getTime())&&(!maxDate||curDate.getTime()<=maxDate.getTime())},date:function(inst){return inst.selectedDates[0]||$.datepick.today()},action:function(inst){var curDate=inst.selectedDates[0]||$.datepick.today();$.datepick.showMonth(this,curDate.getFullYear(),curDate.getMonth()+1)}},today:{text:"todayText",status:"todayStatus",keystroke:{keyCode:36,ctrlKey:!0},enabled:function(inst){var minDate=inst.curMinDate(),maxDate=inst.get("maxDate");return(!minDate||$.datepick.today().getTime()>=minDate.getTime())&&(!maxDate||$.datepick.today().getTime()<=maxDate.getTime())},date:function(inst){return $.datepick.today()},action:function(inst){$.datepick.showMonth(this)}},clear:{text:"clearText",status:"clearStatus",keystroke:{keyCode:35,ctrlKey:!0},enabled:function(inst){return!0},date:function(inst){return null},action:function(inst){$.datepick.clear(this)}},close:{text:"closeText",status:"closeStatus",keystroke:{keyCode:27},enabled:function(inst){return!0},date:function(inst){return null},action:function(inst){$.datepick.hide(this)}},prevWeek:{text:"prevWeekText",status:"prevWeekStatus",keystroke:{keyCode:38,ctrlKey:!0},enabled:function(inst){var minDate=inst.curMinDate();return!minDate||$.datepick.add($.datepick.newDate(inst.drawDate),-7,"d").getTime()>=minDate.getTime()},date:function(inst){return $.datepick.add($.datepick.newDate(inst.drawDate),-7,"d")},action:function(inst){$.datepick.changeDay(this,-7)}},prevDay:{text:"prevDayText",status:"prevDayStatus",keystroke:{keyCode:37,ctrlKey:!0},enabled:function(inst){var minDate=inst.curMinDate();return!minDate||$.datepick.add($.datepick.newDate(inst.drawDate),-1,"d").getTime()>=minDate.getTime()},date:function(inst){return $.datepick.add($.datepick.newDate(inst.drawDate),-1,"d")},action:function(inst){$.datepick.changeDay(this,-1)}},nextDay:{text:"nextDayText",status:"nextDayStatus",keystroke:{keyCode:39,ctrlKey:!0},enabled:function(inst){var maxDate=inst.get("maxDate");return!maxDate||$.datepick.add($.datepick.newDate(inst.drawDate),1,"d").getTime()<=maxDate.getTime()},date:function(inst){return $.datepick.add($.datepick.newDate(inst.drawDate),1,"d")},action:function(inst){$.datepick.changeDay(this,1)}},nextWeek:{text:"nextWeekText",status:"nextWeekStatus",keystroke:{keyCode:40,ctrlKey:!0},enabled:function(inst){var maxDate=inst.get("maxDate");return!maxDate||$.datepick.add($.datepick.newDate(inst.drawDate),7,"d").getTime()<=maxDate.getTime()},date:function(inst){return $.datepick.add($.datepick.newDate(inst.drawDate),7,"d")},action:function(inst){$.datepick.changeDay(this,7)}}},defaultRenderer:{picker:'<div class="datepick"><div class="datepick-nav">{link:prev}{link:today}{link:next}</div>{months}{popup:start}<div class="datepick-ctrl">{link:clear}{link:close}</div>{popup:end}<div class="datepick-clear-fix"></div></div>',monthRow:'<div class="datepick-month-row">{months}</div>',month:'<div class="datepick-month"><div class="datepick-month-header">{monthHeader}</div><table><thead>{weekHeader}</thead><tbody>{weeks}</tbody></table></div>',weekHeader:"<tr>{days}</tr>",dayHeader:"<th>{day}</th>",week:"<tr>{days}</tr>",day:"<td>{day}</td>",monthSelector:".datepick-month",daySelector:"td",rtlClass:"datepick-rtl",multiClass:"datepick-multi",defaultClass:"",selectedClass:"datepick-selected",highlightedClass:"datepick-highlight",todayClass:"datepick-today",otherMonthClass:"datepick-other-month",weekendClass:"datepick-weekend",commandClass:"datepick-cmd",commandButtonClass:"",commandLinkClass:"",disabledClass:"datepick-disabled"},setDefaults:function(settings){return $.extend(this._defaults,settings||{}),this},_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,_msPerDay:864e5,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(format,date,settings){if("string"!=typeof format&&(settings=date,date=format,format=""),!date)return"";format=format||this._defaults.dateFormat,settings=settings||{};for(var dayNamesShort=settings.dayNamesShort||this._defaults.dayNamesShort,dayNames=settings.dayNames||this._defaults.dayNames,monthNamesShort=settings.monthNamesShort||this._defaults.monthNamesShort,monthNames=settings.monthNames||this._defaults.monthNames,calculateWeek=settings.calculateWeek||this._defaults.calculateWeek,doubled=function(match,step){for(var matches=1;iFormat+matches<format.length&&format.charAt(iFormat+matches)==match;)matches++;return iFormat+=matches-1,Math.floor(matches/(step||1))>1},formatNumber=function(match,value,len,step){var num=""+value;if(doubled(match,step))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return doubled(match)?longNames[value]:shortNames[value]},output="",literal=!1,iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!=format.charAt(iFormat)||doubled("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",this.dayOfYear(date),3);break;case"w":output+=formatNumber("w",calculateWeek(date),2);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=doubled("y",2)?date.getFullYear():(date.getFullYear()%100<10?"0":"")+date.getFullYear()%100;break;case"@":output+=Math.floor(date.getTime()/1e3);break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":doubled("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},parseDate:function(format,value,settings){if(null==value)throw"Invalid arguments";if(value="object"==typeof value?value.toString():value+"",""==value)return null;format=format||this._defaults.dateFormat,settings=settings||{};var shortYearCutoff=settings.shortYearCutoff||this._defaults.shortYearCutoff;shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:this.today().getFullYear()%100+parseInt(shortYearCutoff,10);for(var dayNamesShort=settings.dayNamesShort||this._defaults.dayNamesShort,dayNames=settings.dayNames||this._defaults.dayNames,monthNamesShort=settings.monthNamesShort||this._defaults.monthNamesShort,monthNames=settings.monthNames||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,shortYear=!1,literal=!1,doubled=function(match,step){for(var matches=1;iFormat+matches<format.length&&format.charAt(iFormat+matches)==match;)matches++;return iFormat+=matches-1,Math.floor(matches/(step||1))>1},getNumber=function(match,step){var isDoubled=doubled(match,step),size=[2,3,isDoubled?4:2,11,20]["oy@!".indexOf(match)+1],digits=new RegExp("^-?\\d{1,"+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position {0}".replace(/\{0\}/,iValue);return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames,step){for(var names=doubled(match,step)?longNames:shortNames,i=0;i<names.length;i++)if(value.substr(iValue,names[i].length)==names[i])return iValue+=names[i].length,i+1;throw"Unknown name at position {0}".replace(/\{0\}/,iValue)},checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat))throw"Unexpected literal at position {0}".replace(/\{0\}/,iValue);iValue++},iValue=0,iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!=format.charAt(iFormat)||doubled("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"w":getNumber("w");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":var iSave=iFormat;shortYear=!doubled("y",2),iFormat=iSave,year=getNumber("y",2);break;case"@":var date=this._normaliseDate(new Date(1e3*getNumber("@")));year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":var date=this._normaliseDate(new Date((getNumber("!")-this._ticksTo1970)/1e4));year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"*":iValue=value.length;break;case"'":doubled("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length)throw"Additional text found at end";if(-1==year?year=this.today().getFullYear():100>year&&shortYear&&(year+=-1==shortYearCutoff?1900:this.today().getFullYear()-this.today().getFullYear()%100-(shortYearCutoff>=year?0:100)),doy>-1){month=1,day=doy;for(var dim=this.daysInMonth(year,month);day>dim;dim=this.daysInMonth(year,month))month++,
day-=dim}var date=this.newDate(year,month,day);if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day)throw"Invalid date";return date},determineDate:function(dateSpec,defaultDate,currentDate,dateFormat,settings){currentDate&&"object"!=typeof currentDate&&(settings=dateFormat,dateFormat=currentDate,currentDate=null),"string"!=typeof dateFormat&&(settings=dateFormat,dateFormat="");var offsetString=function(offset){try{return $.datepick.parseDate(dateFormat,offset,settings)}catch(e){}offset=offset.toLowerCase();for(var date=(offset.match(/^c/)&&currentDate?$.datepick.newDate(currentDate):null)||$.datepick.today(),pattern=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,matches=pattern.exec(offset);matches;)date=$.datepick.add(date,parseInt(matches[1],10),matches[2]||"d"),matches=pattern.exec(offset);return date};return defaultDate=defaultDate?$.datepick.newDate(defaultDate):null,dateSpec=null==dateSpec?defaultDate:"string"==typeof dateSpec?offsetString(dateSpec):"number"==typeof dateSpec?isNaN(dateSpec)||dateSpec==1/0||dateSpec==-(1/0)?defaultDate:$.datepick.add($.datepick.today(),dateSpec,"d"):$.datepick.newDate(dateSpec)},daysInMonth:function(year,month){return month=year.getFullYear?year.getMonth()+1:month,year=year.getFullYear?year.getFullYear():year,this.newDate(year,month+1,0).getDate()},dayOfYear:function(year,month,day){var date=year.getFullYear?year:this.newDate(year,month,day),newYear=this.newDate(date.getFullYear(),1,1);return Math.floor((date.getTime()-newYear.getTime())/this._msPerDay)+1},iso8601Week:function(year,month,day){var checkDate=year.getFullYear?new Date(year.getTime()):this.newDate(year,month,day);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0,1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},today:function(){return this._normaliseDate(new Date)},newDate:function(year,month,day){return year?year.getFullYear?this._normaliseDate(new Date(year.getTime())):new Date(year,month-1,day,12):null},_normaliseDate:function(date){return date&&date.setHours(12,0,0,0),date},year:function(date,year){return date.setFullYear(year),this._normaliseDate(date)},month:function(date,month){return date.setMonth(month-1),this._normaliseDate(date)},day:function(date,day){return date.setDate(day),this._normaliseDate(date)},add:function(date,amount,period){if("d"==period||"w"==period)this._normaliseDate(date),date.setDate(date.getDate()+amount*("w"==period?7:1));else{var year=date.getFullYear()+("y"==period?amount:0),month=date.getMonth()+("m"==period?amount:0);date.setTime($.datepick.newDate(year,month+1,Math.min(date.getDate(),this.daysInMonth(year,month+1))).getTime())}return date},_applyMonthsOffset:function(date,inst){var monthsOffset=inst.get("monthsOffset");return $.isFunction(monthsOffset)&&(monthsOffset=monthsOffset.apply(inst.target[0],[date])),$.datepick.add(date,-monthsOffset,"m")},_attachPicker:function(target,settings){if(target=$(target),!target.hasClass(this.markerClass)){target.addClass(this.markerClass);var inst={target:target,selectedDates:[],drawDate:null,pickingRange:!1,inline:$.inArray(target[0].nodeName.toLowerCase(),["div","span"])>-1,get:function(name){var value=void 0!==this.settings[name]?this.settings[name]:$.datepick._defaults[name];return $.inArray(name,["defaultDate","minDate","maxDate"])>-1&&(value=$.datepick.determineDate(value,null,this.selectedDates[0],this.get("dateFormat"),inst.getConfig())),value},curMinDate:function(){return this.pickingRange?this.selectedDates[0]:this.get("minDate")},getConfig:function(){return{dayNamesShort:this.get("dayNamesShort"),dayNames:this.get("dayNames"),monthNamesShort:this.get("monthNamesShort"),monthNames:this.get("monthNames"),calculateWeek:this.get("calculateWeek"),shortYearCutoff:this.get("shortYearCutoff")}}};$.data(target[0],this.dataName,inst);var inlineSettings=$.fn.metadata?target.metadata():{};inst.settings=$.extend({},settings||{},inlineSettings||{}),inst.inline?(inst.drawDate=$.datepick._checkMinMax($.datepick.newDate(inst.selectedDates[0]||inst.get("defaultDate")||$.datepick.today()),inst),inst.prevDate=$.datepick.newDate(inst.drawDate),this._update(target[0]),$.fn.mousewheel&&target.mousewheel(this._doMouseWheel)):(this._attachments(target,inst),target.bind("keydown."+this.dataName,this._keyDown).bind("keypress."+this.dataName,this._keyPress).bind("keyup."+this.dataName,this._keyUp),target.attr("disabled")&&this.disable(target[0]))}},options:function(target,name){var inst=$.data(target,this.dataName);return inst?name?"all"==name?inst.settings:inst.settings[name]:$.datepick._defaults:{}},option:function(target,settings,value){if(target=$(target),target.hasClass(this.markerClass)){if(settings=settings||{},"string"==typeof settings){var name=settings;settings={},settings[name]=value}var inst=$.data(target[0],this.dataName),dates=inst.selectedDates;extendRemove(inst.settings,settings),this.setDate(target[0],dates,null,!1,!0),inst.pickingRange=!1,inst.drawDate=$.datepick.newDate(this._checkMinMax((settings.defaultDate?inst.get("defaultDate"):inst.drawDate)||inst.get("defaultDate")||$.datepick.today(),inst)),inst.inline||this._attachments(target,inst),(inst.inline||inst.div)&&this._update(target[0])}},_attachments:function(target,inst){target.unbind("focus."+this.dataName),inst.get("showOnFocus")&&target.bind("focus."+this.dataName,this.show),inst.trigger&&inst.trigger.remove();var trigger=inst.get("showTrigger");inst.trigger=trigger?$(trigger).clone().removeAttr("id").addClass(this._triggerClass)[inst.get("isRTL")?"insertBefore":"insertAfter"](target).click(function(){$.datepick.isDisabled(target[0])||$.datepick[$.datepick.curInst==inst?"hide":"show"](target[0])}):$([]),this._autoSize(target,inst);var dates=this._extractDates(inst,target.val());dates&&this.setDate(target[0],dates,null,!0),inst.get("selectDefaultDate")&&inst.get("defaultDate")&&0==inst.selectedDates.length&&this.setDate(target[0],$.datepick.newDate(inst.get("defaultDate")||$.datepick.today()))},_autoSize:function(target,inst){if(inst.get("autoSize")&&!inst.inline){var date=$.datepick.newDate(2009,10,20),dateFormat=inst.get("dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){for(var max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI};date.setMonth(findMax(inst.get(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(inst.get(dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())}inst.target.attr("size",$.datepick.formatDate(dateFormat,date,inst.getConfig()).length)}},destroy:function(target){if(target=$(target),target.hasClass(this.markerClass)){var inst=$.data(target[0],this.dataName);inst.trigger&&inst.trigger.remove(),target.removeClass(this.markerClass).empty().unbind("."+this.dataName),inst.inline&&$.fn.mousewheel&&target.unmousewheel(),!inst.inline&&inst.get("autoSize")&&target.removeAttr("size"),$.removeData(target[0],this.dataName)}},multipleEvents:function(fns){var funcs=arguments;return function(args){for(var i=0;i<funcs.length;i++)funcs[i].apply(this,arguments)}},enable:function(target){var $target=$(target);if($target.hasClass(this.markerClass)){var inst=$.data(target,this.dataName);inst.inline?$target.children("."+this._disableClass).remove().end().find("button,select").attr("disabled","").end().find("a").attr("href","javascript:void(0)"):(target.disabled=!1,inst.trigger.filter("button."+this._triggerClass).attr("disabled","").end().filter("img."+this._triggerClass).css({opacity:"1.0",cursor:""})),this._disabled=$.map(this._disabled,function(value){return value==target?null:value})}},disable:function(target){var $target=$(target);if($target.hasClass(this.markerClass)){var inst=$.data(target,this.dataName);if(inst.inline){var inline=$target.children(":last"),offset=inline.offset(),relOffset={left:0,top:0};inline.parents().each(function(){return"relative"==$(this).css("position")?(relOffset=$(this).offset(),!1):void 0});var zIndex=$target.css("zIndex");zIndex=("auto"==zIndex?0:parseInt(zIndex,10))+1,$target.prepend('<div class="'+this._disableClass+'" style="width: '+inline.outerWidth()+"px; height: "+inline.outerHeight()+"px; left: "+(offset.left-relOffset.left)+"px; top: "+(offset.top-relOffset.top)+"px; z-index: "+zIndex+'"></div>').find("button,select").attr("disabled","disabled").end().find("a").removeAttr("href")}else target.disabled=!0,inst.trigger.filter("button."+this._triggerClass).attr("disabled","disabled").end().filter("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});this._disabled=$.map(this._disabled,function(value){return value==target?null:value}),this._disabled.push(target)}},isDisabled:function(target){return target&&$.inArray(target,this._disabled)>-1},show:function(target){target=target.target||target;var inst=$.data(target,$.datepick.dataName);if($.datepick.curInst!=inst&&($.datepick.curInst&&$.datepick.hide($.datepick.curInst,!0),inst)){inst.lastVal=null,inst.selectedDates=$.datepick._extractDates(inst,$(target).val()),inst.pickingRange=!1,inst.drawDate=$.datepick._checkMinMax($.datepick.newDate(inst.selectedDates[0]||inst.get("defaultDate")||$.datepick.today()),inst),inst.prevDate=$.datepick.newDate(inst.drawDate),$.datepick.curInst=inst,$.datepick._update(target,!0);var offset=$.datepick._checkOffset(inst);inst.div.css({left:offset.left,top:offset.top});var showAnim=inst.get("showAnim"),showSpeed=inst.get("showSpeed");showSpeed="normal"==showSpeed&&$.ui&&$.ui.version>="1.8"?"_default":showSpeed;var postProcess=function(){var cover=inst.div.find("."+$.datepick._coverClass);if(cover.length){var borders=$.datepick._getBorders(inst.div);cover.css({left:-borders[0],top:-borders[1],width:inst.div.outerWidth()+borders[0],height:inst.div.outerHeight()+borders[1]})}};if($.effects&&$.effects[showAnim]){var data=inst.div.data();for(var key in data)key.match(/^ec\.storage\./)&&(data[key]=inst._mainDiv.css(key.replace(/ec\.storage\./,"")));inst.div.data(data).show(showAnim,inst.get("showOptions"),showSpeed,postProcess)}else inst.div[showAnim||"show"](showAnim?showSpeed:"",postProcess);showAnim||postProcess()}},_extractDates:function(inst,datesText){if(datesText!=inst.lastVal){inst.lastVal=datesText;var dateFormat=inst.get("dateFormat"),multiSelect=inst.get("multiSelect"),rangeSelect=inst.get("rangeSelect");datesText=datesText.split(multiSelect?inst.get("multiSeparator"):rangeSelect?inst.get("rangeSeparator"):"\x00");for(var dates=[],i=0;i<datesText.length;i++)try{var date=$.datepick.parseDate(dateFormat,datesText[i],inst.getConfig());if(date){for(var found=!1,j=0;j<dates.length;j++)if(dates[j].getTime()==date.getTime()){found=!0;break}found||dates.push(date)}}catch(e){}return dates.splice(multiSelect||(rangeSelect?2:1),dates.length),rangeSelect&&1==dates.length&&(dates[1]=dates[0]),dates}},_update:function(target,hidden){target=$(target.target||target);var inst=$.data(target[0],$.datepick.dataName);if(inst){if(inst.inline||$.datepick.curInst==inst){var onChange=inst.get("onChangeMonthYear");!onChange||inst.prevDate&&inst.prevDate.getFullYear()==inst.drawDate.getFullYear()&&inst.prevDate.getMonth()==inst.drawDate.getMonth()||onChange.apply(target[0],[inst.drawDate.getFullYear(),inst.drawDate.getMonth()+1])}inst.inline?target.html(this._generateContent(target[0],inst)):$.datepick.curInst==inst&&(inst.div||(inst.div=$("<div></div>").addClass(this._popupClass).css({display:hidden?"none":"static",position:"absolute",left:target.offset().left,top:target.offset().top+target.outerHeight()}).appendTo($(inst.get("popupContainer")||"body")),$.fn.mousewheel&&inst.div.mousewheel(this._doMouseWheel)),inst.div.html(this._generateContent(target[0],inst)),target.focus())}},_updateInput:function(target,keyUp){var inst=$.data(target,this.dataName);if(inst){for(var value="",altValue="",sep=inst.get("multiSelect")?inst.get("multiSeparator"):inst.get("rangeSeparator"),dateFormat=inst.get("dateFormat"),altFormat=inst.get("altFormat")||dateFormat,i=0;i<inst.selectedDates.length;i++)value+=keyUp?"":(i>0?sep:"")+$.datepick.formatDate(dateFormat,inst.selectedDates[i],inst.getConfig()),altValue+=(i>0?sep:"")+$.datepick.formatDate(altFormat,inst.selectedDates[i],inst.getConfig());inst.inline||keyUp||$(target).val(value),$(inst.get("altField")).val(altValue);var onSelect=inst.get("onSelect");!onSelect||keyUp||inst.inSelect||(inst.inSelect=!0,onSelect.apply(target,[inst.selectedDates]),inst.inSelect=!1)}},_getBorders:function(elem){var convert=function(value){var extra=$.browser.msie?1:0;return{thin:1+extra,medium:3+extra,thick:5+extra}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst){var base=inst.target.is(":hidden")&&inst.trigger?inst.trigger:inst.target,offset=base.offset(),isFixed=!1;$(inst.target).parents().each(function(){return isFixed|="fixed"==$(this).css("position"),!isFixed}),isFixed&&$.browser.opera&&(offset.left-=document.documentElement.scrollLeft,offset.top-=document.documentElement.scrollTop);var browserWidth=(!$.browser.mozilla||document.doctype?document.documentElement.clientWidth:0)||document.body.clientWidth,browserHeight=(!$.browser.mozilla||document.doctype?document.documentElement.clientHeight:0)||document.body.clientHeight;if(0==browserWidth)return offset;var alignment=inst.get("alignment"),isRTL=inst.get("isRTL"),scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,above=offset.top-inst.div.outerHeight()-(isFixed&&$.browser.opera?document.documentElement.scrollTop:0),below=offset.top+base.outerHeight(),alignL=offset.left,alignR=offset.left+base.outerWidth()-inst.div.outerWidth()-(isFixed&&$.browser.opera?document.documentElement.scrollLeft:0),tooWide=offset.left+inst.div.outerWidth()-scrollX>browserWidth,tooHigh=offset.top+inst.target.outerHeight()+inst.div.outerHeight()-scrollY>browserHeight;return offset="topLeft"==alignment?{left:alignL,top:above}:"topRight"==alignment?{left:alignR,top:above}:"bottomLeft"==alignment?{left:alignL,top:below}:"bottomRight"==alignment?{left:alignR,top:below}:"top"==alignment?{left:isRTL||tooWide?alignR:alignL,top:above}:{left:isRTL||tooWide?alignR:alignL,top:tooHigh?above:below},offset.left=Math.max(isFixed?0:scrollX,offset.left-(isFixed?scrollX:0)),offset.top=Math.max(isFixed?0:scrollY,offset.top-(isFixed?scrollY:0)),offset},_checkExternalClick:function(event){if($.datepick.curInst){var target=$(event.target);target.parents().andSelf().hasClass($.datepick._popupClass)||target.hasClass($.datepick.markerClass)||target.parents().andSelf().hasClass($.datepick._triggerClass)||$.datepick.hide($.datepick.curInst)}},hide:function(target,immediate){var inst=$.data(target,this.dataName)||target;if(inst&&inst==$.datepick.curInst){var showAnim=immediate?"":inst.get("showAnim"),showSpeed=inst.get("showSpeed");showSpeed="normal"==showSpeed&&$.ui&&$.ui.version>="1.8"?"_default":showSpeed;var postProcess=function(){inst.div.remove(),inst.div=null,$.datepick.curInst=null;var onClose=inst.get("onClose");onClose&&onClose.apply(target,[inst.selectedDates])};if(inst.div.stop(),$.effects&&$.effects[showAnim])inst.div.hide(showAnim,inst.get("showOptions"),showSpeed,postProcess);else{var hideAnim="slideDown"==showAnim?"slideUp":"fadeIn"==showAnim?"fadeOut":"hide";inst.div[hideAnim](showAnim?showSpeed:"",postProcess)}showAnim||postProcess()}},_keyDown:function(event){var target=event.target,inst=$.data(target,$.datepick.dataName),handled=!1;if(inst.div)if(9==event.keyCode)$.datepick.hide(target);else if(13==event.keyCode)$.datepick.selectDate(target,$("a."+inst.get("renderer").highlightedClass,inst.div)[0]),handled=!0;else{var commands=inst.get("commands");for(var name in commands){var command=commands[name];if(command.keystroke.keyCode==event.keyCode&&!!command.keystroke.ctrlKey==!(!event.ctrlKey&&!event.metaKey)&&!!command.keystroke.altKey==event.altKey&&!!command.keystroke.shiftKey==event.shiftKey){$.datepick.performAction(target,name),handled=!0;break}}}else{var command=inst.get("commands").current;command.keystroke.keyCode==event.keyCode&&!!command.keystroke.ctrlKey==!(!event.ctrlKey&&!event.metaKey)&&!!command.keystroke.altKey==event.altKey&&!!command.keystroke.shiftKey==event.shiftKey&&($.datepick.show(target),handled=!0)}return inst.ctrlKey=event.keyCode<48&&32!=event.keyCode||event.ctrlKey||event.metaKey,handled&&(event.preventDefault(),event.stopPropagation()),!handled},_keyPress:function(event){var target=event.target,inst=$.data(target,$.datepick.dataName);if(inst&&inst.get("constrainInput")){var ch=String.fromCharCode(event.keyCode||event.charCode),allowedChars=$.datepick._allowedChars(inst);return event.metaKey||inst.ctrlKey||" ">ch||!allowedChars||allowedChars.indexOf(ch)>-1}return!0},_allowedChars:function(inst){for(var dateFormat=inst.get("dateFormat"),allowedChars=inst.get("multiSelect")?inst.get("multiSeparator"):inst.get("rangeSelect")?inst.get("rangeSeparator"):"",literal=!1,hasNum=!1,i=0;i<dateFormat.length;i++){var ch=dateFormat.charAt(i);if(literal)"'"==ch&&"'"!=dateFormat.charAt(i+1)?literal=!1:allowedChars+=ch;else switch(ch){case"d":case"m":case"o":case"w":allowedChars+=hasNum?"":"0123456789",hasNum=!0;break;case"y":case"@":case"!":allowedChars+=(hasNum?"":"0123456789")+"-",hasNum=!0;break;case"J":allowedChars+=(hasNum?"":"0123456789")+"-.",hasNum=!0;break;case"D":case"M":case"Y":return null;case"'":"'"==dateFormat.charAt(i+1)?allowedChars+="'":literal=!0;break;default:allowedChars+=ch}}return allowedChars},_keyUp:function(event){var target=event.target,inst=$.data(target,$.datepick.dataName);if(inst&&!inst.ctrlKey&&inst.lastVal!=inst.target.val())try{var dates=$.datepick._extractDates(inst,inst.target.val());dates.length>0&&$.datepick.setDate(target,dates,null,!0)}catch(event){}return!0},_doMouseWheel:function(event,delta){var target=$.datepick.curInst&&$.datepick.curInst.target[0]||$(event.target).closest("."+$.datepick.markerClass)[0];if(!$.datepick.isDisabled(target)){var inst=$.data(target,$.datepick.dataName);inst.get("useMouseWheel")&&(delta=$.browser.opera?-delta:delta,delta=0>delta?-1:1,$.datepick.changeMonth(target,-inst.get(event.ctrlKey?"monthsToJump":"monthsToStep")*delta)),event.preventDefault()}},clear:function(target){var inst=$.data(target,this.dataName);inst&&(inst.selectedDates=[],this.hide(target),inst.get("selectDefaultDate")&&inst.get("defaultDate")?this.setDate(target,$.datepick.newDate(inst.get("defaultDate")||$.datepick.today())):this._updateInput(target))},getDate:function(target){var inst=$.data(target,this.dataName);return inst?inst.selectedDates:[]},setDate:function(target,dates,endDate,keyUp,setOpt){var inst=$.data(target,this.dataName);if(inst){$.isArray(dates)||(dates=[dates],endDate&&dates.push(endDate));var dateFormat=inst.get("dateFormat"),minDate=inst.get("minDate"),maxDate=inst.get("maxDate"),curDate=inst.selectedDates[0];inst.selectedDates=[];for(var i=0;i<dates.length;i++){var date=$.datepick.determineDate(dates[i],null,curDate,dateFormat,inst.getConfig());if(date&&(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())){for(var found=!1,j=0;j<inst.selectedDates.length;j++)if(inst.selectedDates[j].getTime()==date.getTime()){found=!0;break}found||inst.selectedDates.push(date)}}var rangeSelect=inst.get("rangeSelect");if(inst.selectedDates.splice(inst.get("multiSelect")||(rangeSelect?2:1),inst.selectedDates.length),rangeSelect){switch(inst.selectedDates.length){case 1:inst.selectedDates[1]=inst.selectedDates[0];break;case 2:inst.selectedDates[1]=inst.selectedDates[0].getTime()>inst.selectedDates[1].getTime()?inst.selectedDates[0]:inst.selectedDates[1]}inst.pickingRange=!1}inst.prevDate=inst.drawDate?$.datepick.newDate(inst.drawDate):null,inst.drawDate=this._checkMinMax($.datepick.newDate(inst.selectedDates[0]||inst.get("defaultDate")||$.datepick.today()),inst),setOpt||(this._update(target),this._updateInput(target,keyUp))}},isSelectable:function(target,date){var inst=$.data(target,this.dataName);return inst?(date=$.datepick.determineDate(date,inst.selectedDates[0]||this.today(),null,inst.get("dateFormat"),inst.getConfig()),this._isSelectable(target,date,inst.get("onDate"),inst.get("minDate"),inst.get("maxDate"))):!1},_isSelectable:function(target,date,onDate,minDate,maxDate){var dateInfo="boolean"==typeof onDate?{selectable:onDate}:onDate?onDate.apply(target,[date,!0]):{};return 0!=dateInfo.selectable&&(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())},performAction:function(target,action){var inst=$.data(target,this.dataName);if(inst&&!this.isDisabled(target)){var commands=inst.get("commands");commands[action]&&commands[action].enabled.apply(target,[inst])&&commands[action].action.apply(target,[inst])}},showMonth:function(target,year,month,day){var inst=$.data(target,this.dataName);if(inst&&(null!=day||inst.drawDate.getFullYear()!=year||inst.drawDate.getMonth()+1!=month)){inst.prevDate=$.datepick.newDate(inst.drawDate);var show=this._checkMinMax(null!=year?$.datepick.newDate(year,month,1):$.datepick.today(),inst);inst.drawDate=$.datepick.newDate(show.getFullYear(),show.getMonth()+1,null!=day?day:Math.min(inst.drawDate.getDate(),$.datepick.daysInMonth(show.getFullYear(),show.getMonth()+1))),this._update(target)}},changeMonth:function(target,offset){var inst=$.data(target,this.dataName);if(inst){var date=$.datepick.add($.datepick.newDate(inst.drawDate),offset,"m");this.showMonth(target,date.getFullYear(),date.getMonth()+1)}},changeDay:function(target,offset){var inst=$.data(target,this.dataName);if(inst){var date=$.datepick.add($.datepick.newDate(inst.drawDate),offset,"d");this.showMonth(target,date.getFullYear(),date.getMonth()+1,date.getDate())}},_checkMinMax:function(date,inst){var minDate=inst.get("minDate"),maxDate=inst.get("maxDate");return date=minDate&&date.getTime()<minDate.getTime()?$.datepick.newDate(minDate):date,date=maxDate&&date.getTime()>maxDate.getTime()?$.datepick.newDate(maxDate):date},retrieveDate:function(target,elem){var inst=$.data(target,this.dataName);return inst?this._normaliseDate(new Date(parseInt(elem.className.replace(/^.*dp(-?\d+).*$/,"$1"),10))):null},selectDate:function(target,elem){var inst=$.data(target,this.dataName);if(inst&&!this.isDisabled(target)){var date=this.retrieveDate(target,elem),multiSelect=inst.get("multiSelect"),rangeSelect=inst.get("rangeSelect");if(multiSelect){for(var found=!1,i=0;i<inst.selectedDates.length;i++)if(date.getTime()==inst.selectedDates[i].getTime()){inst.selectedDates.splice(i,1),found=!0;break}!found&&inst.selectedDates.length<multiSelect&&inst.selectedDates.push(date)}else rangeSelect?(inst.pickingRange?inst.selectedDates[1]=date:inst.selectedDates=[date,date],inst.pickingRange=!inst.pickingRange):inst.selectedDates=[date];inst.prevDate=$.datepick.newDate(date),this._updateInput(target),inst.inline||inst.pickingRange||inst.selectedDates.length<(multiSelect||(rangeSelect?2:1))?this._update(target):this.hide(target)}},_generateContent:function(target,inst){var renderer=inst.get("renderer"),monthsToShow=inst.get("monthsToShow");monthsToShow=$.isArray(monthsToShow)?monthsToShow:[1,monthsToShow],inst.drawDate=this._checkMinMax(inst.drawDate||inst.get("defaultDate")||$.datepick.today(),inst);for(var drawDate=$.datepick._applyMonthsOffset($.datepick.newDate(inst.drawDate),inst),monthRows="",row=0;row<monthsToShow[0];row++){for(var months="",col=0;col<monthsToShow[1];col++)months+=this._generateMonth(target,inst,drawDate.getFullYear(),drawDate.getMonth()+1,renderer,0==row&&0==col),$.datepick.add(drawDate,1,"m");monthRows+=this._prepare(renderer.monthRow,inst).replace(/\{months\}/,months)}var picker=this._prepare(renderer.picker,inst).replace(/\{months\}/,monthRows).replace(/\{weekHeader\}/g,this._generateDayHeaders(inst,renderer))+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:void(0);" class="'+this._coverClass+'"></iframe>':""),commands=inst.get("commands"),asDateFormat=inst.get("commandsAsDateFormat"),addCommand=function(type,open,close,name,classes){if(-1!=picker.indexOf("{"+type+":"+name+"}")){var command=commands[name],date=asDateFormat?command.date.apply(target,[inst]):null;picker=picker.replace(new RegExp("\\{"+type+":"+name+"\\}","g"),"<"+open+(command.status?' title="'+inst.get(command.status)+'"':"")+' class="'+renderer.commandClass+" "+renderer.commandClass+"-"+name+" "+classes+(command.enabled(inst)?"":" "+renderer.disabledClass)+'">'+(date?$.datepick.formatDate(inst.get(command.text),date,inst.getConfig()):inst.get(command.text))+"</"+close+">")}};for(var name in commands)addCommand("button",'button type="button"',"button",name,renderer.commandButtonClass),addCommand("link",'a href="javascript:void(0)"',"a",name,renderer.commandLinkClass);if(picker=$(picker),monthsToShow[1]>1){var count=0;$(renderer.monthSelector,picker).each(function(){var nth=++count%monthsToShow[1];$(this).addClass(1==nth?"first":0==nth?"last":"")})}var self=this;picker.find(renderer.daySelector+" a").hover(function(){$(this).addClass(renderer.highlightedClass)},function(){(inst.inline?$(this).parents("."+self.markerClass):inst.div).find(renderer.daySelector+" a").removeClass(renderer.highlightedClass)}).click(function(){self.selectDate(target,this)}).end().find("select."+this._monthYearClass+":not(."+this._anyYearClass+")").change(function(){var monthYear=$(this).val().split("/");self.showMonth(target,parseInt(monthYear[1],10),parseInt(monthYear[0],10))}).end().find("select."+this._anyYearClass).click(function(){$(this).css("visibility","hidden").next("input").css({left:this.offsetLeft,top:this.offsetTop,width:this.offsetWidth,height:this.offsetHeight}).show().focus()}).end().find("input."+self._monthYearClass).change(function(){try{var year=parseInt($(this).val(),10);year=isNaN(year)?inst.drawDate.getFullYear():year,self.showMonth(target,year,inst.drawDate.getMonth()+1,inst.drawDate.getDate())}catch(e){alert(e)}}).keydown(function(event){13==event.keyCode?$(event.target).change():27==event.keyCode&&($(event.target).hide().prev("select").css("visibility","visible"),inst.target.focus())}),picker.find("."+renderer.commandClass).click(function(){if(!$(this).hasClass(renderer.disabledClass)){var action=this.className.replace(new RegExp("^.*"+renderer.commandClass+"-([^ ]+).*$"),"$1");$.datepick.performAction(target,action)}}),inst.get("isRTL")&&picker.addClass(renderer.rtlClass),monthsToShow[0]*monthsToShow[1]>1&&picker.addClass(renderer.multiClass);var pickerClass=inst.get("pickerClass");pickerClass&&picker.addClass(pickerClass),$("body").append(picker);var width=0;picker.find(renderer.monthSelector).each(function(){width+=$(this).outerWidth()}),picker.width(width/monthsToShow[0]);var onShow=inst.get("onShow");return onShow&&onShow.apply(target,[picker,inst]),picker},_generateMonth:function(target,inst,year,month,renderer,first){var daysInMonth=$.datepick.daysInMonth(year,month),monthsToShow=inst.get("monthsToShow");monthsToShow=$.isArray(monthsToShow)?monthsToShow:[1,monthsToShow];var fixedWeeks=inst.get("fixedWeeks")||monthsToShow[0]*monthsToShow[1]>1,firstDay=inst.get("firstDay"),leadDays=($.datepick.newDate(year,month,1).getDay()-firstDay+7)%7,numWeeks=fixedWeeks?6:Math.ceil((leadDays+daysInMonth)/7),showOtherMonths=inst.get("showOtherMonths"),selectOtherMonths=inst.get("selectOtherMonths")&&showOtherMonths,dayStatus=inst.get("dayStatus"),minDate=inst.pickingRange?inst.selectedDates[0]:inst.get("minDate"),maxDate=inst.get("maxDate"),rangeSelect=inst.get("rangeSelect"),onDate=inst.get("onDate"),showWeeks=renderer.week.indexOf("{weekOfYear}")>-1,calculateWeek=inst.get("calculateWeek"),today=$.datepick.today(),drawDate=$.datepick.newDate(year,month,1);$.datepick.add(drawDate,-leadDays-(fixedWeeks&&drawDate.getDay()==firstDay?7:0),"d");for(var ts=drawDate.getTime(),weeks="",week=0;numWeeks>week;week++){for(var weekOfYear=showWeeks?'<span class="dp'+ts+'">'+(calculateWeek?calculateWeek(drawDate):0)+"</span>":"",days="",day=0;7>day;day++){var selected=!1;if(rangeSelect&&inst.selectedDates.length>0)selected=drawDate.getTime()>=inst.selectedDates[0]&&drawDate.getTime()<=inst.selectedDates[1];else for(var i=0;i<inst.selectedDates.length;i++)if(inst.selectedDates[i].getTime()==drawDate.getTime()){selected=!0;break}var dateInfo=onDate?onDate.apply(target,[drawDate,drawDate.getMonth()+1==month]):{};if(dateInfo.hasOwnProperty("text")){for(var text='<div class="relative"><ul>',i=0;i<dateInfo.text.length;i++)text+='<li><a href="'+dateInfo.href[i]+'">'+dateInfo.text[i]+"</a></li>";text+="</ul></div>"}var selectable=(selectOtherMonths||drawDate.getMonth()+1==month)&&this._isSelectable(target,drawDate,dateInfo.selectable,minDate,maxDate);days+=this._prepare(renderer.day,inst).replace(/\{day\}/g,(selectable?'<a href="javascript:void(0)"':"<span")+' class="dp'+ts+" "+(dateInfo.dateClass||"")+(selected&&(selectOtherMonths||drawDate.getMonth()+1==month)?" "+renderer.selectedClass:"")+(selectable?" "+renderer.defaultClass:"")+((drawDate.getDay()||7)<6?"":" "+renderer.weekendClass)+(drawDate.getMonth()+1==month?"":" "+renderer.otherMonthClass)+(drawDate.getTime()==today.getTime()&&drawDate.getMonth()+1==month?" "+renderer.todayClass:"")+(drawDate.getTime()==inst.drawDate.getTime()&&drawDate.getMonth()+1==month?" "+renderer.highlightedClass:"")+'"'+(dateInfo.title||dayStatus&&selectable?' data-title="'+(dateInfo.title||$.datepick.formatDate(dayStatus,drawDate,inst.getConfig()))+'"':"")+" >"+(showOtherMonths||drawDate.getMonth()+1==month?dateInfo.content||drawDate.getDate():"&nbsp;")+(selectable?"</a> "+text:"</span>")),$.datepick.add(drawDate,1,"d"),ts=drawDate.getTime()}weeks+=this._prepare(renderer.week,inst).replace(/\{days\}/g,days).replace(/\{weekOfYear\}/g,weekOfYear)}var monthHeader=this._prepare(renderer.month,inst).match(/\{monthHeader(:[^\}]+)?\}/);monthHeader=monthHeader[0].length<=13?"MM yyyy":monthHeader[0].substring(13,monthHeader[0].length-1),monthHeader=first?this._generateMonthSelection(inst,year,month,minDate,maxDate,monthHeader,renderer):$.datepick.formatDate(monthHeader,$.datepick.newDate(year,month,1),inst.getConfig());var weekHeader=this._prepare(renderer.weekHeader,inst).replace(/\{days\}/g,this._generateDayHeaders(inst,renderer));return this._prepare(renderer.month,inst).replace(/\{monthHeader(:[^\}]+)?\}/g,monthHeader).replace(/\{weekHeader\}/g,weekHeader).replace(/\{weeks\}/g,weeks)},_generateDayHeaders:function(inst,renderer){for(var firstDay=inst.get("firstDay"),dayNames=inst.get("dayNames"),dayNamesMin=inst.get("dayNamesMin"),header="",day=0;7>day;day++){var dow=(day+firstDay)%7;header+=this._prepare(renderer.dayHeader,inst).replace(/\{day\}/g,'<span class="'+this._curDoWClass+dow+'" title="'+dayNames[dow]+'">'+dayNamesMin[dow]+"</span>")}return header},_generateMonthSelection:function(inst,year,month,minDate,maxDate,monthHeader){if(!inst.get("changeMonth"))return $.datepick.formatDate(monthHeader,$.datepick.newDate(year,month,1),inst.getConfig());for(var monthNames=inst.get("monthNames"+(monthHeader.match(/mm/i)?"":"Short")),html=monthHeader.replace(/m+/i,"\\x2E").replace(/y+/i,"\\x2F"),selector='<select class="'+this._monthYearClass+'" title="'+inst.get("monthStatus")+'">',m=1;12>=m;m++)(!minDate||$.datepick.newDate(year,m,$.datepick.daysInMonth(year,m)).getTime()>=minDate.getTime())&&(!maxDate||$.datepick.newDate(year,m,1).getTime()<=maxDate.getTime())&&(selector+='<option value="'+m+"/"+year+'"'+(month==m?' selected="selected"':"")+">"+monthNames[m-1]+"</option>");selector+="</select>",html=html.replace(/\\x2E/,selector);var yearRange=inst.get("yearRange");if("any"==yearRange)selector='<select class="'+this._monthYearClass+" "+this._anyYearClass+'" title="'+inst.get("yearStatus")+'"><option>'+year+'</option></select><input class="'+this._monthYearClass+" "+this._curMonthClass+month+'" value="'+year+'">';else{
yearRange=yearRange.split(":");var todayYear=$.datepick.today().getFullYear(),start=yearRange[0].match("c[+-].*")?year+parseInt(yearRange[0].substring(1),10):(yearRange[0].match("[+-].*")?todayYear:0)+parseInt(yearRange[0],10),end=yearRange[1].match("c[+-].*")?year+parseInt(yearRange[1].substring(1),10):(yearRange[1].match("[+-].*")?todayYear:0)+parseInt(yearRange[1],10);selector='<select class="'+this._monthYearClass+'" title="'+inst.get("yearStatus")+'">',start=$.datepick.add($.datepick.newDate(start+1,1,1),-1,"d"),end=$.datepick.newDate(end,1,1);var addYear=function(y){0!=y&&(selector+='<option value="'+month+"/"+y+'"'+(year==y?' selected="selected"':"")+">"+y+"</option>")};if(start.getTime()<end.getTime()){start=(minDate&&minDate.getTime()>start.getTime()?minDate:start).getFullYear(),end=(maxDate&&maxDate.getTime()<end.getTime()?maxDate:end).getFullYear();for(var y=start;end>=y;y++)addYear(y)}else{start=(maxDate&&maxDate.getTime()<start.getTime()?maxDate:start).getFullYear(),end=(minDate&&minDate.getTime()>end.getTime()?minDate:end).getFullYear();for(var y=start;y>=end;y--)addYear(y)}selector+="</select>"}return html=html.replace(/\\x2F/,selector)},_prepare:function(text,inst){var replaceSection=function(type,retain){for(;;){var start=text.indexOf("{"+type+":start}");if(-1==start)return;var end=text.substring(start).indexOf("{"+type+":end}");end>-1&&(text=text.substring(0,start)+(retain?text.substr(start+type.length+8,end-type.length-8):"")+text.substring(start+end+type.length+6))}};replaceSection("inline",inst.inline),replaceSection("popup",!inst.inline);for(var pattern=/\{l10n:([^\}]+)\}/,matches=null;matches=pattern.exec(text);)text=text.replace(matches[0],inst.get(matches[1]));return text}}),$.fn.datepick=function(options){var otherArgs=Array.prototype.slice.call(arguments,1);return $.inArray(options,["getDate","isDisabled","isSelectable","options","retrieveDate"])>-1?$.datepick[options].apply($.datepick,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepick[options].apply($.datepick,[this].concat(otherArgs)):$.datepick._attachPicker(this,options||{})})},$.datepick=new Datepicker,$(function(){$(document).mousedown($.datepick._checkExternalClick).resize(function(){$.datepick.hide($.datepick.curInst)})})}(jQuery),function($){$.datepick.regional["en-GB"]={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["S","M","T","W","T","F","S"],dateFormat:"dd/mm/yyyy",firstDay:1,renderer:$.datepick.defaultRenderer,prevText:"Prev",prevStatus:"Show the previous month",prevJumpText:"&#x3c;&#x3c;",prevJumpStatus:"Show the previous year",nextText:"Next",nextStatus:"Show the next month",nextJumpText:"&#x3e;&#x3e;",nextJumpStatus:"Show the next year",currentText:"Current",currentStatus:"Show the current month",todayText:"Today",todayStatus:"Show today's month",clearText:"Clear",clearStatus:"Erase the current date",closeText:"Done",closeStatus:"Close without change",yearStatus:"Show a different year",monthStatus:"Show a different month",weekText:"Wk",weekStatus:"Week of the year",dayStatus:"Select DD, M d",defaultStatus:"Select a date",isRTL:!1},$.datepick.setDefaults($.datepick.regional["en-GB"])}(jQuery),function($){"use strict";var methods={init:function(options){var form=this;return form.data("jqv")&&null!=form.data("jqv")||(options=methods._saveOptions(form,options),$(".formError").live("click",function(){$(this).fadeOut(150,function(){$(this).parent(".formErrorOuter").remove(),$(this).remove()})})),this},attach:function(userOptions){var options,form=this;return options=userOptions?methods._saveOptions(form,userOptions):form.data("jqv"),options.validateAttribute=form.find("[data-validation-engine*=validate]").length?"data-validation-engine":"class",options.binded&&(form.on(options.validationEventTrigger,"["+options.validateAttribute+"*=validate]:not([type=checkbox]):not([type=radio]):not(.datepicker)",methods._onFieldEvent),form.on("click","["+options.validateAttribute+"*=validate][type=checkbox],["+options.validateAttribute+"*=validate][type=radio]",methods._onFieldEvent),form.on(options.validationEventTrigger,"["+options.validateAttribute+"*=validate][class*=datepicker]",{delay:300},methods._onFieldEvent)),options.autoPositionUpdate&&$(window).bind("resize",{noAnimation:!0,formElem:form},methods.updatePromptsPosition),form.on("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",methods._submitButtonClick),form.removeData("jqv_submitButton"),form.on("submit",methods._onSubmitEvent),this},detach:function(){var form=this,options=form.data("jqv");return form.find("["+options.validateAttribute+"*=validate]").not("[type=checkbox]").off(options.validationEventTrigger,methods._onFieldEvent),form.find("["+options.validateAttribute+"*=validate][type=checkbox],[class*=validate][type=radio]").off("click",methods._onFieldEvent),form.off("submit",methods.onAjaxFormComplete),form.die("submit",methods.onAjaxFormComplete),form.removeData("jqv"),form.off("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",methods._submitButtonClick),form.removeData("jqv_submitButton"),options.autoPositionUpdate&&$(window).unbind("resize",methods.updatePromptsPosition),this},validate:function(){var element=$(this),valid=null;if(!element.is("form")&&!element.hasClass("validationEngineContainer")||element.hasClass("validating"))if(element.is("form")||element.hasClass("validationEngineContainer"))element.removeClass("validating");else{var form=element.closest("form, .validationEngineContainer"),options=form.data("jqv")?form.data("jqv"):$.validationEngine.defaults,valid=methods._validateField(element,options);valid&&options.onFieldSuccess?options.onFieldSuccess():options.onFieldFailure&&options.InvalidFields.length>0&&options.onFieldFailure()}else{element.addClass("validating");var options=element.data("jqv"),valid=methods._validateFields(this);setTimeout(function(){element.removeClass("validating")},100),valid&&options.onSuccess?options.onSuccess():!valid&&options.onFailure&&options.onFailure()}return options.onValidationComplete?!!options.onValidationComplete(form,valid):valid},updatePromptsPosition:function(event){if(event&&this==window)var form=event.data.formElem,noAnimation=event.data.noAnimation;else var form=$(this.closest("form, .validationEngineContainer"));var options=form.data("jqv");return form.find("["+options.validateAttribute+"*=validate]").not(":disabled").each(function(){var field=$(this);options.prettySelect&&field.is(":hidden")&&(field=form.hasClass("dropkick")?form.find("#"+options.usePrefix+field.attr("id")+options.useSuffix):form.find("#"+field.attr("id")+options.useSuffix));var prompt=methods._getPrompt(field),promptText=$(prompt).find(".formErrorContent").html();prompt&&methods._updatePrompt(field,$(prompt),promptText,void 0,!1,options,noAnimation)}),this},showPrompt:function(promptText,type,promptPosition,showArrow){var form=this.closest("form, .validationEngineContainer"),options=form.data("jqv");return options||(options=methods._saveOptions(this,options)),promptPosition&&(options.promptPosition=promptPosition),options.showArrow=1==showArrow,methods._showPrompt(this,promptText,type,!1,options),this},hide:function(){var closingtag,form=$(this).closest("form, .validationEngineContainer"),options=form.data("jqv"),fadeDuration=options&&options.fadeDuration?options.fadeDuration:.3;return closingtag=$(this).is("form")||$(this).hasClass("validationEngineContainer")?"parentForm"+methods._getClassName($(this).attr("id")):methods._getClassName($(this).attr("id"))+"formError",$("."+closingtag).fadeTo(fadeDuration,.3,function(){$(this).parent(".formErrorOuter").remove(),$(this).remove()}),this},hideAll:function(){var form=this,options=form.data("jqv"),duration=options?options.fadeDuration:300;return $(".formError").fadeTo(duration,300,function(){$(this).parent(".formErrorOuter").remove(),$(this).remove()}),this},_onFieldEvent:function(event){var field=$(this),form=field.closest("form, .validationEngineContainer"),options=form.data("jqv");options.eventTrigger="field",window.setTimeout(function(){methods._validateField(field,options),0==options.InvalidFields.length&&options.onFieldSuccess?options.onFieldSuccess():options.InvalidFields.length>0&&options.onFieldFailure&&options.onFieldFailure()},event.data?event.data.delay:0)},_onSubmitEvent:function(){var form=$(this),options=form.data("jqv");if(form.data("jqv_submitButton")){var submitButton=$("#"+form.data("jqv_submitButton"));if(submitButton&&submitButton.length>0&&(submitButton.hasClass("validate-skip")||"true"==submitButton.attr("data-validation-engine-skip")))return!0}options.eventTrigger="submit";var r=methods._validateFields(form);return r&&options.ajaxFormValidation?(methods._validateFormWithAjax(form,options),!1):options.onValidationComplete?(options.checkVat&&$("#vat-placeholder").length>0&&$("#vat-placeholder").is(":visible")&&(r=methods._checkAjaxFieldStatus("vatNumber",options)),!!options.onValidationComplete(form,r)):r},_checkAjaxStatus:function(options){var status=!0;return $.each(options.ajaxValidCache,function(key,value){return value?void 0:(status=!1,!1)}),status},_checkAjaxFieldStatus:function(fieldid,options){return 1==options.ajaxValidCache[fieldid]},_validateFields:function(form){var options=form.data("jqv"),errorFound=!1;form.trigger("jqv.form.validating");var first_err=null;if(form.find("["+options.validateAttribute+"*=validate]").not(":disabled").each(function(){var field=$(this),names=[];if($.inArray(field.attr("name"),names)<0){if(errorFound|=methods._validateField(field,options),errorFound&&null==first_err&&(first_err=field.is(":hidden")&&options.prettySelect?field=form.hasClass("dropkick")?form.find("#"+options.usePrefix+methods._jqSelector(field.attr("id"))+options.useSuffix):form.find("#"+methods._jqSelector(field.attr("id"))+options.useSuffix):field),options.doNotShowAllErrosOnSubmit)return!1;if(names.push(field.attr("name")),1==options.showOneMessage&&errorFound)return!1}}),form.trigger("jqv.form.result",[errorFound]),errorFound){if(options.scroll){var destination=first_err.offset().top,positionType=(first_err.offset().left,options.promptPosition);if("string"==typeof positionType&&-1!=positionType.indexOf(":")&&(positionType=positionType.substring(0,positionType.indexOf(":"))),"bottomRight"!=positionType&&"bottomLeft"!=positionType){var prompt_err=methods._getPrompt(first_err);prompt_err&&(destination=prompt_err.offset().top,destination-=first_err.hasClass("custom dropdown")?25:first_err.parent().hasClass("formRow")?55:32)}if(options.scrollOffset&&(destination-=options.scrollOffset),options.isOverflown){var overflowDIV=$(options.overflownDIV);if(!overflowDIV.length)return!1;var scrollContainerScroll=overflowDIV.scrollTop(),scrollContainerPos=-parseInt(overflowDIV.offset().top);destination+=scrollContainerScroll+scrollContainerPos-5;var scrollContainer=$(options.overflownDIV+":not(:animated)");scrollContainer.animate({scrollTop:destination},1100,function(){options.focusFirstField&&first_err.focus()})}else $("html, body").animate({scrollTop:destination},1100,function(){options.focusFirstField&&first_err.focus()})}else options.focusFirstField&&first_err.focus();return!1}return!0},_validateFormWithAjax:function(form,options){var data=form.serialize(),type=options.ajaxFormValidationMethod?options.ajaxFormValidationMethod:"GET",url=options.ajaxFormValidationURL?options.ajaxFormValidationURL:form.attr("action"),dataType=options.dataType?options.dataType:"json";$.ajax({type:type,url:url,cache:!1,dataType:dataType,data:data,form:form,methods:methods,options:options,beforeSend:function(){return options.onBeforeAjaxFormValidation(form,options)},error:function(data,transport){methods._ajaxError(data,transport)},success:function(json){if("json"==dataType&&json!==!0){for(var errorInForm=!1,i=0;i<json.length;i++){var value=json[i],errorFieldId=value[0],errorField=$($("#"+errorFieldId)[0]);if(1==errorField.length){var msg=value[2];if(1==value[1])if(""!=msg&&msg){if(options.allrules[msg]){var txt=options.allrules[msg].alertTextOk;txt&&(msg=txt)}options.showPrompts&&methods._showPrompt(errorField,msg,"pass",!1,options,!0)}else methods._closePrompt(errorField);else{if(errorInForm|=!0,options.allrules[msg]){var txt=options.allrules[msg].alertText;txt&&(msg=txt)}options.showPrompts&&methods._showPrompt(errorField,msg,"",!1,options,!0)}}}options.onAjaxFormComplete(!errorInForm,form,json,options)}else options.onAjaxFormComplete(!0,form,json,options)}})},_validateField:function(field,options,skipAjaxValidation){if(field.attr("id")||(field.attr("id","form-validation-field-"+$.validationEngine.fieldIdCounter),++$.validationEngine.fieldIdCounter),!options.validateNonVisibleFields&&(field.is(":hidden")&&!options.prettySelect||field.parent().is(":hidden")))return!1;var rulesParsing=field.attr(options.validateAttribute),getRules=/validate\[(.*)\]/.exec(rulesParsing);if(!getRules)return!1;var str=getRules[1],rules=str.split(/\[|,|\]/),isAjaxValidator=!1,fieldName=field.attr("name"),promptText="",promptType="",required=!1,limitErrors=!1;options.isError=!1,options.showArrow=!0,options.maxErrorsPerField>0&&(limitErrors=!0);for(var form=$(field.closest("form, .validationEngineContainer")),i=0;i<rules.length;i++)rules[i]=rules[i].replace(" ",""),""===rules[i]&&delete rules[i];for(var i=0,field_errors=0;i<rules.length;i++){if(limitErrors&&field_errors>=options.maxErrorsPerField){if(!required){var have_required=$.inArray("required",rules);required=-1!=have_required&&have_required>=i}break}var errorMsg=void 0;switch(rules[i]){case"required":required=!0,errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._required);break;case"custom":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._custom);break;case"groupRequired":var classGroup="["+options.validateAttribute+"*="+rules[i+1]+"]",firstOfGroup=form.find(classGroup).eq(0);firstOfGroup[0]!=field[0]&&(methods._validateField(firstOfGroup,options,skipAjaxValidation),options.showArrow=!0),errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._groupRequired),errorMsg&&(required=!0),options.showArrow=!1;break;case"ajax":errorMsg=methods._ajax(field,rules,i,options),errorMsg&&(promptType="load");break;case"minSize":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._minSize);break;case"maxSize":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._maxSize);break;case"min":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._min);break;case"max":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._max);break;case"past":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._past);break;case"future":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._future);break;case"dateRange":var classGroup="["+options.validateAttribute+"*="+rules[i+1]+"]";options.firstOfGroup=form.find(classGroup).eq(0),options.secondOfGroup=form.find(classGroup).eq(1),(options.firstOfGroup[0].value||options.secondOfGroup[0].value)&&(errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._dateRange)),errorMsg&&(required=!0),options.showArrow=!1;break;case"dateTimeRange":var classGroup="["+options.validateAttribute+"*="+rules[i+1]+"]";options.firstOfGroup=form.find(classGroup).eq(0),options.secondOfGroup=form.find(classGroup).eq(1),(options.firstOfGroup[0].value||options.secondOfGroup[0].value)&&(errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._dateTimeRange)),errorMsg&&(required=!0),options.showArrow=!1;break;case"maxCheckbox":field=$(form.find("input[name='"+fieldName+"']")),errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._maxCheckbox);break;case"minCheckbox":field=$(form.find("input[name='"+fieldName+"']")),errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._minCheckbox);break;case"equals":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._equals);break;case"funcCall":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._funcCall);break;case"creditCard":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._creditCard);break;case"condRequired":errorMsg=methods._getErrorMessage(form,field,rules[i],rules,i,options,methods._condRequired),void 0!==errorMsg&&(required=!0)}var end_validation=!1;if("object"==typeof errorMsg)switch(errorMsg.status){case"_break":end_validation=!0;break;case"_error":errorMsg=errorMsg.message;break;case"_error_no_prompt":return!0}if(end_validation)break;"string"==typeof errorMsg&&(promptText+=errorMsg+"<br/>",options.isError=!0,field_errors++)}!required&&!field.val()&&field.val().length<1&&(options.isError=!1);var fieldType=field.prop("type"),positionType=field.data("promptPosition")||options.promptPosition;("radio"==fieldType||"checkbox"==fieldType)&&form.find("input[name='"+fieldName+"']").size()>1&&(field=$("inline"===positionType?form.find("input[name='"+fieldName+"'][type!=hidden]:last"):form.find("input[name='"+fieldName+"'][type!=hidden]:first")),options.showArrow=!1),field.is(":hidden")&&options.prettySelect&&(field=form.hasClass("dropkick")?form.find("#"+options.usePrefix+methods._jqSelector(field.attr("id"))+options.useSuffix):form.find("#"+methods._jqSelector(field.attr("id"))+options.useSuffix)),options.isError&&options.showPrompts?methods._showPrompt(field,promptText,promptType,!1,options):isAjaxValidator||methods._closePrompt(field),isAjaxValidator||field.trigger("jqv.field.result",[field,options.isError,promptText]);var errindex=$.inArray(field[0],options.InvalidFields);return-1==errindex?options.isError&&options.InvalidFields.push(field[0]):options.isError||options.InvalidFields.splice(errindex,1),methods._handleStatusCssClasses(field,options),options.isError&&options.onFieldFailure&&options.onFieldFailure(field),!options.isError&&options.onFieldSuccess&&options.onFieldSuccess(field),options.isError},_handleStatusCssClasses:function(field,options){options.addSuccessCssClassToField&&field.removeClass(options.addSuccessCssClassToField),options.addFailureCssClassToField&&field.removeClass(options.addFailureCssClassToField),options.addSuccessCssClassToField&&!options.isError&&field.addClass(options.addSuccessCssClassToField),options.addFailureCssClassToField&&options.isError&&field.addClass(options.addFailureCssClassToField)},_getErrorMessage:function(form,field,rule,rules,i,options,originalValidationMethod){var rule_index=jQuery.inArray(rule,rules);if("custom"===rule||"funcCall"===rule){var custom_validation_type=rules[rule_index+1];rule=rule+"["+custom_validation_type+"]",delete rules[rule_index]}var errorMsg,alteredRule=rule,element_classes=field.attr("data-validation-engine")?field.attr("data-validation-engine"):field.attr("class"),element_classes_array=element_classes.split(" ");if(errorMsg="future"==rule||"past"==rule||"maxCheckbox"==rule||"minCheckbox"==rule?originalValidationMethod(form,field,rules,i,options):originalValidationMethod(field,rules,i,options),void 0!=errorMsg){var custom_message=methods._getCustomErrorMessage($(field),element_classes_array,alteredRule,options);custom_message&&(errorMsg=custom_message)}return errorMsg},_getCustomErrorMessage:function(field,classes,rule,options){var custom_message=!1,validityProp=methods._validityProp[rule];if(void 0!=validityProp&&(custom_message=field.attr("data-errormessage-"+validityProp),void 0!=custom_message))return custom_message;if(custom_message=field.attr("data-errormessage"),void 0!=custom_message)return custom_message;var id="#"+field.attr("id");if("undefined"!=typeof options.custom_error_messages[id]&&"undefined"!=typeof options.custom_error_messages[id][rule])custom_message=options.custom_error_messages[id][rule].message;else if(classes.length>0)for(var i=0;i<classes.length&&classes.length>0;i++){var element_class="."+classes[i];if("undefined"!=typeof options.custom_error_messages[element_class]&&"undefined"!=typeof options.custom_error_messages[element_class][rule]){custom_message=options.custom_error_messages[element_class][rule].message;break}}return custom_message||"undefined"==typeof options.custom_error_messages[rule]||"undefined"==typeof options.custom_error_messages[rule].message||(custom_message=options.custom_error_messages[rule].message),custom_message},_validityProp:{required:"value-missing",custom:"custom-error",groupRequired:"value-missing",ajax:"custom-error",minSize:"range-underflow",maxSize:"range-overflow",min:"range-underflow",max:"range-overflow",past:"type-mismatch",future:"type-mismatch",dateRange:"type-mismatch",dateTimeRange:"type-mismatch",maxCheckbox:"range-overflow",minCheckbox:"range-underflow",equals:"pattern-mismatch",funcCall:"custom-error",creditCard:"pattern-mismatch",condRequired:"value-missing"},_required:function(field,rules,i,options,condRequired){switch(field.prop("type")){case"text":case"password":case"textarea":case"file":case"select-one":case"select-multiple":default:var field_val=$.trim(field.val()),dv_placeholder=$.trim(field.attr("data-validation-placeholder")),placeholder=$.trim(field.attr("placeholder"));if(!field_val||dv_placeholder&&field_val==dv_placeholder||placeholder&&field_val==placeholder)return options.allrules[rules[i]].alertText;break;case"radio":case"checkbox":if(condRequired){if(!field.attr("checked"))return options.allrules[rules[i]].alertTextCheckboxMultiple;break}var form=field.closest("form, .validationEngineContainer"),name=field.attr("name");if(0==form.find("input[name='"+name+"']:checked").size())return 1==form.find("input[name='"+name+"']:visible").size()?options.allrules[rules[i]].alertTextCheckboxe:options.allrules[rules[i]].alertTextCheckboxMultiple}},_groupRequired:function(field,rules,i,options){var classGroup="["+options.validateAttribute+"*="+rules[i+1]+"]",isValid=!1;return field.closest("form, .validationEngineContainer").find(classGroup).each(function(){return methods._required($(this),rules,i,options)?void 0:(isValid=!0,!1)}),isValid?void 0:options.allrules[rules[i]].alertText},_custom:function(field,rules,i,options){var fn,customRule=rules[i+1],rule=options.allrules[customRule];if(!rule)return void alert("jqv:custom rule not found - "+customRule);if(rule.regex){var ex=rule.regex;if(!ex)return void alert("jqv:custom regex not found - "+customRule);var pattern=new RegExp(ex);if(!pattern.test(field.val()))return options.allrules[customRule].alertText}else{if(!rule.func)return void alert("jqv:custom type not allowed "+customRule);if(fn=rule.func,"function"!=typeof fn)return void alert("jqv:custom parameter 'function' is no function - "+customRule);if(!fn(field,rules,i,options))return options.allrules[customRule].alertText}},_funcCall:function(field,rules,i,options){var fn,functionName=rules[i+1];if(functionName.indexOf(".")>-1){for(var namespaces=functionName.split("."),scope=window;namespaces.length;)scope=scope[namespaces.shift()];fn=scope}else fn=window[functionName]||options.customFunctions[functionName];return"function"==typeof fn?fn(field,rules,i,options):void 0},_equals:function(field,rules,i,options){var equalsField=rules[i+1];return field.val()!=$("#"+equalsField).val()?options.allrules.equals.alertText:void 0},_maxSize:function(field,rules,i,options){var max=rules[i+1],len=field.val().length;if(len>max){var rule=options.allrules.maxSize;return rule.alertText+max+rule.alertText2}},_minSize:function(field,rules,i,options){var min=rules[i+1],len=field.val().length;if(min>len){var rule=options.allrules.minSize;return rule.alertText+min+rule.alertText2}},_min:function(field,rules,i,options){var min=parseFloat(rules[i+1]),len=parseFloat(field.val());if(min>len){var rule=options.allrules.min;return rule.alertText2?rule.alertText+min+rule.alertText2:rule.alertText+min}},_max:function(field,rules,i,options){var max=parseFloat(rules[i+1]),len=parseFloat(field.val());if(len>max){var rule=options.allrules.max;return rule.alertText2?rule.alertText+max+rule.alertText2:rule.alertText+max}},_past:function(form,field,rules,i,options){var pdate,p=rules[i+1],fieldAlt=$(form.find("input[name='"+p.replace(/^#+/,"")+"']"));if("now"==p.toLowerCase())pdate=new Date;else if(void 0!=fieldAlt.val()){if(fieldAlt.is(":disabled"))return;pdate=methods._parseDate(fieldAlt.val())}else pdate=methods._parseDate(p);var vdate=methods._parseDate(field.val());if(vdate>pdate){var rule=options.allrules.past;return rule.alertText2?rule.alertText+methods._dateToString(pdate)+rule.alertText2:rule.alertText+methods._dateToString(pdate)}},_future:function(form,field,rules,i,options){var pdate,p=rules[i+1],fieldAlt=$(form.find("input[name='"+p.replace(/^#+/,"")+"']"));if("now"==p.toLowerCase())pdate=new Date;else if(void 0!=fieldAlt.val()){if(fieldAlt.is(":disabled"))return;pdate=methods._parseDate(fieldAlt.val())}else pdate=methods._parseDate(p);var vdate=methods._parseDate(field.val());if(pdate>vdate){var rule=options.allrules.future;return rule.alertText2?rule.alertText+methods._dateToString(pdate)+rule.alertText2:rule.alertText+methods._dateToString(pdate)}},_isDate:function(value){var dateRegEx=new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/);return dateRegEx.test(value)},_isDateTime:function(value){var dateTimeRegEx=new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/);return dateTimeRegEx.test(value)},_dateCompare:function(start,end){return new Date(start.toString())<new Date(end.toString())},_dateRange:function(field,rules,i,options){return!options.firstOfGroup[0].value&&options.secondOfGroup[0].value||options.firstOfGroup[0].value&&!options.secondOfGroup[0].value?options.allrules[rules[i]].alertText+options.allrules[rules[i]].alertText2:methods._isDate(options.firstOfGroup[0].value)&&methods._isDate(options.secondOfGroup[0].value)&&methods._dateCompare(options.firstOfGroup[0].value,options.secondOfGroup[0].value)?void 0:options.allrules[rules[i]].alertText+options.allrules[rules[i]].alertText2},_dateTimeRange:function(field,rules,i,options){return!options.firstOfGroup[0].value&&options.secondOfGroup[0].value||options.firstOfGroup[0].value&&!options.secondOfGroup[0].value?options.allrules[rules[i]].alertText+options.allrules[rules[i]].alertText2:methods._isDateTime(options.firstOfGroup[0].value)&&methods._isDateTime(options.secondOfGroup[0].value)&&methods._dateCompare(options.firstOfGroup[0].value,options.secondOfGroup[0].value)?void 0:options.allrules[rules[i]].alertText+options.allrules[rules[i]].alertText2},_maxCheckbox:function(form,field,rules,i,options){var nbCheck=rules[i+1],groupname=field.attr("name"),groupSize=form.find("input[name='"+groupname+"']:checked").size();return groupSize>nbCheck?(options.showArrow=!1,options.allrules.maxCheckbox.alertText2?options.allrules.maxCheckbox.alertText+" "+nbCheck+" "+options.allrules.maxCheckbox.alertText2:options.allrules.maxCheckbox.alertText):void 0},_minCheckbox:function(form,field,rules,i,options){var nbCheck=rules[i+1],groupname=field.attr("name"),groupSize=form.find("input[name='"+groupname+"']:checked").size();return nbCheck>groupSize?(options.showArrow=!1,options.allrules.minCheckbox.alertText+" "+nbCheck+" "+options.allrules.minCheckbox.alertText2):void 0},_creditCard:function(field,rules,i,options){var valid=!1,cardNumber=field.val().replace(/ +/g,"").replace(/-+/g,""),numDigits=cardNumber.length;if(numDigits>=14&&16>=numDigits&&parseInt(cardNumber)>0){var digit,sum=0,i=numDigits-1,pos=1,luhn=new String;do digit=parseInt(cardNumber.charAt(i)),luhn+=pos++%2==0?2*digit:digit;while(--i>=0);for(i=0;i<luhn.length;i++)sum+=parseInt(luhn.charAt(i));valid=sum%10==0}return valid?void 0:options.allrules.creditCard.alertText},_ajax:function(field,rules,i,options){var errorSelector=rules[i+1],rule=options.allrules[errorSelector],extraData=rule.extraData,extraDataDynamic=rule.extraDataDynamic,data={fieldId:field.attr("id"),fieldValue:field.val()};if("object"==typeof extraData)$.extend(data,extraData);else if("string"==typeof extraData)for(var tempData=extraData.split("&"),i=0;i<tempData.length;i++){var values=tempData[i].split("=");values[0]&&values[0]&&(data[values[0]]=values[1])}if(extraDataDynamic)for(var domIds=String(extraDataDynamic).split(","),i=0;i<domIds.length;i++){var id=domIds[i];if($(id).length){var inputValue=field.closest("form, .validationEngineContainer").find(id).val();id.replace("#","")+"="+escape(inputValue);data[id.replace("#","")]=inputValue}}return"field"==options.eventTrigger&&delete options.ajaxValidCache[field.attr("id")],options.isError||methods._checkAjaxFieldStatus(field.attr("id"),options)?void 0:($.ajax({type:options.ajaxFormValidationMethod,url:rule.url,cache:!1,dataType:"json",data:data,field:field,rule:rule,methods:methods,options:options,beforeSend:function(){},error:function(data,transport){methods._ajaxError(data,transport)},success:function(json){var errorFieldId=json[0],errorField=$("#"+errorFieldId).eq(0);if(1==errorField.length){var status=json[1],msg=json[2];if(status){if(options.ajaxValidCache[errorFieldId]=!0,msg){if(options.allrules[msg]){var txt=options.allrules[msg].alertTextOk;txt&&(msg=txt)}}else msg=rule.alertTextOk;options.showPrompts&&(msg?methods._showPrompt(errorField,msg,"pass",!0,options):methods._closePrompt(errorField)),"submit"==options.eventTrigger&&field.closest("form").submit()}else{if(options.ajaxValidCache[errorFieldId]=!1,options.isError=!0,msg){if(options.allrules[msg]){var txt=options.allrules[msg].alertText;txt&&(msg=txt)}}else msg=rule.alertText;options.showPrompts&&methods._showPrompt(errorField,msg,"",!0,options)}}errorField.trigger("jqv.field.result",[errorField,options.isError,msg])}}),rule.alertTextLoad)},_ajaxError:function(data,transport){0==data.status&&null==transport?alert("The page is not served from a server! ajax call failed"):"undefined"!=typeof console&&console.log("Ajax error: "+data.status+" "+transport)},_dateToString:function(date){return date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()},_parseDate:function(d){var dateParts=d.split("-");return dateParts==d&&(dateParts=d.split("/")),new Date(dateParts[0],dateParts[1]-1,dateParts[2])},_showPrompt:function(field,promptText,type,ajaxed,options,ajaxform){var prompt=methods._getPrompt(field);ajaxform&&(prompt=!1),$.trim(promptText)&&(prompt?methods._updatePrompt(field,prompt,promptText,type,ajaxed,options):methods._buildPrompt(field,promptText,type,ajaxed,options))},_buildPrompt:function(field,promptText,type,ajaxed,options){var prompt=$("<div>");switch(prompt.addClass(methods._getClassName(field.attr("id"))+"formError"),
prompt.addClass("parentForm"+methods._getClassName(field.closest("form, .validationEngineContainer").attr("id"))),prompt.addClass("formError"),type){case"pass":prompt.addClass("greenPopup");break;case"load":prompt.addClass("blackPopup")}ajaxed&&prompt.addClass("ajaxed");var positionType=($("<div>").addClass("formErrorContent").html(promptText).attr("id","errorMsg_"+field.attr("id")).appendTo(prompt),field.data("promptPosition")||options.promptPosition);if(options.showArrow){var arrow=$("<div>").addClass("formErrorArrow");if("string"==typeof positionType){var pos=positionType.indexOf(":");-1!=pos&&(positionType=positionType.substring(0,pos))}switch(positionType){case"bottomLeft":case"bottomRight":prompt.find(".formErrorContent").before(arrow),arrow.addClass("formErrorArrowBottom").html('<div class="line1"><!-- --></div><div class="line2"><!-- --></div><div class="line3"><!-- --></div><div class="line4"><!-- --></div><div class="line5"><!-- --></div><div class="line6"><!-- --></div><div class="line7"><!-- --></div><div class="line8"><!-- --></div><div class="line9"><!-- --></div><div class="line10"><!-- --></div>');break;case"topLeft":case"topRight":arrow.html('<div class="line10"><!-- --></div><div class="line9"><!-- --></div><div class="line8"><!-- --></div><div class="line7"><!-- --></div><div class="line6"><!-- --></div><div class="line5"><!-- --></div><div class="line4"><!-- --></div><div class="line3"><!-- --></div><div class="line2"><!-- --></div><div class="line1"><!-- --></div>'),prompt.append(arrow)}}options.addPromptClass&&prompt.addClass(options.addPromptClass);var requiredOverride=field.attr("data-required-class");if(void 0!==requiredOverride)prompt.addClass(requiredOverride);else if(options.prettySelect&&$("#"+field.attr("id")).next().is("select")){var prettyOverrideClass=$("#"+field.attr("id").substr(options.usePrefix.length).substring(options.useSuffix.length)).attr("data-required-class");void 0!==prettyOverrideClass&&prompt.addClass(prettyOverrideClass)}if(prompt.css({opacity:0}),"inline"===positionType)if(prompt.addClass("inline"),"undefined"!=typeof field.attr("data-prompt-target")){var r=new RegExp(/customTarget\[.+\]/),promptTarget=field.attr("data-prompt-target");if(r.test(promptTarget)){var promptTarget=promptTarget.match(/customTarget\[(.+)\]/);prompt.appendTo(field.siblings(promptTarget[1]))}else $("#"+field.attr("data-prompt-target")).length>0?prompt.appendTo($("#"+field.attr("data-prompt-target"))):field.after(prompt)}else field.after(prompt);else field.before(prompt);var pos=methods._calculatePosition(field,prompt,options);return prompt.css({position:"inline"===positionType?"relative":"absolute",top:pos.callerTopPosition,left:pos.callerleftPosition,marginTop:pos.marginTopSize,opacity:0}).data("callerField",field),options.autoHidePrompt&&setTimeout(function(){prompt.animate({opacity:0},function(){prompt.closest(".formErrorOuter").remove(),prompt.remove()})},options.autoHideDelay),prompt.animate({opacity:.87})},_updatePrompt:function(field,prompt,promptText,type,ajaxed,options,noAnimation){if(prompt){"undefined"!=typeof type&&("pass"==type?prompt.addClass("greenPopup"):prompt.removeClass("greenPopup"),"load"==type?prompt.addClass("blackPopup"):prompt.removeClass("blackPopup")),ajaxed?prompt.addClass("ajaxed"):prompt.removeClass("ajaxed"),prompt.find(".formErrorContent").html(promptText);var pos=methods._calculatePosition(field,prompt,options),css={top:pos.callerTopPosition,left:pos.callerleftPosition,marginTop:pos.marginTopSize};noAnimation?prompt.css(css):prompt.animate(css)}},_closePrompt:function(field){var prompt=methods._getPrompt(field);prompt&&prompt.fadeTo("fast",0,function(){prompt.parent(".formErrorOuter").remove(),prompt.remove()})},closePrompt:function(field){return methods._closePrompt(field)},_getPrompt:function(field){var formId=$(field).closest("form, .validationEngineContainer").attr("id"),className=methods._getClassName(field.attr("id"))+"formError",match=$("."+methods._escapeExpression(className)+".parentForm"+formId)[0];return match?$(match):void 0},_escapeExpression:function(selector){return selector.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},isRTL:function(field){var $document=$(document),$body=$("body"),rtl=field&&field.hasClass("rtl")||field&&"rtl"===(field.attr("dir")||"").toLowerCase()||$document.hasClass("rtl")||"rtl"===($document.attr("dir")||"").toLowerCase()||$body.hasClass("rtl")||"rtl"===($body.attr("dir")||"").toLowerCase();return Boolean(rtl)},_calculatePosition:function(field,promptElmt,options){var promptTopPosition,promptleftPosition,marginTopSize,fieldWidth=field.width(),fieldLeft=field.position().left,fieldTop=field.position().top,promptHeight=(field.height(),promptElmt.height());promptTopPosition=promptleftPosition=0,marginTopSize=-promptHeight;var positionType=field.data("promptPosition")||options.promptPosition,shift1="",shift2="",shiftX=0,shiftY=0;switch("string"==typeof positionType&&-1!=positionType.indexOf(":")&&(shift1=positionType.substring(positionType.indexOf(":")+1),positionType=positionType.substring(0,positionType.indexOf(":")),-1!=shift1.indexOf(",")&&(shift2=shift1.substring(shift1.indexOf(",")+1),shift1=shift1.substring(0,shift1.indexOf(",")),shiftY=parseInt(shift2),isNaN(shiftY)&&(shiftY=0)),shiftX=parseInt(shift1),isNaN(shift1)&&(shift1=0)),positionType){default:case"topRight":promptleftPosition+=fieldLeft+fieldWidth-30,promptTopPosition+=fieldTop;break;case"topLeft":promptTopPosition+=fieldTop,promptleftPosition+=fieldLeft;break;case"centerRight":promptTopPosition=fieldTop+4,marginTopSize=0,promptleftPosition=fieldLeft+field.outerWidth(!0)+5;break;case"centerLeft":promptleftPosition=fieldLeft-(promptElmt.width()+2),promptTopPosition=fieldTop+4,marginTopSize=0;break;case"bottomLeft":promptTopPosition=fieldTop+field.height()+5,marginTopSize=0,promptleftPosition=fieldLeft;break;case"bottomRight":promptleftPosition=fieldLeft+fieldWidth-30,promptTopPosition=fieldTop+field.height()+5,marginTopSize=0;break;case"inline":promptleftPosition=0,promptTopPosition=0,marginTopSize=0}return promptleftPosition+=shiftX,promptTopPosition+=shiftY,{callerTopPosition:promptTopPosition+"px",callerleftPosition:promptleftPosition+"px",marginTopSize:marginTopSize+"px"}},_saveOptions:function(form,options){if($.validationEngineLanguage)var allRules=$.validationEngineLanguage.allRules;else $.error("jQuery.validationEngine rules are not loaded, plz add localization files to the page");$.validationEngine.defaults.allrules=allRules;var userOptions=$.extend(!0,{},$.validationEngine.defaults,options);return form.data("jqv",userOptions),userOptions},_getClassName:function(className){return className?className.replace(/:/g,"_").replace(/\./g,"_"):void 0},_jqSelector:function(str){return str.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")},_condRequired:function(field,rules,i,options){var idx,dependingField;for(idx=i+1;idx<rules.length;idx++)if(dependingField=jQuery("#"+rules[idx]).first(),dependingField.length&&void 0==methods._required(dependingField,["required"],0,options,!0))return methods._required(field,["required"],0,options)},_submitButtonClick:function(event){var button=$(this),form=button.closest("form, .validationEngineContainer");form.data("jqv_submitButton",button.attr("id"))}};$.fn.validationEngine=function(method){var form=$(this);return form[0]?"string"==typeof method&&"_"!=method.charAt(0)&&methods[method]?("showPrompt"!=method&&"hide"!=method&&"hideAll"!=method&&methods.init.apply(form),methods[method].apply(form,Array.prototype.slice.call(arguments,1))):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist in jQuery.validationEngine"):(methods.init.apply(form,arguments),methods.attach.apply(form)):form},$.validationEngine={fieldIdCounter:0,defaults:{validationEventTrigger:"blur",scroll:!0,focusFirstField:!0,showPrompts:!0,validateNonVisibleFields:!1,promptPosition:"topRight",bindMethod:"bind",inlineAjax:!1,ajaxFormValidation:!1,ajaxFormValidationURL:!1,ajaxFormValidationMethod:"get",onAjaxFormComplete:$.noop,onBeforeAjaxFormValidation:$.noop,onValidationComplete:!1,doNotShowAllErrosOnSubmit:!1,custom_error_messages:{},binded:!0,showArrow:!0,isError:!1,maxErrorsPerField:!1,ajaxValidCache:{},autoPositionUpdate:!1,InvalidFields:[],onFieldSuccess:!1,onFieldFailure:!1,onSuccess:!1,onFailure:!1,validateAttribute:"class",addSuccessCssClassToField:"",addFailureCssClassToField:"",autoHidePrompt:!1,autoHideDelay:1e4,fadeDuration:.3,prettySelect:!1,addPromptClass:"",usePrefix:"",useSuffix:"",showOneMessage:!1}},$(function(){$.validationEngine.defaults.promptPosition=methods.isRTL()?"topLeft":"topRight"})}(jQuery),function($){$.fn.validationEngineLanguage=function(){},$.validationEngineLanguage={newLang:function(){$.validationEngineLanguage.allRules={required:{regex:"none",alertText:"* This field is required",alertTextCheckboxMultiple:"* Please select an option",alertTextCheckboxe:"* This checkbox is required",alertTextDateRange:"* Both date range fields are required"},requiredInFunction:{func:function(field,rules,i,options){return"test"==field.val()?!0:!1},alertText:"* Field must equal test"},brazilPostCode:{regex:/^[0-9a-zA-Z]{5}-[0-9a-zA-Z]{3}$/,alertText:"The Postcode/Zip format is invalid"},brazilCpfCode:{func:function(cpf){if(cpf=cpf.val().replace(/[^\d]+/g,""),""==cpf)return!1;if(console.log(cpf),11!=cpf.length||"00000000000"==cpf||"11111111111"==cpf||"22222222222"==cpf||"33333333333"==cpf||"44444444444"==cpf||"55555555555"==cpf||"66666666666"==cpf||"77777777777"==cpf||"88888888888"==cpf||"99999999999"==cpf)return!1;for(add=0,i=0;i<9;i++)add+=parseInt(cpf.charAt(i))*(10-i);if(rev=11-add%11,(10==rev||11==rev)&&(rev=0),rev!=parseInt(cpf.charAt(9)))return!1;for(add=0,i=0;i<10;i++)add+=parseInt(cpf.charAt(i))*(11-i);return rev=11-add%11,(10==rev||11==rev)&&(rev=0),rev!=parseInt(cpf.charAt(10))?!1:!0},alertText:"The CPF Number format is invalid"},dateRange:{regex:"none",alertText:"* Invalid ",alertText2:"Date Range"},dateTimeRange:{regex:"none",alertText:"* Invalid ",alertText2:"Date Time Range"},minSize:{regex:"none",alertText:"* Minimum ",alertText2:" characters required"},maxSize:{regex:"none",alertText:"* Maximum ",alertText2:" characters allowed"},groupRequired:{regex:"none",alertText:"* You must fill one of the following fields"},min:{regex:"none",alertText:"* Minimum value is "},max:{regex:"none",alertText:"* Maximum value is "},past:{regex:"none",alertText:"* Date prior to "},future:{regex:"none",alertText:"* Date past "},maxCheckbox:{regex:"none",alertText:"* Maximum ",alertText2:" options allowed"},minCheckbox:{regex:"none",alertText:"* Please select ",alertText2:" options"},equals:{regex:"none",alertText:"* Fields do not match"},creditCard:{regex:"none",alertText:"* Invalid credit card number"},phone:{regex:/^([\+][0-9]{1,3}[\ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9\ \.\-\/]{3,20})((x|ext|extension)[\ ]?[0-9]{1,4})?$/,alertText:"* Invalid phone number"},email:{regex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,alertText:"* Invalid email address"},integer:{regex:/^[\-\+]?\d+$/,alertText:"* Not a valid integer"},number:{regex:/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,alertText:"* Invalid floating decimal number"},date:{func:function(field){var pattern=new RegExp(/^(\d{4})[\/\-\.](0?[1-9]|1[012])[\/\-\.](0?[1-9]|[12][0-9]|3[01])$/),match=pattern.exec(field.val());if(null==match)return!1;var year=match[1],month=1*match[2],day=1*match[3],date=new Date(year,month-1,day);return date.getFullYear()==year&&date.getMonth()==month-1&&date.getDate()==day},alertText:"* Invalid date, must be in YYYY-MM-DD format"},ipv4:{regex:/^((([01]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))[.]){3}(([0-1]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))$/,alertText:"* Invalid IP address"},url:{regex:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,alertText:"* Invalid URL"},onlyNumberSp:{regex:/^[0-9\ ]+$/,alertText:"* Numbers only"},onlyLetterSp:{regex:/^[a-zA-Z\ \']+$/,alertText:"* Letters only"},onlyLetterNumber:{regex:/^[0-9a-zA-Z]+$/,alertText:"* No special characters allowed"},ajaxUniqueDisplayName:{url:"/tools/packages/cambridge_themes/jqueryValidate/",alertText:"* This display name is already taken",alertTextLoad:"* Checking availability, please wait",alertTextOk:"* This display name is available"},vatNumber:{url:"/tools/packages/cambridge_core/check_vat",extraDataDynamic:["#countrySelectDropDown-161"],alertText:"* Please enter a valid VAT number",alertTextLoad:"* Validating, please wait",alertTextOk:""},ajaxUniqueEmail:{url:"/tools/packages/cambridge_themes/jqueryValidate/",extraDataDynamic:["#isIndia"],alertText:"* This email is already subscribed",alertTextLoad:"* Checking availability, please wait",alertTextOk:""},ajaxUserCall:{url:"ajaxValidateFieldUser",extraData:"name=eric",alertText:"* This user is already taken",alertTextLoad:"* Validating, please wait"},ajaxUserCallPhp:{url:"phpajax/ajaxValidateFieldUser.php",extraData:"name=eric",alertTextOk:"* This username is available",alertText:"* This user is already taken",alertTextLoad:"* Validating, please wait"},ajaxNameCall:{url:"ajaxValidateFieldName",alertText:"* This name is already taken",alertTextOk:"* This name is available",alertTextLoad:"* Validating, please wait"},ajaxNameCallPhp:{url:"phpajax/ajaxValidateFieldName.php",alertText:"* This name is already taken",alertTextLoad:"* Validating, please wait"},validate2fields:{alertText:"* Please input HELLO"},dateFormat:{regex:/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/,alertText:"* Invalid Date"},dateTimeFormat:{regex:/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/,alertText:"* Invalid Date or Date Format",alertText2:"Expected Format: ",alertText3:"mm/dd/yyyy hh:mm:ss AM|PM or ",alertText4:"yyyy-mm-dd hh:mm:ss AM|PM"},zipcode:{func:function(field){var usPattern=new RegExp(/^\d{5}(\-\d{4})?$/),caPattern=new RegExp(/^[0-9A-Za-z]\d[0-9A-Za-z][ -]?\d[0-9A-Za-z]\d$/),matchResult=!0;if(field.val(field.val().trim()),"Canada"==$("#country").val()){var match=caPattern.exec(field.val());null==match&&(matchResult=!1)}else{var match=usPattern.exec(field.val());null==match&&(matchResult=!1)}return matchResult},alertText:"* Invalid Zip Code"}}}},$.validationEngineLanguage.newLang()}(jQuery),function($){$.belowthefold=function(element,settings){var fold=$(window).height()+$(window).scrollTop();return fold<=$(element).offset().top-settings.threshold},$.abovethetop=function(element,settings){var top=$(window).scrollTop();return top>=$(element).offset().top+$(element).height()-settings.threshold},$.rightofscreen=function(element,settings){var fold=$(window).width()+$(window).scrollLeft();return fold<=$(element).offset().left-settings.threshold},$.leftofscreen=function(element,settings){var left=$(window).scrollLeft();return left>=$(element).offset().left+$(element).width()-settings.threshold},$.inviewport=function(element,settings){return!($.rightofscreen(element,settings)||$.leftofscreen(element,settings)||$.belowthefold(element,settings)||$.abovethetop(element,settings))},$.extend($.expr[":"],{"below-the-fold":function(a,i,m){return $.belowthefold(a,{threshold:0})},"above-the-top":function(a,i,m){return $.abovethetop(a,{threshold:0})},"left-of-screen":function(a,i,m){return $.leftofscreen(a,{threshold:0})},"right-of-screen":function(a,i,m){return $.rightofscreen(a,{threshold:0})},"in-viewport":function(a,i,m){return $.inviewport(a,{threshold:0})}})}(jQuery),$.scrollTo=$.fn.scrollTo=function(x,y,options){return this instanceof $?(options=$.extend({},{gap:{x:0,y:0},animation:{easing:"swing",duration:600,complete:$.noop,step:$.noop}},options),this.each(function(){var elem=$(this);elem.stop().animate({scrollLeft:isNaN(Number(x))?$(y).offset().left+options.gap.x:x,scrollTop:isNaN(Number(y))?$(y).offset().top+options.gap.y:y},options.animation)})):$.fn.scrollTo.apply($("html, body"),arguments)},function(window,document,undefined){!function(factory){"use strict";"function"==typeof define&&define.amd?define("datatables",["jquery"],factory):"object"==typeof exports?module.exports=factory(require("jquery")):jQuery&&!jQuery.fn.dataTable&&factory(jQuery)}(function($){"use strict";function _fnHungarianMap(o){var match,newKey,hungarian="a aa ai ao as b fn i m o s ",map={};$.each(o,function(key,val){match=key.match(/^([^A-Z]+?)([A-Z])/),match&&-1!==hungarian.indexOf(match[1]+" ")&&(newKey=key.replace(match[0],match[2].toLowerCase()),map[newKey]=key,"o"===match[1]&&_fnHungarianMap(o[key]))}),o._hungarianMap=map}function _fnCamelToHungarian(src,user,force){src._hungarianMap||_fnHungarianMap(src);var hungarianKey;$.each(user,function(key,val){hungarianKey=src._hungarianMap[key],hungarianKey===undefined||!force&&user[hungarianKey]!==undefined||("o"===hungarianKey.charAt(0)?(user[hungarianKey]||(user[hungarianKey]={}),$.extend(!0,user[hungarianKey],user[key]),_fnCamelToHungarian(src[hungarianKey],user[hungarianKey],force)):user[hungarianKey]=user[key])})}function _fnLanguageCompat(lang){var defaults=DataTable.defaults.oLanguage,zeroRecords=lang.sZeroRecords;!lang.sEmptyTable&&zeroRecords&&"No data available in table"===defaults.sEmptyTable&&_fnMap(lang,lang,"sZeroRecords","sEmptyTable"),!lang.sLoadingRecords&&zeroRecords&&"Loading..."===defaults.sLoadingRecords&&_fnMap(lang,lang,"sZeroRecords","sLoadingRecords"),lang.sInfoThousands&&(lang.sThousands=lang.sInfoThousands);var decimal=lang.sDecimal;decimal&&_addNumericSort(decimal)}function _fnCompatOpts(init){_fnCompatMap(init,"ordering","bSort"),_fnCompatMap(init,"orderMulti","bSortMulti"),_fnCompatMap(init,"orderClasses","bSortClasses"),_fnCompatMap(init,"orderCellsTop","bSortCellsTop"),_fnCompatMap(init,"order","aaSorting"),_fnCompatMap(init,"orderFixed","aaSortingFixed"),_fnCompatMap(init,"paging","bPaginate"),_fnCompatMap(init,"pagingType","sPaginationType"),_fnCompatMap(init,"pageLength","iDisplayLength"),_fnCompatMap(init,"searching","bFilter");var searchCols=init.aoSearchCols;if(searchCols)for(var i=0,ien=searchCols.length;ien>i;i++)searchCols[i]&&_fnCamelToHungarian(DataTable.models.oSearch,searchCols[i])}function _fnCompatCols(init){_fnCompatMap(init,"orderable","bSortable"),_fnCompatMap(init,"orderData","aDataSort"),_fnCompatMap(init,"orderSequence","asSorting"),_fnCompatMap(init,"orderDataType","sortDataType");var dataSort=init.aDataSort;dataSort&&!$.isArray(dataSort)&&(init.aDataSort=[dataSort])}function _fnBrowserDetect(settings){var browser=settings.oBrowser,n=$("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append($("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append($('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),test=n.find(".test");browser.bScrollOversize=100===test[0].offsetWidth,browser.bScrollbarLeft=1!==Math.round(test.offset().left),n.remove()}function _fnReduce(that,fn,init,start,end,inc){var value,i=start,isSet=!1;for(init!==undefined&&(value=init,isSet=!0);i!==end;)that.hasOwnProperty(i)&&(value=isSet?fn(value,that[i],i,that):that[i],isSet=!0,i+=inc);return value}function _fnAddColumn(oSettings,nTh){var oDefaults=DataTable.defaults.column,iCol=oSettings.aoColumns.length,oCol=$.extend({},DataTable.models.oColumn,oDefaults,{nTh:nTh?nTh:document.createElement("th"),sTitle:oDefaults.sTitle?oDefaults.sTitle:nTh?nTh.innerHTML:"",aDataSort:oDefaults.aDataSort?oDefaults.aDataSort:[iCol],mData:oDefaults.mData?oDefaults.mData:iCol,idx:iCol});oSettings.aoColumns.push(oCol);var searchCols=oSettings.aoPreSearchCols;searchCols[iCol]=$.extend({},DataTable.models.oSearch,searchCols[iCol]),_fnColumnOptions(oSettings,iCol,$(nTh).data())}function _fnColumnOptions(oSettings,iCol,oOptions){var oCol=oSettings.aoColumns[iCol],oClasses=oSettings.oClasses,th=$(oCol.nTh);if(!oCol.sWidthOrig){oCol.sWidthOrig=th.attr("width")||null;var t=(th.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);t&&(oCol.sWidthOrig=t[1])}oOptions!==undefined&&null!==oOptions&&(_fnCompatCols(oOptions),_fnCamelToHungarian(DataTable.defaults.column,oOptions),oOptions.mDataProp===undefined||oOptions.mData||(oOptions.mData=oOptions.mDataProp),oOptions.sType&&(oCol._sManualType=oOptions.sType),oOptions.className&&!oOptions.sClass&&(oOptions.sClass=oOptions.className),$.extend(oCol,oOptions),_fnMap(oCol,oOptions,"sWidth","sWidthOrig"),oOptions.iDataSort!==undefined&&(oCol.aDataSort=[oOptions.iDataSort]),_fnMap(oCol,oOptions,"aDataSort"));var mDataSrc=oCol.mData,mData=_fnGetObjectDataFn(mDataSrc),mRender=oCol.mRender?_fnGetObjectDataFn(oCol.mRender):null,attrTest=function(src){return"string"==typeof src&&-1!==src.indexOf("@")};oCol._bAttrSrc=$.isPlainObject(mDataSrc)&&(attrTest(mDataSrc.sort)||attrTest(mDataSrc.type)||attrTest(mDataSrc.filter)),oCol.fnGetData=function(rowData,type,meta){var innerData=mData(rowData,type,undefined,meta);return mRender&&type?mRender(innerData,type,rowData,meta):innerData},oCol.fnSetData=function(rowData,val,meta){return _fnSetObjectDataFn(mDataSrc)(rowData,val,meta)},"number"!=typeof mDataSrc&&(oSettings._rowReadObject=!0),oSettings.oFeatures.bSort||(oCol.bSortable=!1,th.addClass(oClasses.sSortableNone));var bAsc=-1!==$.inArray("asc",oCol.asSorting),bDesc=-1!==$.inArray("desc",oCol.asSorting);oCol.bSortable&&(bAsc||bDesc)?bAsc&&!bDesc?(oCol.sSortingClass=oClasses.sSortableAsc,oCol.sSortingClassJUI=oClasses.sSortJUIAscAllowed):!bAsc&&bDesc?(oCol.sSortingClass=oClasses.sSortableDesc,oCol.sSortingClassJUI=oClasses.sSortJUIDescAllowed):(oCol.sSortingClass=oClasses.sSortable,oCol.sSortingClassJUI=oClasses.sSortJUI):(oCol.sSortingClass=oClasses.sSortableNone,oCol.sSortingClassJUI="")}function _fnAdjustColumnSizing(settings){if(settings.oFeatures.bAutoWidth!==!1){var columns=settings.aoColumns;_fnCalculateColumnWidths(settings);for(var i=0,iLen=columns.length;iLen>i;i++)columns[i].nTh.style.width=columns[i].sWidth}var scroll=settings.oScroll;(""!==scroll.sY||""!==scroll.sX)&&_fnScrollDraw(settings),_fnCallbackFire(settings,null,"column-sizing",[settings])}function _fnVisibleToColumnIndex(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible");return"number"==typeof aiVis[iMatch]?aiVis[iMatch]:null}function _fnColumnIndexToVisible(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible"),iPos=$.inArray(iMatch,aiVis);return-1!==iPos?iPos:null}function _fnVisbleColumns(oSettings){return _fnGetColumns(oSettings,"bVisible").length}function _fnGetColumns(oSettings,sParam){var a=[];return $.map(oSettings.aoColumns,function(val,i){val[sParam]&&a.push(i)}),a}function _fnColumnTypes(settings){var i,ien,j,jen,k,ken,col,detectedType,cache,columns=settings.aoColumns,data=settings.aoData,types=DataTable.ext.type.detect;for(i=0,ien=columns.length;ien>i;i++)if(col=columns[i],cache=[],!col.sType&&col._sManualType)col.sType=col._sManualType;else if(!col.sType){for(j=0,jen=types.length;jen>j;j++){for(k=0,ken=data.length;ken>k&&(cache[k]===undefined&&(cache[k]=_fnGetCellData(settings,k,i,"type")),detectedType=types[j](cache[k],settings),detectedType||j===types.length-1)&&"html"!==detectedType;k++);if(detectedType){col.sType=detectedType;break}}col.sType||(col.sType="string")}}function _fnApplyColumnDefs(oSettings,aoColDefs,aoCols,fn){var i,iLen,j,jLen,k,kLen,def,columns=oSettings.aoColumns;if(aoColDefs)for(i=aoColDefs.length-1;i>=0;i--){def=aoColDefs[i];var aTargets=def.targets!==undefined?def.targets:def.aTargets;for($.isArray(aTargets)||(aTargets=[aTargets]),j=0,jLen=aTargets.length;jLen>j;j++)if("number"==typeof aTargets[j]&&aTargets[j]>=0){for(;columns.length<=aTargets[j];)_fnAddColumn(oSettings);fn(aTargets[j],def)}else if("number"==typeof aTargets[j]&&aTargets[j]<0)fn(columns.length+aTargets[j],def);else if("string"==typeof aTargets[j])for(k=0,kLen=columns.length;kLen>k;k++)("_all"==aTargets[j]||$(columns[k].nTh).hasClass(aTargets[j]))&&fn(k,def)}if(aoCols)for(i=0,iLen=aoCols.length;iLen>i;i++)fn(i,aoCols[i])}function _fnAddData(oSettings,aDataIn,nTr,anTds){var iRow=oSettings.aoData.length,oData=$.extend(!0,{},DataTable.models.oRow,{src:nTr?"dom":"data"});oData._aData=aDataIn,oSettings.aoData.push(oData);for(var columns=oSettings.aoColumns,i=0,iLen=columns.length;iLen>i;i++)nTr&&_fnSetCellData(oSettings,iRow,i,_fnGetCellData(oSettings,iRow,i)),columns[i].sType=null;return oSettings.aiDisplayMaster.push(iRow),(nTr||!oSettings.oFeatures.bDeferRender)&&_fnCreateTr(oSettings,iRow,nTr,anTds),iRow}function _fnAddTr(settings,trs){var row;return trs instanceof $||(trs=$(trs)),trs.map(function(i,el){return row=_fnGetRowElements(settings,el),_fnAddData(settings,row.data,el,row.cells)})}function _fnNodeToDataIndex(oSettings,n){return n._DT_RowIndex!==undefined?n._DT_RowIndex:null}function _fnNodeToColumnIndex(oSettings,iRow,n){return $.inArray(n,oSettings.aoData[iRow].anCells)}function _fnGetCellData(settings,rowIdx,colIdx,type){var draw=settings.iDraw,col=settings.aoColumns[colIdx],rowData=settings.aoData[rowIdx]._aData,defaultContent=col.sDefaultContent,cellData=col.fnGetData(rowData,type,{settings:settings,row:rowIdx,col:colIdx});if(cellData===undefined)return settings.iDrawError!=draw&&null===defaultContent&&(_fnLog(settings,0,"Requested unknown parameter "+("function"==typeof col.mData?"{function}":"'"+col.mData+"'")+" for row "+rowIdx,4),settings.iDrawError=draw),defaultContent;if(cellData!==rowData&&null!==cellData||null===defaultContent){if("function"==typeof cellData)return cellData.call(rowData)}else cellData=defaultContent;return null===cellData&&"display"==type?"":cellData}function _fnSetCellData(settings,rowIdx,colIdx,val){var col=settings.aoColumns[colIdx],rowData=settings.aoData[rowIdx]._aData;col.fnSetData(rowData,val,{settings:settings,row:rowIdx,col:colIdx})}function _fnSplitObjNotation(str){return $.map(str.match(/(\\.|[^\.])+/g),function(s){return s.replace(/\\./g,".")})}function _fnGetObjectDataFn(mSource){if($.isPlainObject(mSource)){var o={};return $.each(mSource,function(key,val){val&&(o[key]=_fnGetObjectDataFn(val))}),function(data,type,row,meta){var t=o[type]||o._;return t!==undefined?t(data,type,row,meta):data}}if(null===mSource)return function(data){return data};if("function"==typeof mSource)return function(data,type,row,meta){return mSource(data,type,row,meta)};if("string"!=typeof mSource||-1===mSource.indexOf(".")&&-1===mSource.indexOf("[")&&-1===mSource.indexOf("("))return function(data,type){return data[mSource]};var fetchData=function(data,type,src){var arrayNotation,funcNotation,out,innerSrc;if(""!==src)for(var a=_fnSplitObjNotation(src),i=0,iLen=a.length;iLen>i;i++){if(arrayNotation=a[i].match(__reArray),funcNotation=a[i].match(__reFn),arrayNotation){a[i]=a[i].replace(__reArray,""),""!==a[i]&&(data=data[a[i]]),out=[],a.splice(0,i+1),innerSrc=a.join(".");for(var j=0,jLen=data.length;jLen>j;j++)out.push(fetchData(data[j],type,innerSrc));var join=arrayNotation[0].substring(1,arrayNotation[0].length-1);data=""===join?out:out.join(join);break}if(funcNotation)a[i]=a[i].replace(__reFn,""),data=data[a[i]]();else{if(null===data||data[a[i]]===undefined)return undefined;data=data[a[i]]}}return data};return function(data,type){return fetchData(data,type,mSource)}}function _fnSetObjectDataFn(mSource){if($.isPlainObject(mSource))return _fnSetObjectDataFn(mSource._);if(null===mSource)return function(){};if("function"==typeof mSource)return function(data,val,meta){mSource(data,"set",val,meta)};if("string"!=typeof mSource||-1===mSource.indexOf(".")&&-1===mSource.indexOf("[")&&-1===mSource.indexOf("("))return function(data,val){data[mSource]=val};var setData=function(data,val,src){for(var b,arrayNotation,funcNotation,o,innerSrc,a=_fnSplitObjNotation(src),aLast=a[a.length-1],i=0,iLen=a.length-1;iLen>i;i++){if(arrayNotation=a[i].match(__reArray),funcNotation=a[i].match(__reFn),arrayNotation){a[i]=a[i].replace(__reArray,""),data[a[i]]=[],b=a.slice(),b.splice(0,i+1),innerSrc=b.join(".");for(var j=0,jLen=val.length;jLen>j;j++)o={},setData(o,val[j],innerSrc),data[a[i]].push(o);return}funcNotation&&(a[i]=a[i].replace(__reFn,""),data=data[a[i]](val)),(null===data[a[i]]||data[a[i]]===undefined)&&(data[a[i]]={}),data=data[a[i]]}aLast.match(__reFn)?data=data[aLast.replace(__reFn,"")](val):data[aLast.replace(__reArray,"")]=val};return function(data,val){return setData(data,val,mSource)}}function _fnGetDataMaster(settings){return _pluck(settings.aoData,"_aData")}function _fnClearTable(settings){settings.aoData.length=0,settings.aiDisplayMaster.length=0,settings.aiDisplay.length=0}function _fnDeleteIndex(a,iTarget,splice){for(var iTargetIndex=-1,i=0,iLen=a.length;iLen>i;i++)a[i]==iTarget?iTargetIndex=i:a[i]>iTarget&&a[i]--;-1!=iTargetIndex&&splice===undefined&&a.splice(iTargetIndex,1)}function _fnInvalidate(settings,rowIdx,src,colIdx){var i,ien,row=settings.aoData[rowIdx],cellWrite=function(cell,col){for(;cell.childNodes.length;)cell.removeChild(cell.firstChild);cell.innerHTML=_fnGetCellData(settings,rowIdx,col,"display")};if("dom"!==src&&(src&&"auto"!==src||"dom"!==row.src)){var cells=row.anCells;if(cells)if(colIdx!==undefined)cellWrite(cells[colIdx],colIdx);else for(i=0,ien=cells.length;ien>i;i++)cellWrite(cells[i],i)}else row._aData=_fnGetRowElements(settings,row,colIdx,colIdx===undefined?undefined:row._aData).data;row._aSortData=null,row._aFilterData=null;var cols=settings.aoColumns;if(colIdx!==undefined)cols[colIdx].sType=null;else{for(i=0,ien=cols.length;ien>i;i++)cols[i].sType=null;_fnRowAttributes(row)}}function _fnGetRowElements(settings,row,colIdx,d){var name,col,contents,tds=[],td=row.firstChild,i=0,columns=settings.aoColumns,objectRead=settings._rowReadObject;d=d||objectRead?{}:[];var attr=function(str,td){if("string"==typeof str){var idx=str.indexOf("@");if(-1!==idx){var attr=str.substring(idx+1),setter=_fnSetObjectDataFn(str);setter(d,td.getAttribute(attr))}}},cellProcess=function(cell){if(colIdx===undefined||colIdx===i)if(col=columns[i],contents=$.trim(cell.innerHTML),col&&col._bAttrSrc){var setter=_fnSetObjectDataFn(col.mData._);setter(d,contents),attr(col.mData.sort,cell),attr(col.mData.type,cell),
attr(col.mData.filter,cell)}else objectRead?(col._setter||(col._setter=_fnSetObjectDataFn(col.mData)),col._setter(d,contents)):d[i]=contents;i++};if(td)for(;td;)name=td.nodeName.toUpperCase(),("TD"==name||"TH"==name)&&(cellProcess(td),tds.push(td)),td=td.nextSibling;else{tds=row.anCells;for(var j=0,jen=tds.length;jen>j;j++)cellProcess(tds[j])}return{data:d,cells:tds}}function _fnCreateTr(oSettings,iRow,nTrIn,anTds){var nTr,nTd,oCol,i,iLen,row=oSettings.aoData[iRow],rowData=row._aData,cells=[];if(null===row.nTr){for(nTr=nTrIn||document.createElement("tr"),row.nTr=nTr,row.anCells=cells,nTr._DT_RowIndex=iRow,_fnRowAttributes(row),i=0,iLen=oSettings.aoColumns.length;iLen>i;i++)oCol=oSettings.aoColumns[i],nTd=nTrIn?anTds[i]:document.createElement(oCol.sCellType),cells.push(nTd),(!nTrIn||oCol.mRender||oCol.mData!==i)&&(nTd.innerHTML=_fnGetCellData(oSettings,iRow,i,"display")),oCol.sClass&&(nTd.className+=" "+oCol.sClass),oCol.bVisible&&!nTrIn?nTr.appendChild(nTd):!oCol.bVisible&&nTrIn&&nTd.parentNode.removeChild(nTd),oCol.fnCreatedCell&&oCol.fnCreatedCell.call(oSettings.oInstance,nTd,_fnGetCellData(oSettings,iRow,i),rowData,iRow,i);_fnCallbackFire(oSettings,"aoRowCreatedCallback",null,[nTr,rowData,iRow])}row.nTr.setAttribute("role","row")}function _fnRowAttributes(row){var tr=row.nTr,data=row._aData;if(tr){if(data.DT_RowId&&(tr.id=data.DT_RowId),data.DT_RowClass){var a=data.DT_RowClass.split(" ");row.__rowc=row.__rowc?_unique(row.__rowc.concat(a)):a,$(tr).removeClass(row.__rowc.join(" ")).addClass(data.DT_RowClass)}data.DT_RowAttr&&$(tr).attr(data.DT_RowAttr),data.DT_RowData&&$(tr).data(data.DT_RowData)}}function _fnBuildHead(oSettings){var i,ien,cell,row,column,thead=oSettings.nTHead,tfoot=oSettings.nTFoot,createHeader=0===$("th, td",thead).length,classes=oSettings.oClasses,columns=oSettings.aoColumns;for(createHeader&&(row=$("<tr/>").appendTo(thead)),i=0,ien=columns.length;ien>i;i++)column=columns[i],cell=$(column.nTh).addClass(column.sClass),createHeader&&cell.appendTo(row),oSettings.oFeatures.bSort&&(cell.addClass(column.sSortingClass),column.bSortable!==!1&&(cell.attr("tabindex",oSettings.iTabIndex).attr("aria-controls",oSettings.sTableId),_fnSortAttachListener(oSettings,column.nTh,i))),column.sTitle!=cell.html()&&cell.html(column.sTitle),_fnRenderer(oSettings,"header")(oSettings,cell,column,classes);if(createHeader&&_fnDetectHeader(oSettings.aoHeader,thead),$(thead).find(">tr").attr("role","row"),$(thead).find(">tr>th, >tr>td").addClass(classes.sHeaderTH),$(tfoot).find(">tr>th, >tr>td").addClass(classes.sFooterTH),null!==tfoot){var cells=oSettings.aoFooter[0];for(i=0,ien=cells.length;ien>i;i++)column=columns[i],column.nTf=cells[i].cell,column.sClass&&$(column.nTf).addClass(column.sClass)}}function _fnDrawHead(oSettings,aoSource,bIncludeHidden){var i,iLen,j,jLen,k,n,nLocalTr,iRowspan,iColspan,aoLocal=[],aApplied=[],iColumns=oSettings.aoColumns.length;if(aoSource){for(bIncludeHidden===undefined&&(bIncludeHidden=!1),i=0,iLen=aoSource.length;iLen>i;i++){for(aoLocal[i]=aoSource[i].slice(),aoLocal[i].nTr=aoSource[i].nTr,j=iColumns-1;j>=0;j--)oSettings.aoColumns[j].bVisible||bIncludeHidden||aoLocal[i].splice(j,1);aApplied.push([])}for(i=0,iLen=aoLocal.length;iLen>i;i++){if(nLocalTr=aoLocal[i].nTr)for(;n=nLocalTr.firstChild;)nLocalTr.removeChild(n);for(j=0,jLen=aoLocal[i].length;jLen>j;j++)if(iRowspan=1,iColspan=1,aApplied[i][j]===undefined){for(nLocalTr.appendChild(aoLocal[i][j].cell),aApplied[i][j]=1;aoLocal[i+iRowspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i+iRowspan][j].cell;)aApplied[i+iRowspan][j]=1,iRowspan++;for(;aoLocal[i][j+iColspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i][j+iColspan].cell;){for(k=0;iRowspan>k;k++)aApplied[i+k][j+iColspan]=1;iColspan++}$(aoLocal[i][j].cell).attr("rowspan",iRowspan).attr("colspan",iColspan)}}}}function _fnDraw(oSettings){var aPreDraw=_fnCallbackFire(oSettings,"aoPreDrawCallback","preDraw",[oSettings]);if(-1!==$.inArray(!1,aPreDraw))return void _fnProcessingDisplay(oSettings,!1);var anRows=[],iRowCount=0,asStripeClasses=oSettings.asStripeClasses,iStripes=asStripeClasses.length,oLang=(oSettings.aoOpenRows.length,oSettings.oLanguage),iInitDisplayStart=oSettings.iInitDisplayStart,bServerSide="ssp"==_fnDataSource(oSettings),aiDisplay=oSettings.aiDisplay;oSettings.bDrawing=!0,iInitDisplayStart!==undefined&&-1!==iInitDisplayStart&&(oSettings._iDisplayStart=bServerSide?iInitDisplayStart:iInitDisplayStart>=oSettings.fnRecordsDisplay()?0:iInitDisplayStart,oSettings.iInitDisplayStart=-1);var iDisplayStart=oSettings._iDisplayStart,iDisplayEnd=oSettings.fnDisplayEnd();if(oSettings.bDeferLoading)oSettings.bDeferLoading=!1,oSettings.iDraw++,_fnProcessingDisplay(oSettings,!1);else if(bServerSide){if(!oSettings.bDestroying&&!_fnAjaxUpdate(oSettings))return}else oSettings.iDraw++;if(0!==aiDisplay.length)for(var iStart=bServerSide?0:iDisplayStart,iEnd=bServerSide?oSettings.aoData.length:iDisplayEnd,j=iStart;iEnd>j;j++){var iDataIndex=aiDisplay[j],aoData=oSettings.aoData[iDataIndex];null===aoData.nTr&&_fnCreateTr(oSettings,iDataIndex);var nRow=aoData.nTr;if(0!==iStripes){var sStripe=asStripeClasses[iRowCount%iStripes];aoData._sRowStripe!=sStripe&&($(nRow).removeClass(aoData._sRowStripe).addClass(sStripe),aoData._sRowStripe=sStripe)}_fnCallbackFire(oSettings,"aoRowCallback",null,[nRow,aoData._aData,iRowCount,j]),anRows.push(nRow),iRowCount++}else{var sZero=oLang.sZeroRecords;1==oSettings.iDraw&&"ajax"==_fnDataSource(oSettings)?sZero=oLang.sLoadingRecords:oLang.sEmptyTable&&0===oSettings.fnRecordsTotal()&&(sZero=oLang.sEmptyTable),anRows[0]=$("<tr/>",{"class":iStripes?asStripeClasses[0]:""}).append($("<td />",{valign:"top",colSpan:_fnVisbleColumns(oSettings),"class":oSettings.oClasses.sRowEmpty}).html(sZero))[0]}_fnCallbackFire(oSettings,"aoHeaderCallback","header",[$(oSettings.nTHead).children("tr")[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]),_fnCallbackFire(oSettings,"aoFooterCallback","footer",[$(oSettings.nTFoot).children("tr")[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]);var body=$(oSettings.nTBody);body.children().detach(),body.append($(anRows)),_fnCallbackFire(oSettings,"aoDrawCallback","draw",[oSettings]),oSettings.bSorted=!1,oSettings.bFiltered=!1,oSettings.bDrawing=!1}function _fnReDraw(settings,holdPosition){var features=settings.oFeatures,sort=features.bSort,filter=features.bFilter;sort&&_fnSort(settings),filter?_fnFilterComplete(settings,settings.oPreviousSearch):settings.aiDisplay=settings.aiDisplayMaster.slice(),holdPosition!==!0&&(settings._iDisplayStart=0),settings._drawHold=holdPosition,_fnDraw(settings),settings._drawHold=!1}function _fnAddOptionsHtml(oSettings){var classes=oSettings.oClasses,table=$(oSettings.nTable),holding=$("<div/>").insertBefore(table),features=oSettings.oFeatures,insert=$("<div/>",{id:oSettings.sTableId+"_wrapper","class":classes.sWrapper+(oSettings.nTFoot?"":" "+classes.sNoFooter)});oSettings.nHolding=holding[0],oSettings.nTableWrapper=insert[0],oSettings.nTableReinsertBefore=oSettings.nTable.nextSibling;for(var featureNode,cOption,nNewNode,cNext,sAttr,j,aDom=oSettings.sDom.split(""),i=0;i<aDom.length;i++){if(featureNode=null,cOption=aDom[i],"<"==cOption){if(nNewNode=$("<div/>")[0],cNext=aDom[i+1],"'"==cNext||'"'==cNext){for(sAttr="",j=2;aDom[i+j]!=cNext;)sAttr+=aDom[i+j],j++;if("H"==sAttr?sAttr=classes.sJUIHeader:"F"==sAttr&&(sAttr=classes.sJUIFooter),-1!=sAttr.indexOf(".")){var aSplit=sAttr.split(".");nNewNode.id=aSplit[0].substr(1,aSplit[0].length-1),nNewNode.className=aSplit[1]}else"#"==sAttr.charAt(0)?nNewNode.id=sAttr.substr(1,sAttr.length-1):nNewNode.className=sAttr;i+=j}insert.append(nNewNode),insert=$(nNewNode)}else if(">"==cOption)insert=insert.parent();else if("l"==cOption&&features.bPaginate&&features.bLengthChange)featureNode=_fnFeatureHtmlLength(oSettings);else if("f"==cOption&&features.bFilter)featureNode=_fnFeatureHtmlFilter(oSettings);else if("r"==cOption&&features.bProcessing)featureNode=_fnFeatureHtmlProcessing(oSettings);else if("t"==cOption)featureNode=_fnFeatureHtmlTable(oSettings);else if("i"==cOption&&features.bInfo)featureNode=_fnFeatureHtmlInfo(oSettings);else if("p"==cOption&&features.bPaginate)featureNode=_fnFeatureHtmlPaginate(oSettings);else if(0!==DataTable.ext.feature.length)for(var aoFeatures=DataTable.ext.feature,k=0,kLen=aoFeatures.length;kLen>k;k++)if(cOption==aoFeatures[k].cFeature){featureNode=aoFeatures[k].fnInit(oSettings);break}if(featureNode){var aanFeatures=oSettings.aanFeatures;aanFeatures[cOption]||(aanFeatures[cOption]=[]),aanFeatures[cOption].push(featureNode),insert.append(featureNode)}}holding.replaceWith(insert)}function _fnDetectHeader(aLayout,nThead){var nTr,nCell,i,k,l,iLen,iColShifted,iColumn,iColspan,iRowspan,bUnique,nTrs=$(nThead).children("tr"),fnShiftCol=function(a,i,j){for(var k=a[i];k[j];)j++;return j};for(aLayout.splice(0,aLayout.length),i=0,iLen=nTrs.length;iLen>i;i++)aLayout.push([]);for(i=0,iLen=nTrs.length;iLen>i;i++)for(nTr=nTrs[i],iColumn=0,nCell=nTr.firstChild;nCell;){if("TD"==nCell.nodeName.toUpperCase()||"TH"==nCell.nodeName.toUpperCase())for(iColspan=1*nCell.getAttribute("colspan"),iRowspan=1*nCell.getAttribute("rowspan"),iColspan=iColspan&&0!==iColspan&&1!==iColspan?iColspan:1,iRowspan=iRowspan&&0!==iRowspan&&1!==iRowspan?iRowspan:1,iColShifted=fnShiftCol(aLayout,i,iColumn),bUnique=1===iColspan?!0:!1,l=0;iColspan>l;l++)for(k=0;iRowspan>k;k++)aLayout[i+k][iColShifted+l]={cell:nCell,unique:bUnique},aLayout[i+k].nTr=nTr;nCell=nCell.nextSibling}}function _fnGetUniqueThs(oSettings,nHeader,aLayout){var aReturn=[];aLayout||(aLayout=oSettings.aoHeader,nHeader&&(aLayout=[],_fnDetectHeader(aLayout,nHeader)));for(var i=0,iLen=aLayout.length;iLen>i;i++)for(var j=0,jLen=aLayout[i].length;jLen>j;j++)!aLayout[i][j].unique||aReturn[j]&&oSettings.bSortCellsTop||(aReturn[j]=aLayout[i][j].cell);return aReturn}function _fnBuildAjax(oSettings,data,fn){if(_fnCallbackFire(oSettings,"aoServerParams","serverParams",[data]),data&&$.isArray(data)){var tmp={},rbracket=/(.*?)\[\]$/;$.each(data,function(key,val){var match=val.name.match(rbracket);if(match){var name=match[0];tmp[name]||(tmp[name]=[]),tmp[name].push(val.value)}else tmp[val.name]=val.value}),data=tmp}var ajaxData,ajax=oSettings.ajax,instance=oSettings.oInstance,callback=function(json){_fnCallbackFire(oSettings,null,"xhr",[oSettings,json]),fn(json)};if($.isPlainObject(ajax)&&ajax.data){ajaxData=ajax.data;var newData=$.isFunction(ajaxData)?ajaxData(data,oSettings):ajaxData;data=$.isFunction(ajaxData)&&newData?newData:$.extend(!0,data,newData),delete ajax.data}var baseAjax={data:data,success:function(json){var error=json.error||json.sError;error&&oSettings.oApi._fnLog(oSettings,0,error),oSettings.json=json,callback(json)},dataType:"json",cache:!1,type:oSettings.sServerMethod,error:function(xhr,error,thrown){var log=oSettings.oApi._fnLog;"parsererror"==error?log(oSettings,0,"Invalid JSON response",1):4===xhr.readyState&&log(oSettings,0,"Ajax error",7),_fnProcessingDisplay(oSettings,!1)}};oSettings.oAjaxData=data,_fnCallbackFire(oSettings,null,"preXhr",[oSettings,data]),oSettings.fnServerData?oSettings.fnServerData.call(instance,oSettings.sAjaxSource,$.map(data,function(val,key){return{name:key,value:val}}),callback,oSettings):oSettings.sAjaxSource||"string"==typeof ajax?oSettings.jqXHR=$.ajax($.extend(baseAjax,{url:ajax||oSettings.sAjaxSource})):$.isFunction(ajax)?oSettings.jqXHR=ajax.call(instance,data,callback,oSettings):(oSettings.jqXHR=$.ajax($.extend(baseAjax,ajax)),ajax.data=ajaxData)}function _fnAjaxUpdate(settings){return settings.bAjaxDataGet?(settings.iDraw++,_fnProcessingDisplay(settings,!0),_fnBuildAjax(settings,_fnAjaxParameters(settings),function(json){_fnAjaxUpdateDraw(settings,json)}),!1):!0}function _fnAjaxParameters(settings){var i,dataProp,column,columnSearch,columns=settings.aoColumns,columnCount=columns.length,features=settings.oFeatures,preSearch=settings.oPreviousSearch,preColSearch=settings.aoPreSearchCols,data=[],sort=_fnSortFlatten(settings),displayStart=settings._iDisplayStart,displayLength=features.bPaginate!==!1?settings._iDisplayLength:-1,param=function(name,value){data.push({name:name,value:value})};param("sEcho",settings.iDraw),param("iColumns",columnCount),param("sColumns",_pluck(columns,"sName").join(",")),param("iDisplayStart",displayStart),param("iDisplayLength",displayLength);var d={draw:settings.iDraw,columns:[],order:[],start:displayStart,length:displayLength,search:{value:preSearch.sSearch,regex:preSearch.bRegex}};for(i=0;columnCount>i;i++)column=columns[i],columnSearch=preColSearch[i],dataProp="function"==typeof column.mData?"function":column.mData,d.columns.push({data:dataProp,name:column.sName,searchable:column.bSearchable,orderable:column.bSortable,search:{value:columnSearch.sSearch,regex:columnSearch.bRegex}}),param("mDataProp_"+i,dataProp),features.bFilter&&(param("sSearch_"+i,columnSearch.sSearch),param("bRegex_"+i,columnSearch.bRegex),param("bSearchable_"+i,column.bSearchable)),features.bSort&&param("bSortable_"+i,column.bSortable);features.bFilter&&(param("sSearch",preSearch.sSearch),param("bRegex",preSearch.bRegex)),features.bSort&&($.each(sort,function(i,val){d.order.push({column:val.col,dir:val.dir}),param("iSortCol_"+i,val.col),param("sSortDir_"+i,val.dir)}),param("iSortingCols",sort.length));var legacy=DataTable.ext.legacy.ajax;return null===legacy?settings.sAjaxSource?data:d:legacy?data:d}function _fnAjaxUpdateDraw(settings,json){var compat=function(old,modern){return json[old]!==undefined?json[old]:json[modern]},data=_fnAjaxDataSrc(settings,json),draw=compat("sEcho","draw"),recordsTotal=compat("iTotalRecords","recordsTotal"),recordsFiltered=compat("iTotalDisplayRecords","recordsFiltered");if(draw){if(1*draw<settings.iDraw)return;settings.iDraw=1*draw}_fnClearTable(settings),settings._iRecordsTotal=parseInt(recordsTotal,10),settings._iRecordsDisplay=parseInt(recordsFiltered,10);for(var i=0,ien=data.length;ien>i;i++)_fnAddData(settings,data[i]);settings.aiDisplay=settings.aiDisplayMaster.slice(),settings.bAjaxDataGet=!1,_fnDraw(settings),settings._bInitComplete||_fnInitComplete(settings,json),settings.bAjaxDataGet=!0,_fnProcessingDisplay(settings,!1)}function _fnAjaxDataSrc(oSettings,json){var dataSrc=$.isPlainObject(oSettings.ajax)&&oSettings.ajax.dataSrc!==undefined?oSettings.ajax.dataSrc:oSettings.sAjaxDataProp;return"data"===dataSrc?json.aaData||json[dataSrc]:""!==dataSrc?_fnGetObjectDataFn(dataSrc)(json):json}function _fnFeatureHtmlFilter(settings){var classes=settings.oClasses,tableId=settings.sTableId,language=settings.oLanguage,previousSearch=settings.oPreviousSearch,features=settings.aanFeatures,input='<input type="search" class="'+classes.sFilterInput+'"/>',str=language.sSearch;str=str.match(/_INPUT_/)?str.replace("_INPUT_",input):str+input;var filter=$("<div/>",{id:features.f?null:tableId+"_filter","class":classes.sFilter}).append($("<label/>").append(str)),searchFn=function(){var val=(features.f,this.value?this.value:"");val!=previousSearch.sSearch&&(_fnFilterComplete(settings,{sSearch:val,bRegex:previousSearch.bRegex,bSmart:previousSearch.bSmart,bCaseInsensitive:previousSearch.bCaseInsensitive}),settings._iDisplayStart=0,_fnDraw(settings))},searchDelay=null!==settings.searchDelay?settings.searchDelay:"ssp"===_fnDataSource(settings)?400:0,jqFilter=$("input",filter).val(previousSearch.sSearch).attr("placeholder",language.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",searchDelay?_fnThrottle(searchFn,searchDelay):searchFn).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}).attr("aria-controls",tableId);return $(settings.nTable).on("search.dt.DT",function(ev,s){if(settings===s)try{jqFilter[0]!==document.activeElement&&jqFilter.val(previousSearch.sSearch)}catch(e){}}),filter[0]}function _fnFilterComplete(oSettings,oInput,iForce){var oPrevSearch=oSettings.oPreviousSearch,aoPrevSearch=oSettings.aoPreSearchCols,fnSaveFilter=function(oFilter){oPrevSearch.sSearch=oFilter.sSearch,oPrevSearch.bRegex=oFilter.bRegex,oPrevSearch.bSmart=oFilter.bSmart,oPrevSearch.bCaseInsensitive=oFilter.bCaseInsensitive},fnRegex=function(o){return o.bEscapeRegex!==undefined?!o.bEscapeRegex:o.bRegex};if(_fnColumnTypes(oSettings),"ssp"!=_fnDataSource(oSettings)){_fnFilter(oSettings,oInput.sSearch,iForce,fnRegex(oInput),oInput.bSmart,oInput.bCaseInsensitive),fnSaveFilter(oInput);for(var i=0;i<aoPrevSearch.length;i++)_fnFilterColumn(oSettings,aoPrevSearch[i].sSearch,i,fnRegex(aoPrevSearch[i]),aoPrevSearch[i].bSmart,aoPrevSearch[i].bCaseInsensitive);_fnFilterCustom(oSettings)}else fnSaveFilter(oInput);oSettings.bFiltered=!0,_fnCallbackFire(oSettings,null,"search",[oSettings])}function _fnFilterCustom(settings){for(var row,rowIdx,filters=DataTable.ext.search,displayRows=settings.aiDisplay,i=0,ien=filters.length;ien>i;i++){for(var rows=[],j=0,jen=displayRows.length;jen>j;j++)rowIdx=displayRows[j],row=settings.aoData[rowIdx],filters[i](settings,row._aFilterData,rowIdx,row._aData,j)&&rows.push(rowIdx);displayRows.length=0,displayRows.push.apply(displayRows,rows)}}function _fnFilterColumn(settings,searchStr,colIdx,regex,smart,caseInsensitive){if(""!==searchStr)for(var data,display=settings.aiDisplay,rpSearch=_fnFilterCreateSearch(searchStr,regex,smart,caseInsensitive),i=display.length-1;i>=0;i--)data=settings.aoData[display[i]]._aFilterData[colIdx],rpSearch.test(data)||display.splice(i,1)}function _fnFilter(settings,input,force,regex,smart,caseInsensitive){var display,invalidated,i,rpSearch=_fnFilterCreateSearch(input,regex,smart,caseInsensitive),prevSearch=settings.oPreviousSearch.sSearch,displayMaster=settings.aiDisplayMaster;if(0!==DataTable.ext.search.length&&(force=!0),invalidated=_fnFilterData(settings),input.length<=0)settings.aiDisplay=displayMaster.slice();else for((invalidated||force||prevSearch.length>input.length||0!==input.indexOf(prevSearch)||settings.bSorted)&&(settings.aiDisplay=displayMaster.slice()),display=settings.aiDisplay,i=display.length-1;i>=0;i--)rpSearch.test(settings.aoData[display[i]]._sFilterRow)||display.splice(i,1)}function _fnFilterCreateSearch(search,regex,smart,caseInsensitive){if(search=regex?search:_fnEscapeRegex(search),smart){var a=$.map(search.match(/"[^"]+"|[^ ]+/g)||"",function(word){if('"'===word.charAt(0)){var m=word.match(/^"(.*)"$/);word=m?m[1]:word}return word.replace('"',"")});search="^(?=.*?"+a.join(")(?=.*?")+").*$"}return new RegExp(search,caseInsensitive?"i":"")}function _fnEscapeRegex(sVal){return sVal.replace(_re_escape_regex,"\\$1")}function _fnFilterData(settings){var column,i,j,ien,jen,filterData,cellData,row,columns=settings.aoColumns,fomatters=DataTable.ext.type.search,wasInvalidated=!1;for(i=0,ien=settings.aoData.length;ien>i;i++)if(row=settings.aoData[i],!row._aFilterData){for(filterData=[],j=0,jen=columns.length;jen>j;j++)column=columns[j],column.bSearchable?(cellData=_fnGetCellData(settings,i,j,"filter"),fomatters[column.sType]&&(cellData=fomatters[column.sType](cellData)),null===cellData&&(cellData=""),"string"!=typeof cellData&&cellData.toString&&(cellData=cellData.toString())):cellData="",cellData.indexOf&&-1!==cellData.indexOf("&")&&(__filter_div.innerHTML=cellData,cellData=__filter_div_textContent?__filter_div.textContent:__filter_div.innerText),cellData.replace&&(cellData=cellData.replace(/[\r\n]/g,"")),filterData.push(cellData);row._aFilterData=filterData,row._sFilterRow=filterData.join("  "),wasInvalidated=!0}return wasInvalidated}function _fnSearchToCamel(obj){return{search:obj.sSearch,smart:obj.bSmart,regex:obj.bRegex,caseInsensitive:obj.bCaseInsensitive}}function _fnSearchToHung(obj){return{sSearch:obj.search,bSmart:obj.smart,bRegex:obj.regex,bCaseInsensitive:obj.caseInsensitive}}function _fnFeatureHtmlInfo(settings){var tid=settings.sTableId,nodes=settings.aanFeatures.i,n=$("<div/>",{"class":settings.oClasses.sInfo,id:nodes?null:tid+"_info"});return nodes||(settings.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),n.attr("role","status").attr("aria-live","polite"),$(settings.nTable).attr("aria-describedby",tid+"_info")),n[0]}function _fnUpdateInfo(settings){var nodes=settings.aanFeatures.i;if(0!==nodes.length){var lang=settings.oLanguage,start=settings._iDisplayStart+1,end=settings.fnDisplayEnd(),max=settings.fnRecordsTotal(),total=settings.fnRecordsDisplay(),out=total?lang.sInfo:lang.sInfoEmpty;total!==max&&(out+=" "+lang.sInfoFiltered),out+=lang.sInfoPostFix,out=_fnInfoMacros(settings,out);var callback=lang.fnInfoCallback;null!==callback&&(out=callback.call(settings.oInstance,settings,start,end,max,total,out)),$(nodes).html(out)}}function _fnInfoMacros(settings,str){var formatter=settings.fnFormatNumber,start=settings._iDisplayStart+1,len=settings._iDisplayLength,vis=settings.fnRecordsDisplay(),all=-1===len;return str.replace(/_START_/g,formatter.call(settings,start)).replace(/_END_/g,formatter.call(settings,settings.fnDisplayEnd())).replace(/_MAX_/g,formatter.call(settings,settings.fnRecordsTotal())).replace(/_TOTAL_/g,formatter.call(settings,vis)).replace(/_PAGE_/g,formatter.call(settings,all?1:Math.ceil(start/len))).replace(/_PAGES_/g,formatter.call(settings,all?1:Math.ceil(vis/len)))}function _fnInitialise(settings){var i,iLen,column,iAjaxStart=settings.iInitDisplayStart,columns=settings.aoColumns,features=settings.oFeatures;if(!settings.bInitialised)return void setTimeout(function(){_fnInitialise(settings)},200);for(_fnAddOptionsHtml(settings),_fnBuildHead(settings),_fnDrawHead(settings,settings.aoHeader),_fnDrawHead(settings,settings.aoFooter),_fnProcessingDisplay(settings,!0),features.bAutoWidth&&_fnCalculateColumnWidths(settings),i=0,iLen=columns.length;iLen>i;i++)column=columns[i],column.sWidth&&(column.nTh.style.width=_fnStringToCss(column.sWidth));_fnReDraw(settings);var dataSrc=_fnDataSource(settings);"ssp"!=dataSrc&&("ajax"==dataSrc?_fnBuildAjax(settings,[],function(json){var aData=_fnAjaxDataSrc(settings,json);for(i=0;i<aData.length;i++)_fnAddData(settings,aData[i]);settings.iInitDisplayStart=iAjaxStart,_fnReDraw(settings),_fnProcessingDisplay(settings,!1),_fnInitComplete(settings,json)},settings):(_fnProcessingDisplay(settings,!1),_fnInitComplete(settings)))}function _fnInitComplete(settings,json){settings._bInitComplete=!0,json&&_fnAdjustColumnSizing(settings),_fnCallbackFire(settings,"aoInitComplete","init",[settings,json])}function _fnLengthChange(settings,val){var len=parseInt(val,10);settings._iDisplayLength=len,_fnLengthOverflow(settings),_fnCallbackFire(settings,null,"length",[settings,len])}function _fnFeatureHtmlLength(settings){for(var classes=settings.oClasses,tableId=settings.sTableId,menu=settings.aLengthMenu,d2=$.isArray(menu[0]),lengths=d2?menu[0]:menu,language=d2?menu[1]:menu,select=$("<select/>",{name:tableId+"_length","aria-controls":tableId,"class":classes.sLengthSelect}),i=0,ien=lengths.length;ien>i;i++)select[0][i]=new Option(language[i],lengths[i]);var div=$("<div><label/></div>").addClass(classes.sLength);return settings.aanFeatures.l||(div[0].id=tableId+"_length"),div.children().append(settings.oLanguage.sLengthMenu.replace("_MENU_",select[0].outerHTML)),$("select",div).val(settings._iDisplayLength).bind("change.DT",function(e){_fnLengthChange(settings,$(this).val()),_fnDraw(settings)}),$(settings.nTable).bind("length.dt.DT",function(e,s,len){settings===s&&$("select",div).val(len)}),div[0]}function _fnFeatureHtmlPaginate(settings){var type=settings.sPaginationType,plugin=DataTable.ext.pager[type],modern="function"==typeof plugin,redraw=function(settings){_fnDraw(settings)},node=$("<div/>").addClass(settings.oClasses.sPaging+type)[0],features=settings.aanFeatures;return modern||plugin.fnInit(settings,node,redraw),features.p||(node.id=settings.sTableId+"_paginate",settings.aoDrawCallback.push({fn:function(settings){if(modern){var i,ien,start=settings._iDisplayStart,len=settings._iDisplayLength,visRecords=settings.fnRecordsDisplay(),all=-1===len,page=all?0:Math.ceil(start/len),pages=all?1:Math.ceil(visRecords/len),buttons=plugin(page,pages);for(i=0,ien=features.p.length;ien>i;i++)_fnRenderer(settings,"pageButton")(settings,features.p[i],i,buttons,page,pages)}else plugin.fnUpdate(settings,redraw)},sName:"pagination"})),node}function _fnPageChange(settings,action,redraw){var start=settings._iDisplayStart,len=settings._iDisplayLength,records=settings.fnRecordsDisplay();0===records||-1===len?start=0:"number"==typeof action?(start=action*len,start>records&&(start=0)):"first"==action?start=0:"previous"==action?(start=len>=0?start-len:0,0>start&&(start=0)):"next"==action?records>start+len&&(start+=len):"last"==action?start=Math.floor((records-1)/len)*len:_fnLog(settings,0,"Unknown paging action: "+action,5);var changed=settings._iDisplayStart!==start;return settings._iDisplayStart=start,changed&&(_fnCallbackFire(settings,null,"page",[settings]),redraw&&_fnDraw(settings)),changed}function _fnFeatureHtmlProcessing(settings){return $("<div/>",{id:settings.aanFeatures.r?null:settings.sTableId+"_processing","class":settings.oClasses.sProcessing}).html(settings.oLanguage.sProcessing).insertBefore(settings.nTable)[0]}function _fnProcessingDisplay(settings,show){settings.oFeatures.bProcessing&&$(settings.aanFeatures.r).css("display",show?"block":"none"),_fnCallbackFire(settings,null,"processing",[settings,show])}function _fnFeatureHtmlTable(settings){var table=$(settings.nTable);table.attr("role","grid");var scroll=settings.oScroll;if(""===scroll.sX&&""===scroll.sY)return settings.nTable;var scrollX=scroll.sX,scrollY=scroll.sY,classes=settings.oClasses,caption=table.children("caption"),captionSide=caption.length?caption[0]._captionSide:null,headerClone=$(table[0].cloneNode(!1)),footerClone=$(table[0].cloneNode(!1)),footer=table.children("tfoot"),_div="<div/>",size=function(s){return s?_fnStringToCss(s):null};scroll.sX&&"100%"===table.attr("width")&&table.removeAttr("width"),footer.length||(footer=null);var scroller=$(_div,{"class":classes.sScrollWrapper}).append($(_div,{"class":classes.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:scrollX?size(scrollX):"100%"}).append($(_div,{"class":classes.sScrollHeadInner}).css({"box-sizing":"content-box",width:scroll.sXInner||"100%"}).append(headerClone.removeAttr("id").css("margin-left",0).append("top"===captionSide?caption:null).append(table.children("thead"))))).append($(_div,{"class":classes.sScrollBody}).css({overflow:"auto",height:size(scrollY),width:size(scrollX)}).append(table));footer&&scroller.append($(_div,{"class":classes.sScrollFoot}).css({overflow:"hidden",border:0,width:scrollX?size(scrollX):"100%"}).append($(_div,{"class":classes.sScrollFootInner}).append(footerClone.removeAttr("id").css("margin-left",0).append("bottom"===captionSide?caption:null).append(table.children("tfoot")))));var children=scroller.children(),scrollHead=children[0],scrollBody=children[1],scrollFoot=footer?children[2]:null;return scrollX&&$(scrollBody).on("scroll.DT",function(e){var scrollLeft=this.scrollLeft;scrollHead.scrollLeft=scrollLeft,footer&&(scrollFoot.scrollLeft=scrollLeft)}),settings.nScrollHead=scrollHead,settings.nScrollBody=scrollBody,settings.nScrollFoot=scrollFoot,settings.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),scroller[0]}function _fnScrollDraw(settings){var headerTrgEls,footerTrgEls,headerSrcEls,footerSrcEls,headerCopy,footerCopy,idx,correction,sanityWidth,scroll=settings.oScroll,scrollX=scroll.sX,scrollXInner=scroll.sXInner,scrollY=scroll.sY,barWidth=scroll.iBarWidth,divHeader=$(settings.nScrollHead),divHeaderStyle=divHeader[0].style,divHeaderInner=divHeader.children("div"),divHeaderInnerStyle=divHeaderInner[0].style,divHeaderTable=divHeaderInner.children("table"),divBodyEl=settings.nScrollBody,divBody=$(divBodyEl),divBodyStyle=divBodyEl.style,divFooter=$(settings.nScrollFoot),divFooterInner=divFooter.children("div"),divFooterTable=divFooterInner.children("table"),header=$(settings.nTHead),table=$(settings.nTable),tableEl=table[0],tableStyle=tableEl.style,footer=settings.nTFoot?$(settings.nTFoot):null,browser=settings.oBrowser,ie67=browser.bScrollOversize,headerWidths=[],footerWidths=[],headerContent=[],zeroOut=function(nSizer){var style=nSizer.style;style.paddingTop="0",style.paddingBottom="0",style.borderTopWidth="0",style.borderBottomWidth="0",style.height=0};if(table.children("thead, tfoot").remove(),headerCopy=header.clone().prependTo(table),headerTrgEls=header.find("tr"),headerSrcEls=headerCopy.find("tr"),headerCopy.find("th, td").removeAttr("tabindex"),footer&&(footerCopy=footer.clone().prependTo(table),footerTrgEls=footer.find("tr"),footerSrcEls=footerCopy.find("tr")),scrollX||(divBodyStyle.width="100%",divHeader[0].style.width="100%"),$.each(_fnGetUniqueThs(settings,headerCopy),function(i,el){idx=_fnVisibleToColumnIndex(settings,i),el.style.width=settings.aoColumns[idx].sWidth}),footer&&_fnApplyToChildren(function(n){n.style.width=""},footerSrcEls),scroll.bCollapse&&""!==scrollY&&(divBodyStyle.height=divBody[0].offsetHeight+header[0].offsetHeight+"px"),sanityWidth=table.outerWidth(),""===scrollX?(tableStyle.width="100%",ie67&&(table.find("tbody").height()>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y"))&&(tableStyle.width=_fnStringToCss(table.outerWidth()-barWidth))):""!==scrollXInner?tableStyle.width=_fnStringToCss(scrollXInner):sanityWidth==divBody.width()&&divBody.height()<table.height()?(tableStyle.width=_fnStringToCss(sanityWidth-barWidth),table.outerWidth()>sanityWidth-barWidth&&(tableStyle.width=_fnStringToCss(sanityWidth))):tableStyle.width=_fnStringToCss(sanityWidth),sanityWidth=table.outerWidth(),_fnApplyToChildren(zeroOut,headerSrcEls),_fnApplyToChildren(function(nSizer){headerContent.push(nSizer.innerHTML),headerWidths.push(_fnStringToCss($(nSizer).css("width")))},headerSrcEls),_fnApplyToChildren(function(nToSize,i){nToSize.style.width=headerWidths[i]},headerTrgEls),$(headerSrcEls).height(0),footer&&(_fnApplyToChildren(zeroOut,footerSrcEls),_fnApplyToChildren(function(nSizer){footerWidths.push(_fnStringToCss($(nSizer).css("width")))},footerSrcEls),_fnApplyToChildren(function(nToSize,i){nToSize.style.width=footerWidths[i]},footerTrgEls),$(footerSrcEls).height(0)),_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+headerContent[i]+"</div>",nSizer.style.width=headerWidths[i]},headerSrcEls),footer&&_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML="",nSizer.style.width=footerWidths[i]},footerSrcEls),table.outerWidth()<sanityWidth?(correction=divBodyEl.scrollHeight>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y")?sanityWidth+barWidth:sanityWidth,ie67&&(divBodyEl.scrollHeight>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y"))&&(tableStyle.width=_fnStringToCss(correction-barWidth)),(""===scrollX||""!==scrollXInner)&&_fnLog(settings,1,"Possible column misalignment",6)):correction="100%",divBodyStyle.width=_fnStringToCss(correction),divHeaderStyle.width=_fnStringToCss(correction),footer&&(settings.nScrollFoot.style.width=_fnStringToCss(correction)),scrollY||ie67&&(divBodyStyle.height=_fnStringToCss(tableEl.offsetHeight+barWidth)),scrollY&&scroll.bCollapse){divBodyStyle.height=_fnStringToCss(scrollY);var iExtra=scrollX&&tableEl.offsetWidth>divBodyEl.offsetWidth?barWidth:0;tableEl.offsetHeight<divBodyEl.offsetHeight&&(divBodyStyle.height=_fnStringToCss(tableEl.offsetHeight+iExtra))}var iOuterWidth=table.outerWidth();divHeaderTable[0].style.width=_fnStringToCss(iOuterWidth),divHeaderInnerStyle.width=_fnStringToCss(iOuterWidth);var bScrolling=table.height()>divBodyEl.clientHeight||"scroll"==divBody.css("overflow-y"),padding="padding"+(browser.bScrollbarLeft?"Left":"Right");divHeaderInnerStyle[padding]=bScrolling?barWidth+"px":"0px",footer&&(divFooterTable[0].style.width=_fnStringToCss(iOuterWidth),divFooterInner[0].style.width=_fnStringToCss(iOuterWidth),divFooterInner[0].style[padding]=bScrolling?barWidth+"px":"0px"),divBody.scroll(),!settings.bSorted&&!settings.bFiltered||settings._drawHold||(divBodyEl.scrollTop=0);
}function _fnApplyToChildren(fn,an1,an2){for(var nNode1,nNode2,index=0,i=0,iLen=an1.length;iLen>i;){for(nNode1=an1[i].firstChild,nNode2=an2?an2[i].firstChild:null;nNode1;)1===nNode1.nodeType&&(an2?fn(nNode1,nNode2,index):fn(nNode1,index),index++),nNode1=nNode1.nextSibling,nNode2=an2?nNode2.nextSibling:null;i++}}function _fnCalculateColumnWidths(oSettings){var i,column,columnIdx,width,outerWidth,table=oSettings.nTable,columns=oSettings.aoColumns,scroll=oSettings.oScroll,scrollY=scroll.sY,scrollX=scroll.sX,scrollXInner=scroll.sXInner,columnCount=columns.length,visibleColumns=_fnGetColumns(oSettings,"bVisible"),headerCells=$("th",oSettings.nTHead),tableWidthAttr=table.getAttribute("width"),tableContainer=table.parentNode,userInputs=!1,styleWidth=table.style.width;for(styleWidth&&-1!==styleWidth.indexOf("%")&&(tableWidthAttr=styleWidth),i=0;i<visibleColumns.length;i++)column=columns[visibleColumns[i]],null!==column.sWidth&&(column.sWidth=_fnConvertToWidth(column.sWidthOrig,tableContainer),userInputs=!0);if(userInputs||scrollX||scrollY||columnCount!=_fnVisbleColumns(oSettings)||columnCount!=headerCells.length){var tmpTable=$(table).clone().empty().css("visibility","hidden").removeAttr("id").append($(oSettings.nTHead).clone(!1)).append($(oSettings.nTFoot).clone(!1)).append($("<tbody><tr/></tbody>"));tmpTable.find("tfoot th, tfoot td").css("width","");var tr=tmpTable.find("tbody tr");for(headerCells=_fnGetUniqueThs(oSettings,tmpTable.find("thead")[0]),i=0;i<visibleColumns.length;i++)column=columns[visibleColumns[i]],headerCells[i].style.width=null!==column.sWidthOrig&&""!==column.sWidthOrig?_fnStringToCss(column.sWidthOrig):"";if(oSettings.aoData.length)for(i=0;i<visibleColumns.length;i++)columnIdx=visibleColumns[i],column=columns[columnIdx],$(_fnGetWidestNode(oSettings,columnIdx)).clone(!1).append(column.sContentPadding).appendTo(tr);if(tmpTable.appendTo(tableContainer),scrollX&&scrollXInner?tmpTable.width(scrollXInner):scrollX?(tmpTable.css("width","auto"),tmpTable.width()<tableContainer.offsetWidth&&tmpTable.width(tableContainer.offsetWidth)):scrollY?tmpTable.width(tableContainer.offsetWidth):tableWidthAttr&&tmpTable.width(tableWidthAttr),_fnScrollingWidthAdjust(oSettings,tmpTable[0]),scrollX){var total=0;for(i=0;i<visibleColumns.length;i++)column=columns[visibleColumns[i]],outerWidth=$(headerCells[i]).outerWidth(),total+=null===column.sWidthOrig?outerWidth:parseInt(column.sWidth,10)+outerWidth-$(headerCells[i]).width();tmpTable.width(_fnStringToCss(total)),table.style.width=_fnStringToCss(total)}for(i=0;i<visibleColumns.length;i++)column=columns[visibleColumns[i]],width=$(headerCells[i]).width(),width&&(column.sWidth=_fnStringToCss(width));table.style.width=_fnStringToCss(tmpTable.css("width")),tmpTable.remove()}else for(i=0;columnCount>i;i++)columns[i].sWidth=_fnStringToCss(headerCells.eq(i).width());tableWidthAttr&&(table.style.width=_fnStringToCss(tableWidthAttr)),!tableWidthAttr&&!scrollX||oSettings._reszEvt||($(window).bind("resize.DT-"+oSettings.sInstance,_fnThrottle(function(){_fnAdjustColumnSizing(oSettings)})),oSettings._reszEvt=!0)}function _fnThrottle(fn,freq){var last,timer,frequency=freq!==undefined?freq:200;return function(){var that=this,now=+new Date,args=arguments;last&&last+frequency>now?(clearTimeout(timer),timer=setTimeout(function(){last=undefined,fn.apply(that,args)},frequency)):(last=now,fn.apply(that,args))}}function _fnConvertToWidth(width,parent){if(!width)return 0;var n=$("<div/>").css("width",_fnStringToCss(width)).appendTo(parent||document.body),val=n[0].offsetWidth;return n.remove(),val}function _fnScrollingWidthAdjust(settings,n){var scroll=settings.oScroll;if(scroll.sX||scroll.sY){var correction=scroll.sX?0:scroll.iBarWidth;n.style.width=_fnStringToCss($(n).outerWidth()-correction)}}function _fnGetWidestNode(settings,colIdx){var idx=_fnGetMaxLenString(settings,colIdx);if(0>idx)return null;var data=settings.aoData[idx];return data.nTr?data.anCells[colIdx]:$("<td/>").html(_fnGetCellData(settings,idx,colIdx,"display"))[0]}function _fnGetMaxLenString(settings,colIdx){for(var s,max=-1,maxIdx=-1,i=0,ien=settings.aoData.length;ien>i;i++)s=_fnGetCellData(settings,i,colIdx,"display")+"",s=s.replace(__re_html_remove,""),s.length>max&&(max=s.length,maxIdx=i);return maxIdx}function _fnStringToCss(s){return null===s?"0px":"number"==typeof s?0>s?"0px":s+"px":s.match(/\d$/)?s+"px":s}function _fnScrollBarWidth(){var width=DataTable.__scrollbarWidth;if(width===undefined){var sizer=$("<p/>").css({position:"absolute",top:0,left:0,width:"100%",height:150,padding:0,overflow:"scroll",visibility:"hidden"}).appendTo("body");width=sizer[0].offsetWidth-sizer[0].clientWidth,DataTable.__scrollbarWidth=width,sizer.remove()}return width}function _fnSortFlatten(settings){var i,k,kLen,aDataSort,iCol,sType,srcCol,aSort=[],aoColumns=settings.aoColumns,fixed=settings.aaSortingFixed,fixedObj=$.isPlainObject(fixed),nestedSort=[],add=function(a){a.length&&!$.isArray(a[0])?nestedSort.push(a):nestedSort.push.apply(nestedSort,a)};for($.isArray(fixed)&&add(fixed),fixedObj&&fixed.pre&&add(fixed.pre),add(settings.aaSorting),fixedObj&&fixed.post&&add(fixed.post),i=0;i<nestedSort.length;i++)for(srcCol=nestedSort[i][0],aDataSort=aoColumns[srcCol].aDataSort,k=0,kLen=aDataSort.length;kLen>k;k++)iCol=aDataSort[k],sType=aoColumns[iCol].sType||"string",nestedSort[i]._idx===undefined&&(nestedSort[i]._idx=$.inArray(nestedSort[i][1],aoColumns[iCol].asSorting)),aSort.push({src:srcCol,col:iCol,dir:nestedSort[i][1],index:nestedSort[i]._idx,type:sType,formatter:DataTable.ext.type.order[sType+"-pre"]});return aSort}function _fnSort(oSettings){var i,ien,iLen,sortCol,aSort,aiOrig=[],oExtSort=DataTable.ext.type.order,aoData=oSettings.aoData,formatters=(oSettings.aoColumns,0),displayMaster=oSettings.aiDisplayMaster;for(_fnColumnTypes(oSettings),aSort=_fnSortFlatten(oSettings),i=0,ien=aSort.length;ien>i;i++)sortCol=aSort[i],sortCol.formatter&&formatters++,_fnSortData(oSettings,sortCol.col);if("ssp"!=_fnDataSource(oSettings)&&0!==aSort.length){for(i=0,iLen=displayMaster.length;iLen>i;i++)aiOrig[displayMaster[i]]=i;formatters===aSort.length?displayMaster.sort(function(a,b){var x,y,k,test,sort,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;len>k;k++)if(sort=aSort[k],x=dataA[sort.col],y=dataB[sort.col],test=y>x?-1:x>y?1:0,0!==test)return"asc"===sort.dir?test:-test;return x=aiOrig[a],y=aiOrig[b],y>x?-1:x>y?1:0}):displayMaster.sort(function(a,b){var x,y,k,test,sort,fn,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;len>k;k++)if(sort=aSort[k],x=dataA[sort.col],y=dataB[sort.col],fn=oExtSort[sort.type+"-"+sort.dir]||oExtSort["string-"+sort.dir],test=fn(x,y),0!==test)return test;return x=aiOrig[a],y=aiOrig[b],y>x?-1:x>y?1:0})}oSettings.bSorted=!0}function _fnSortAria(settings){for(var label,nextSort,columns=settings.aoColumns,aSort=_fnSortFlatten(settings),oAria=settings.oLanguage.oAria,i=0,iLen=columns.length;iLen>i;i++){var col=columns[i],asSorting=col.asSorting,sTitle=col.sTitle.replace(/<.*?>/g,""),th=col.nTh;th.removeAttribute("aria-sort"),col.bSortable?(aSort.length>0&&aSort[0].col==i?(th.setAttribute("aria-sort","asc"==aSort[0].dir?"ascending":"descending"),nextSort=asSorting[aSort[0].index+1]||asSorting[0]):nextSort=asSorting[0],label=sTitle+("asc"===nextSort?oAria.sSortAscending:oAria.sSortDescending)):label=sTitle,th.setAttribute("aria-label",label)}}function _fnSortListener(settings,colIdx,append,callback){var nextSortIdx,col=settings.aoColumns[colIdx],sorting=settings.aaSorting,asSorting=col.asSorting,next=function(a,overflow){var idx=a._idx;return idx===undefined&&(idx=$.inArray(a[1],asSorting)),idx+1<asSorting.length?idx+1:overflow?null:0};if("number"==typeof sorting[0]&&(sorting=settings.aaSorting=[sorting]),append&&settings.oFeatures.bSortMulti){var sortIdx=$.inArray(colIdx,_pluck(sorting,"0"));-1!==sortIdx?(nextSortIdx=next(sorting[sortIdx],!0),null===nextSortIdx&&1===sorting.length&&(nextSortIdx=0),null===nextSortIdx?sorting.splice(sortIdx,1):(sorting[sortIdx][1]=asSorting[nextSortIdx],sorting[sortIdx]._idx=nextSortIdx)):(sorting.push([colIdx,asSorting[0],0]),sorting[sorting.length-1]._idx=0)}else sorting.length&&sorting[0][0]==colIdx?(nextSortIdx=next(sorting[0]),sorting.length=1,sorting[0][1]=asSorting[nextSortIdx],sorting[0]._idx=nextSortIdx):(sorting.length=0,sorting.push([colIdx,asSorting[0]]),sorting[0]._idx=0);_fnReDraw(settings),"function"==typeof callback&&callback(settings)}function _fnSortAttachListener(settings,attachTo,colIdx,callback){var col=settings.aoColumns[colIdx];_fnBindAction(attachTo,{},function(e){col.bSortable!==!1&&(settings.oFeatures.bProcessing?(_fnProcessingDisplay(settings,!0),setTimeout(function(){_fnSortListener(settings,colIdx,e.shiftKey,callback),"ssp"!==_fnDataSource(settings)&&_fnProcessingDisplay(settings,!1)},0)):_fnSortListener(settings,colIdx,e.shiftKey,callback))})}function _fnSortingClasses(settings){var i,ien,colIdx,oldSort=settings.aLastSort,sortClass=settings.oClasses.sSortColumn,sort=_fnSortFlatten(settings),features=settings.oFeatures;if(features.bSort&&features.bSortClasses){for(i=0,ien=oldSort.length;ien>i;i++)colIdx=oldSort[i].src,$(_pluck(settings.aoData,"anCells",colIdx)).removeClass(sortClass+(2>i?i+1:3));for(i=0,ien=sort.length;ien>i;i++)colIdx=sort[i].src,$(_pluck(settings.aoData,"anCells",colIdx)).addClass(sortClass+(2>i?i+1:3))}settings.aLastSort=sort}function _fnSortData(settings,idx){var customData,column=settings.aoColumns[idx],customSort=DataTable.ext.order[column.sSortDataType];customSort&&(customData=customSort.call(settings.oInstance,settings,idx,_fnColumnIndexToVisible(settings,idx)));for(var row,cellData,formatter=DataTable.ext.type.order[column.sType+"-pre"],i=0,ien=settings.aoData.length;ien>i;i++)row=settings.aoData[i],row._aSortData||(row._aSortData=[]),(!row._aSortData[idx]||customSort)&&(cellData=customSort?customData[i]:_fnGetCellData(settings,i,idx,"sort"),row._aSortData[idx]=formatter?formatter(cellData):cellData)}function _fnSaveState(settings){if(settings.oFeatures.bStateSave&&!settings.bDestroying){var state={time:+new Date,start:settings._iDisplayStart,length:settings._iDisplayLength,order:$.extend(!0,[],settings.aaSorting),search:_fnSearchToCamel(settings.oPreviousSearch),columns:$.map(settings.aoColumns,function(col,i){return{visible:col.bVisible,search:_fnSearchToCamel(settings.aoPreSearchCols[i])}})};_fnCallbackFire(settings,"aoStateSaveParams","stateSaveParams",[settings,state]),settings.oSavedState=state,settings.fnStateSaveCallback.call(settings.oInstance,settings,state)}}function _fnLoadState(settings,oInit){var i,ien,columns=settings.aoColumns;if(settings.oFeatures.bStateSave){var state=settings.fnStateLoadCallback.call(settings.oInstance,settings);if(state&&state.time){var abStateLoad=_fnCallbackFire(settings,"aoStateLoadParams","stateLoadParams",[settings,state]);if(-1===$.inArray(!1,abStateLoad)){var duration=settings.iStateDuration;if(!(duration>0&&state.time<+new Date-1e3*duration)&&columns.length===state.columns.length){for(settings.oLoadedState=$.extend(!0,{},state),state.start!==undefined&&(settings._iDisplayStart=state.start,settings.iInitDisplayStart=state.start),state.length!==undefined&&(settings._iDisplayLength=state.length),state.order!==undefined&&(settings.aaSorting=[],$.each(state.order,function(i,col){settings.aaSorting.push(col[0]>=columns.length?[0,col[1]]:col)})),state.search!==undefined&&$.extend(settings.oPreviousSearch,_fnSearchToHung(state.search)),i=0,ien=state.columns.length;ien>i;i++){var col=state.columns[i];col.visible!==undefined&&(columns[i].bVisible=col.visible),col.search!==undefined&&$.extend(settings.aoPreSearchCols[i],_fnSearchToHung(col.search))}_fnCallbackFire(settings,"aoStateLoaded","stateLoaded",[settings,state])}}}}}function _fnSettingsFromNode(table){var settings=DataTable.settings,idx=$.inArray(table,_pluck(settings,"nTable"));return-1!==idx?settings[idx]:null}function _fnLog(settings,level,msg,tn){if(msg="DataTables warning: "+(null!==settings?"table id="+settings.sTableId+" - ":"")+msg,tn&&(msg+=". For more information about this error, please see http://datatables.net/tn/"+tn),level)window.console&&console.log&&console.log(msg);else{var ext=DataTable.ext,type=ext.sErrMode||ext.errMode;if(_fnCallbackFire(settings,null,"error",[settings,tn,msg]),"alert"==type)alert(msg);else{if("throw"==type)throw new Error(msg);"function"==typeof type&&type(settings,tn,msg)}}}function _fnMap(ret,src,name,mappedName){return $.isArray(name)?void $.each(name,function(i,val){$.isArray(val)?_fnMap(ret,src,val[0],val[1]):_fnMap(ret,src,val)}):(mappedName===undefined&&(mappedName=name),void(src[name]!==undefined&&(ret[mappedName]=src[name])))}function _fnExtend(out,extender,breakRefs){var val;for(var prop in extender)extender.hasOwnProperty(prop)&&(val=extender[prop],$.isPlainObject(val)?($.isPlainObject(out[prop])||(out[prop]={}),$.extend(!0,out[prop],val)):breakRefs&&"data"!==prop&&"aaData"!==prop&&$.isArray(val)?out[prop]=val.slice():out[prop]=val);return out}function _fnBindAction(n,oData,fn){$(n).bind("click.DT",oData,function(e){n.blur(),fn(e)}).bind("keypress.DT",oData,function(e){13===e.which&&(e.preventDefault(),fn(e))}).bind("selectstart.DT",function(){return!1})}function _fnCallbackReg(oSettings,sStore,fn,sName){fn&&oSettings[sStore].push({fn:fn,sName:sName})}function _fnCallbackFire(settings,callbackArr,e,args){var ret=[];return callbackArr&&(ret=$.map(settings[callbackArr].slice().reverse(),function(val,i){return val.fn.apply(settings.oInstance,args)})),null!==e&&$(settings.nTable).trigger(e+".dt",args),ret}function _fnLengthOverflow(settings){var start=settings._iDisplayStart,end=settings.fnDisplayEnd(),len=settings._iDisplayLength;start>=end&&(start=end-len),start-=start%len,(-1===len||0>start)&&(start=0),settings._iDisplayStart=start}function _fnRenderer(settings,type){var renderer=settings.renderer,host=DataTable.ext.renderer[type];return $.isPlainObject(renderer)&&renderer[type]?host[renderer[type]]||host._:"string"==typeof renderer?host[renderer]||host._:host._}function _fnDataSource(settings){return settings.oFeatures.bServerSide?"ssp":settings.ajax||settings.sAjaxSource?"ajax":"dom"}function _numbers(page,pages){var numbers=[],buttons=extPagination.numbers_length,half=Math.floor(buttons/2);return buttons>=pages?numbers=_range(0,pages):half>=page?(numbers=_range(0,buttons-2),numbers.push("ellipsis"),numbers.push(pages-1)):page>=pages-1-half?(numbers=_range(pages-(buttons-2),pages),numbers.splice(0,0,"ellipsis"),numbers.splice(0,0,0)):(numbers=_range(page-half+2,page+half-1),numbers.push("ellipsis"),numbers.push(pages-1),numbers.splice(0,0,"ellipsis"),numbers.splice(0,0,0)),numbers.DT_el="span",numbers}function _addNumericSort(decimalPlace){$.each({num:function(d){return __numericReplace(d,decimalPlace)},"num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_formatted_numeric)},"html-num":function(d){return __numericReplace(d,decimalPlace,_re_html)},"html-num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_html,_re_formatted_numeric)}},function(key,fn){_ext.type.order[key+decimalPlace+"-pre"]=fn,key.match(/^html\-/)&&(_ext.type.search[key+decimalPlace]=_ext.type.search.html)})}function _fnExternApiFunc(fn){return function(){var args=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.internal[fn].apply(this,args)}}var DataTable,_ext,_Api,_api_register,_api_registerPlural,_re_dic={},_re_new_lines=/[\r\n]/g,_re_html=/<.*?>/g,_re_date_start=/^[\w\+\-]/,_re_date_end=/[\w\+\-]$/,_re_escape_regex=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),_re_formatted_numeric=/[',$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,_empty=function(d){return d&&d!==!0&&"-"!==d?!1:!0},_intVal=function(s){var integer=parseInt(s,10);return!isNaN(integer)&&isFinite(s)?integer:null},_numToDecimal=function(num,decimalPoint){return _re_dic[decimalPoint]||(_re_dic[decimalPoint]=new RegExp(_fnEscapeRegex(decimalPoint),"g")),"string"==typeof num&&"."!==decimalPoint?num.replace(/\./g,"").replace(_re_dic[decimalPoint],"."):num},_isNumber=function(d,decimalPoint,formatted){var strType="string"==typeof d;return _empty(d)?!0:(decimalPoint&&strType&&(d=_numToDecimal(d,decimalPoint)),formatted&&strType&&(d=d.replace(_re_formatted_numeric,"")),!isNaN(parseFloat(d))&&isFinite(d))},_isHtml=function(d){return _empty(d)||"string"==typeof d},_htmlNumeric=function(d,decimalPoint,formatted){if(_empty(d))return!0;var html=_isHtml(d);return html&&_isNumber(_stripHtml(d),decimalPoint,formatted)?!0:null},_pluck=function(a,prop,prop2){var out=[],i=0,ien=a.length;if(prop2!==undefined)for(;ien>i;i++)a[i]&&a[i][prop]&&out.push(a[i][prop][prop2]);else for(;ien>i;i++)a[i]&&out.push(a[i][prop]);return out},_pluck_order=function(a,order,prop,prop2){var out=[],i=0,ien=order.length;if(prop2!==undefined)for(;ien>i;i++)a[order[i]][prop]&&out.push(a[order[i]][prop][prop2]);else for(;ien>i;i++)out.push(a[order[i]][prop]);return out},_range=function(len,start){var end,out=[];start===undefined?(start=0,end=len):(end=start,start=len);for(var i=start;end>i;i++)out.push(i);return out},_removeEmpty=function(a){for(var out=[],i=0,ien=a.length;ien>i;i++)a[i]&&out.push(a[i]);return out},_stripHtml=function(d){return d.replace(_re_html,"")},_unique=function(src){var val,i,j,out=[],ien=src.length,k=0;again:for(i=0;ien>i;i++){for(val=src[i],j=0;k>j;j++)if(out[j]===val)continue again;out.push(val),k++}return out},_fnCompatMap=function(o,knew,old){o[knew]!==undefined&&(o[old]=o[knew])},__reArray=/\[.*?\]$/,__reFn=/\(\)$/,__filter_div=$("<div>")[0],__filter_div_textContent=__filter_div.textContent!==undefined,__re_html_remove=/<.*?>/g;DataTable=function(options){this.$=function(sSelector,oOpts){return this.api(!0).$(sSelector,oOpts)},this._=function(sSelector,oOpts){return this.api(!0).rows(sSelector,oOpts).data()},this.api=function(traditional){return new _Api(traditional?_fnSettingsFromNode(this[_ext.iApiIndex]):this)},this.fnAddData=function(data,redraw){var api=this.api(!0),rows=$.isArray(data)&&($.isArray(data[0])||$.isPlainObject(data[0]))?api.rows.add(data):api.row.add(data);return(redraw===undefined||redraw)&&api.draw(),rows.flatten().toArray()},this.fnAdjustColumnSizing=function(bRedraw){var api=this.api(!0).columns.adjust(),settings=api.settings()[0],scroll=settings.oScroll;bRedraw===undefined||bRedraw?api.draw(!1):(""!==scroll.sX||""!==scroll.sY)&&_fnScrollDraw(settings)},this.fnClearTable=function(bRedraw){var api=this.api(!0).clear();(bRedraw===undefined||bRedraw)&&api.draw()},this.fnClose=function(nTr){this.api(!0).row(nTr).child.hide()},this.fnDeleteRow=function(target,callback,redraw){var api=this.api(!0),rows=api.rows(target),settings=rows.settings()[0],data=settings.aoData[rows[0][0]];return rows.remove(),callback&&callback.call(this,settings,data),(redraw===undefined||redraw)&&api.draw(),data},this.fnDestroy=function(remove){this.api(!0).destroy(remove)},this.fnDraw=function(complete){this.api(!0).draw(complete)},this.fnFilter=function(sInput,iColumn,bRegex,bSmart,bShowGlobal,bCaseInsensitive){var api=this.api(!0);null===iColumn||iColumn===undefined?api.search(sInput,bRegex,bSmart,bCaseInsensitive):api.column(iColumn).search(sInput,bRegex,bSmart,bCaseInsensitive),api.draw()},this.fnGetData=function(src,col){var api=this.api(!0);if(src!==undefined){var type=src.nodeName?src.nodeName.toLowerCase():"";return col!==undefined||"td"==type||"th"==type?api.cell(src,col).data():api.row(src).data()||null}return api.data().toArray()},this.fnGetNodes=function(iRow){var api=this.api(!0);return iRow!==undefined?api.row(iRow).node():api.rows().nodes().flatten().toArray()},this.fnGetPosition=function(node){var api=this.api(!0),nodeName=node.nodeName.toUpperCase();if("TR"==nodeName)return api.row(node).index();if("TD"==nodeName||"TH"==nodeName){var cell=api.cell(node).index();return[cell.row,cell.columnVisible,cell.column]}return null},this.fnIsOpen=function(nTr){return this.api(!0).row(nTr).child.isShown()},this.fnOpen=function(nTr,mHtml,sClass){return this.api(!0).row(nTr).child(mHtml,sClass).show().child()[0]},this.fnPageChange=function(mAction,bRedraw){var api=this.api(!0).page(mAction);(bRedraw===undefined||bRedraw)&&api.draw(!1)},this.fnSetColumnVis=function(iCol,bShow,bRedraw){var api=this.api(!0).column(iCol).visible(bShow);(bRedraw===undefined||bRedraw)&&api.columns.adjust().draw()},this.fnSettings=function(){return _fnSettingsFromNode(this[_ext.iApiIndex])},this.fnSort=function(aaSort){this.api(!0).order(aaSort).draw()},this.fnSortListener=function(nNode,iColumn,fnCallback){this.api(!0).order.listener(nNode,iColumn,fnCallback)},this.fnUpdate=function(mData,mRow,iColumn,bRedraw,bAction){var api=this.api(!0);return iColumn===undefined||null===iColumn?api.row(mRow).data(mData):api.cell(mRow,iColumn).data(mData),(bAction===undefined||bAction)&&api.columns.adjust(),(bRedraw===undefined||bRedraw)&&api.draw(),0},this.fnVersionCheck=_ext.fnVersionCheck;var _that=this,emptyInit=options===undefined,len=this.length;emptyInit&&(options={}),this.oApi=this.internal=_ext.internal;for(var fn in DataTable.ext.internal)fn&&(this[fn]=_fnExternApiFunc(fn));return this.each(function(){var iLen,o={},oInit=len>1?_fnExtend(o,options,!0):options,i=0,sId=this.getAttribute("id"),bInitHandedOff=!1,defaults=DataTable.defaults,$this=$(this);if("table"!=this.nodeName.toLowerCase())return void _fnLog(null,0,"Non-table node initialisation ("+this.nodeName+")",2);_fnCompatOpts(defaults),_fnCompatCols(defaults.column),_fnCamelToHungarian(defaults,defaults,!0),_fnCamelToHungarian(defaults.column,defaults.column,!0),_fnCamelToHungarian(defaults,$.extend(oInit,$this.data()));var allSettings=DataTable.settings;for(i=0,iLen=allSettings.length;iLen>i;i++){var s=allSettings[i];if(s.nTable==this||s.nTHead.parentNode==this||s.nTFoot&&s.nTFoot.parentNode==this){var bRetrieve=oInit.bRetrieve!==undefined?oInit.bRetrieve:defaults.bRetrieve,bDestroy=oInit.bDestroy!==undefined?oInit.bDestroy:defaults.bDestroy;if(emptyInit||bRetrieve)return s.oInstance;if(bDestroy){s.oInstance.fnDestroy();break}return void _fnLog(s,0,"Cannot reinitialise DataTable",3)}if(s.sTableId==this.id){allSettings.splice(i,1);break}}(null===sId||""===sId)&&(sId="DataTables_Table_"+DataTable.ext._unique++,this.id=sId);var oSettings=$.extend(!0,{},DataTable.models.oSettings,{sDestroyWidth:$this[0].style.width,sInstance:sId,sTableId:sId});oSettings.nTable=this,oSettings.oApi=_that.internal,oSettings.oInit=oInit,allSettings.push(oSettings),oSettings.oInstance=1===_that.length?_that:$this.dataTable(),_fnCompatOpts(oInit),oInit.oLanguage&&_fnLanguageCompat(oInit.oLanguage),oInit.aLengthMenu&&!oInit.iDisplayLength&&(oInit.iDisplayLength=$.isArray(oInit.aLengthMenu[0])?oInit.aLengthMenu[0][0]:oInit.aLengthMenu[0]),oInit=_fnExtend($.extend(!0,{},defaults),oInit),_fnMap(oSettings.oFeatures,oInit,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),_fnMap(oSettings,oInit,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),_fnMap(oSettings.oScroll,oInit,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),_fnMap(oSettings.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(oSettings,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(oSettings,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(oSettings,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(oSettings,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(oSettings,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(oSettings,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(oSettings,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(oSettings,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(oSettings,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(oSettings,"aoInitComplete",oInit.fnInitComplete,"user"),_fnCallbackReg(oSettings,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user");var oClasses=oSettings.oClasses;if(oInit.bJQueryUI?($.extend(oClasses,DataTable.ext.oJUIClasses,oInit.oClasses),oInit.sDom===defaults.sDom&&"lfrtip"===defaults.sDom&&(oSettings.sDom='<"H"lfr>t<"F"ip>'),oSettings.renderer?$.isPlainObject(oSettings.renderer)&&!oSettings.renderer.header&&(oSettings.renderer.header="jqueryui"):oSettings.renderer="jqueryui"):$.extend(oClasses,DataTable.ext.classes,oInit.oClasses),$this.addClass(oClasses.sTable),(""!==oSettings.oScroll.sX||""!==oSettings.oScroll.sY)&&(oSettings.oScroll.iBarWidth=_fnScrollBarWidth()),oSettings.oScroll.sX===!0&&(oSettings.oScroll.sX="100%"),oSettings.iInitDisplayStart===undefined&&(oSettings.iInitDisplayStart=oInit.iDisplayStart,oSettings._iDisplayStart=oInit.iDisplayStart),null!==oInit.iDeferLoading){oSettings.bDeferLoading=!0;var tmp=$.isArray(oInit.iDeferLoading);oSettings._iRecordsDisplay=tmp?oInit.iDeferLoading[0]:oInit.iDeferLoading,oSettings._iRecordsTotal=tmp?oInit.iDeferLoading[1]:oInit.iDeferLoading}var oLanguage=oSettings.oLanguage;$.extend(!0,oLanguage,oInit.oLanguage),""!==oLanguage.sUrl&&($.ajax({dataType:"json",url:oLanguage.sUrl,success:function(json){_fnLanguageCompat(json),_fnCamelToHungarian(defaults.oLanguage,json),$.extend(!0,oLanguage,json),_fnInitialise(oSettings)},error:function(){_fnInitialise(oSettings)}}),bInitHandedOff=!0),null===oInit.asStripeClasses&&(oSettings.asStripeClasses=[oClasses.sStripeOdd,oClasses.sStripeEven]);var stripeClasses=oSettings.asStripeClasses,rowOne=$this.children("tbody").find("tr").eq(0);-1!==$.inArray(!0,$.map(stripeClasses,function(el,i){return rowOne.hasClass(el)}))&&($("tbody tr",this).removeClass(stripeClasses.join(" ")),oSettings.asDestroyStripes=stripeClasses.slice());var aoColumnsInit,anThs=[],nThead=this.getElementsByTagName("thead");if(0!==nThead.length&&(_fnDetectHeader(oSettings.aoHeader,nThead[0]),anThs=_fnGetUniqueThs(oSettings)),null===oInit.aoColumns)for(aoColumnsInit=[],i=0,iLen=anThs.length;iLen>i;i++)aoColumnsInit.push(null);else aoColumnsInit=oInit.aoColumns;for(i=0,iLen=aoColumnsInit.length;iLen>i;i++)_fnAddColumn(oSettings,anThs?anThs[i]:null);if(_fnApplyColumnDefs(oSettings,oInit.aoColumnDefs,aoColumnsInit,function(iCol,oDef){_fnColumnOptions(oSettings,iCol,oDef)}),rowOne.length){var a=function(cell,name){return null!==cell.getAttribute("data-"+name)?name:null};$.each(_fnGetRowElements(oSettings,rowOne[0]).cells,function(i,cell){var col=oSettings.aoColumns[i];if(col.mData===i){var sort=a(cell,"sort")||a(cell,"order"),filter=a(cell,"filter")||a(cell,"search");(null!==sort||null!==filter)&&(col.mData={_:i+".display",sort:null!==sort?i+".@data-"+sort:undefined,type:null!==sort?i+".@data-"+sort:undefined,filter:null!==filter?i+".@data-"+filter:undefined},_fnColumnOptions(oSettings,i))}})}var features=oSettings.oFeatures;if(oInit.bStateSave&&(features.bStateSave=!0,_fnLoadState(oSettings,oInit),_fnCallbackReg(oSettings,"aoDrawCallback",_fnSaveState,"state_save")),oInit.aaSorting===undefined){var sorting=oSettings.aaSorting;for(i=0,iLen=sorting.length;iLen>i;i++)sorting[i][1]=oSettings.aoColumns[i].asSorting[0]}_fnSortingClasses(oSettings),features.bSort&&_fnCallbackReg(oSettings,"aoDrawCallback",function(){if(oSettings.bSorted){var aSort=_fnSortFlatten(oSettings),sortedColumns={};$.each(aSort,function(i,val){sortedColumns[val.src]=val.dir}),_fnCallbackFire(oSettings,null,"order",[oSettings,aSort,sortedColumns]),_fnSortAria(oSettings)}}),_fnCallbackReg(oSettings,"aoDrawCallback",function(){(oSettings.bSorted||"ssp"===_fnDataSource(oSettings)||features.bDeferRender)&&_fnSortingClasses(oSettings)},"sc"),_fnBrowserDetect(oSettings);var captions=$this.children("caption").each(function(){this._captionSide=$this.css("caption-side")}),thead=$this.children("thead");0===thead.length&&(thead=$("<thead/>").appendTo(this)),oSettings.nTHead=thead[0];var tbody=$this.children("tbody");0===tbody.length&&(tbody=$("<tbody/>").appendTo(this)),oSettings.nTBody=tbody[0];var tfoot=$this.children("tfoot");if(0===tfoot.length&&captions.length>0&&(""!==oSettings.oScroll.sX||""!==oSettings.oScroll.sY)&&(tfoot=$("<tfoot/>").appendTo(this)),0===tfoot.length||0===tfoot.children().length?$this.addClass(oClasses.sNoFooter):tfoot.length>0&&(oSettings.nTFoot=tfoot[0],_fnDetectHeader(oSettings.aoFooter,oSettings.nTFoot)),oInit.aaData)for(i=0;i<oInit.aaData.length;i++)_fnAddData(oSettings,oInit.aaData[i]);else(oSettings.bDeferLoading||"dom"==_fnDataSource(oSettings))&&_fnAddTr(oSettings,$(oSettings.nTBody).children("tr"));oSettings.aiDisplay=oSettings.aiDisplayMaster.slice(),oSettings.bInitialised=!0,bInitHandedOff===!1&&_fnInitialise(oSettings)}),_that=null,this};var __apiStruct=[],__arrayProto=Array.prototype,_toSettings=function(mixed){var idx,jq,settings=DataTable.settings,tables=$.map(settings,function(el,i){return el.nTable});return mixed?mixed.nTable&&mixed.oApi?[mixed]:mixed.nodeName&&"table"===mixed.nodeName.toLowerCase()?(idx=$.inArray(mixed,tables),-1!==idx?[settings[idx]]:null):mixed&&"function"==typeof mixed.settings?mixed.settings().toArray():("string"==typeof mixed?jq=$(mixed):mixed instanceof $&&(jq=mixed),jq?jq.map(function(i){return idx=$.inArray(this,tables),-1!==idx?settings[idx]:null}).toArray():void 0):[]};_Api=function(context,data){if(!this instanceof _Api)throw"DT API must be constructed as a new object";var settings=[],ctxSettings=function(o){var a=_toSettings(o);a&&settings.push.apply(settings,a)};if($.isArray(context))for(var i=0,ien=context.length;ien>i;i++)ctxSettings(context[i]);else ctxSettings(context);this.context=_unique(settings),data&&this.push.apply(this,data.toArray?data.toArray():data),this.selector={rows:null,cols:null,opts:null},_Api.extend(this,this,__apiStruct)},DataTable.Api=_Api,_Api.prototype={concat:__arrayProto.concat,context:[],each:function(fn){for(var i=0,ien=this.length;ien>i;i++)fn.call(this,this[i],i,this);return this},eq:function(idx){var ctx=this.context;return ctx.length>idx?new _Api(ctx[idx],this[idx]):null},filter:function(fn){var a=[];if(__arrayProto.filter)a=__arrayProto.filter.call(this,fn,this);else for(var i=0,ien=this.length;ien>i;i++)fn.call(this,this[i],i,this)&&a.push(this[i]);return new _Api(this.context,a)},flatten:function(){var a=[];return new _Api(this.context,a.concat.apply(a,this.toArray()))},join:__arrayProto.join,indexOf:__arrayProto.indexOf||function(obj,start){for(var i=start||0,ien=this.length;ien>i;i++)if(this[i]===obj)return i;return-1},iterator:function(flatten,type,fn,alwaysNew){var ret,i,ien,j,jen,rows,items,item,a=[],context=this.context,selector=this.selector;for("string"==typeof flatten&&(alwaysNew=fn,fn=type,type=flatten,flatten=!1),i=0,ien=context.length;ien>i;i++){var apiInst=new _Api(context[i]);if("table"===type)ret=fn.call(apiInst,context[i],i),ret!==undefined&&a.push(ret);else if("columns"===type||"rows"===type)ret=fn.call(apiInst,context[i],this[i],i),ret!==undefined&&a.push(ret);else if("column"===type||"column-rows"===type||"row"===type||"cell"===type)for(items=this[i],"column-rows"===type&&(rows=_selector_row_indexes(context[i],selector.opts)),j=0,jen=items.length;jen>j;j++)item=items[j],ret="cell"===type?fn.call(apiInst,context[i],item.row,item.column,i,j):fn.call(apiInst,context[i],item,i,j,rows),ret!==undefined&&a.push(ret)}if(a.length||alwaysNew){var api=new _Api(context,flatten?a.concat.apply([],a):a),apiSelector=api.selector;return apiSelector.rows=selector.rows,apiSelector.cols=selector.cols,
apiSelector.opts=selector.opts,api}return this},lastIndexOf:__arrayProto.lastIndexOf||function(obj,start){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(fn){var a=[];if(__arrayProto.map)a=__arrayProto.map.call(this,fn,this);else for(var i=0,ien=this.length;ien>i;i++)a.push(fn.call(this,this[i],i));return new _Api(this.context,a)},pluck:function(prop){return this.map(function(el){return el[prop]})},pop:__arrayProto.pop,push:__arrayProto.push,reduce:__arrayProto.reduce||function(fn,init){return _fnReduce(this,fn,init,0,this.length,1)},reduceRight:__arrayProto.reduceRight||function(fn,init){return _fnReduce(this,fn,init,this.length-1,-1,-1)},reverse:__arrayProto.reverse,selector:null,shift:__arrayProto.shift,sort:__arrayProto.sort,splice:__arrayProto.splice,toArray:function(){return __arrayProto.slice.call(this)},to$:function(){return $(this)},toJQuery:function(){return $(this)},unique:function(){return new _Api(this.context,_unique(this))},unshift:__arrayProto.unshift},_Api.extend=function(scope,obj,ext){if(ext.length&&obj&&(obj instanceof _Api||obj.__dt_wrapper)){var i,ien,struct,methodScoping=function(scope,fn,struc){return function(){var ret=fn.apply(scope,arguments);return _Api.extend(ret,ret,struc.methodExt),ret}};for(i=0,ien=ext.length;ien>i;i++)struct=ext[i],obj[struct.name]="function"==typeof struct.val?methodScoping(scope,struct.val,struct):$.isPlainObject(struct.val)?{}:struct.val,obj[struct.name].__dt_wrapper=!0,_Api.extend(scope,obj[struct.name],struct.propExt)}},_Api.register=_api_register=function(name,val){if($.isArray(name))for(var j=0,jen=name.length;jen>j;j++)_Api.register(name[j],val);else{var i,ien,key,method,heir=name.split("."),struct=__apiStruct,find=function(src,name){for(var i=0,ien=src.length;ien>i;i++)if(src[i].name===name)return src[i];return null};for(i=0,ien=heir.length;ien>i;i++){method=-1!==heir[i].indexOf("()"),key=method?heir[i].replace("()",""):heir[i];var src=find(struct,key);src||(src={name:key,val:{},methodExt:[],propExt:[]},struct.push(src)),i===ien-1?src.val=val:struct=method?src.methodExt:src.propExt}}},_Api.registerPlural=_api_registerPlural=function(pluralName,singularName,val){_Api.register(pluralName,val),_Api.register(singularName,function(){var ret=val.apply(this,arguments);return ret===this?this:ret instanceof _Api?ret.length?$.isArray(ret[0])?new _Api(ret.context,ret[0]):ret[0]:undefined:ret})};var __table_selector=function(selector,a){if("number"==typeof selector)return[a[selector]];var nodes=$.map(a,function(el,i){return el.nTable});return $(nodes).filter(selector).map(function(i){var idx=$.inArray(this,nodes);return a[idx]}).toArray()};_api_register("tables()",function(selector){return selector?new _Api(__table_selector(selector,this.context)):this}),_api_register("table()",function(selector){var tables=this.tables(selector),ctx=tables.context;return ctx.length?new _Api(ctx[0]):tables}),_api_registerPlural("tables().nodes()","table().node()",function(){return this.iterator("table",function(ctx){return ctx.nTable},1)}),_api_registerPlural("tables().body()","table().body()",function(){return this.iterator("table",function(ctx){return ctx.nTBody},1)}),_api_registerPlural("tables().header()","table().header()",function(){return this.iterator("table",function(ctx){return ctx.nTHead},1)}),_api_registerPlural("tables().footer()","table().footer()",function(){return this.iterator("table",function(ctx){return ctx.nTFoot},1)}),_api_registerPlural("tables().containers()","table().container()",function(){return this.iterator("table",function(ctx){return ctx.nTableWrapper},1)}),_api_register("draw()",function(resetPaging){return this.iterator("table",function(settings){_fnReDraw(settings,resetPaging===!1)})}),_api_register("page()",function(action){return action===undefined?this.page.info().page:this.iterator("table",function(settings){_fnPageChange(settings,action)})}),_api_register("page.info()",function(action){if(0===this.context.length)return undefined;var settings=this.context[0],start=settings._iDisplayStart,len=settings._iDisplayLength,visRecords=settings.fnRecordsDisplay(),all=-1===len;return{page:all?0:Math.floor(start/len),pages:all?1:Math.ceil(visRecords/len),start:start,end:settings.fnDisplayEnd(),length:len,recordsTotal:settings.fnRecordsTotal(),recordsDisplay:visRecords}}),_api_register("page.len()",function(len){return len===undefined?0!==this.context.length?this.context[0]._iDisplayLength:undefined:this.iterator("table",function(settings){_fnLengthChange(settings,len)})});var __reload=function(settings,holdPosition,callback){if(callback){var api=new _Api(settings);api.one("draw",function(){callback(api.ajax.json())})}"ssp"==_fnDataSource(settings)?_fnReDraw(settings,holdPosition):(_fnProcessingDisplay(settings,!0),_fnBuildAjax(settings,[],function(json){_fnClearTable(settings);for(var data=_fnAjaxDataSrc(settings,json),i=0,ien=data.length;ien>i;i++)_fnAddData(settings,data[i]);_fnReDraw(settings,holdPosition),_fnProcessingDisplay(settings,!1)}))};_api_register("ajax.json()",function(){var ctx=this.context;return ctx.length>0?ctx[0].json:void 0}),_api_register("ajax.params()",function(){var ctx=this.context;return ctx.length>0?ctx[0].oAjaxData:void 0}),_api_register("ajax.reload()",function(callback,resetPaging){return this.iterator("table",function(settings){__reload(settings,resetPaging===!1,callback)})}),_api_register("ajax.url()",function(url){var ctx=this.context;return url===undefined?0===ctx.length?undefined:(ctx=ctx[0],ctx.ajax?$.isPlainObject(ctx.ajax)?ctx.ajax.url:ctx.ajax:ctx.sAjaxSource):this.iterator("table",function(settings){$.isPlainObject(settings.ajax)?settings.ajax.url=url:settings.ajax=url})}),_api_register("ajax.url().load()",function(callback,resetPaging){return this.iterator("table",function(ctx){__reload(ctx,resetPaging===!1,callback)})});var _selector_run=function(selector,select){var res,a,i,ien,j,jen,out=[],selectorType=typeof selector;for(selector&&"string"!==selectorType&&"function"!==selectorType&&selector.length!==undefined||(selector=[selector]),i=0,ien=selector.length;ien>i;i++)for(a=selector[i]&&selector[i].split?selector[i].split(","):[selector[i]],j=0,jen=a.length;jen>j;j++)res=select("string"==typeof a[j]?$.trim(a[j]):a[j]),res&&res.length&&out.push.apply(out,res);return out},_selector_opts=function(opts){return opts||(opts={}),opts.filter&&!opts.search&&(opts.search=opts.filter),{search:opts.search||"none",order:opts.order||"current",page:opts.page||"all"}},_selector_first=function(inst){for(var i=0,ien=inst.length;ien>i;i++)if(inst[i].length>0)return inst[0]=inst[i],inst.length=1,inst.context=[inst.context[i]],inst;return inst.length=0,inst},_selector_row_indexes=function(settings,opts){var i,ien,tmp,a=[],displayFiltered=settings.aiDisplay,displayMaster=settings.aiDisplayMaster,search=opts.search,order=opts.order,page=opts.page;if("ssp"==_fnDataSource(settings))return"removed"===search?[]:_range(0,displayMaster.length);if("current"==page)for(i=settings._iDisplayStart,ien=settings.fnDisplayEnd();ien>i;i++)a.push(displayFiltered[i]);else if("current"==order||"applied"==order)a="none"==search?displayMaster.slice():"applied"==search?displayFiltered.slice():$.map(displayMaster,function(el,i){return-1===$.inArray(el,displayFiltered)?el:null});else if("index"==order||"original"==order)for(i=0,ien=settings.aoData.length;ien>i;i++)"none"==search?a.push(i):(tmp=$.inArray(i,displayFiltered),(-1===tmp&&"removed"==search||tmp>=0&&"applied"==search)&&a.push(i));return a},__row_selector=function(settings,selector,opts){return _selector_run(selector,function(sel){var selInt=_intVal(sel);if(null!==selInt&&!opts)return[selInt];var rows=_selector_row_indexes(settings,opts);if(null!==selInt&&-1!==$.inArray(selInt,rows))return[selInt];if(!sel)return rows;if("function"==typeof sel)return $.map(rows,function(idx){var row=settings.aoData[idx];return sel(idx,row._aData,row.nTr)?idx:null});var nodes=_removeEmpty(_pluck_order(settings.aoData,rows,"nTr"));return sel.nodeName&&-1!==$.inArray(sel,nodes)?[sel._DT_RowIndex]:$(nodes).filter(sel).map(function(){return this._DT_RowIndex}).toArray()})};_api_register("rows()",function(selector,opts){selector===undefined?selector="":$.isPlainObject(selector)&&(opts=selector,selector=""),opts=_selector_opts(opts);var inst=this.iterator("table",function(settings){return __row_selector(settings,selector,opts)},1);return inst.selector.rows=selector,inst.selector.opts=opts,inst}),_api_register("rows().nodes()",function(){return this.iterator("row",function(settings,row){return settings.aoData[row].nTr||undefined},1)}),_api_register("rows().data()",function(){return this.iterator(!0,"rows",function(settings,rows){return _pluck_order(settings.aoData,rows,"_aData")},1)}),_api_registerPlural("rows().cache()","row().cache()",function(type){return this.iterator("row",function(settings,row){var r=settings.aoData[row];return"search"===type?r._aFilterData:r._aSortData},1)}),_api_registerPlural("rows().invalidate()","row().invalidate()",function(src){return this.iterator("row",function(settings,row){_fnInvalidate(settings,row,src)})}),_api_registerPlural("rows().indexes()","row().index()",function(){return this.iterator("row",function(settings,row){return row},1)}),_api_registerPlural("rows().remove()","row().remove()",function(){var that=this;return this.iterator("row",function(settings,row,thatIdx){var data=settings.aoData;data.splice(row,1);for(var i=0,ien=data.length;ien>i;i++)null!==data[i].nTr&&(data[i].nTr._DT_RowIndex=i);$.inArray(row,settings.aiDisplay);_fnDeleteIndex(settings.aiDisplayMaster,row),_fnDeleteIndex(settings.aiDisplay,row),_fnDeleteIndex(that[thatIdx],row,!1),_fnLengthOverflow(settings)})}),_api_register("rows.add()",function(rows){var newRows=this.iterator("table",function(settings){var row,i,ien,out=[];for(i=0,ien=rows.length;ien>i;i++)row=rows[i],row.nodeName&&"TR"===row.nodeName.toUpperCase()?out.push(_fnAddTr(settings,row)[0]):out.push(_fnAddData(settings,row));return out},1),modRows=this.rows(-1);return modRows.pop(),modRows.push.apply(modRows,newRows.toArray()),modRows}),_api_register("row()",function(selector,opts){return _selector_first(this.rows(selector,opts))}),_api_register("row().data()",function(data){var ctx=this.context;return data===undefined?ctx.length&&this.length?ctx[0].aoData[this[0]]._aData:undefined:(ctx[0].aoData[this[0]]._aData=data,_fnInvalidate(ctx[0],this[0],"data"),this)}),_api_register("row().node()",function(){var ctx=this.context;return ctx.length&&this.length?ctx[0].aoData[this[0]].nTr||null:null}),_api_register("row.add()",function(row){row instanceof $&&row.length&&(row=row[0]);var rows=this.iterator("table",function(settings){return row.nodeName&&"TR"===row.nodeName.toUpperCase()?_fnAddTr(settings,row)[0]:_fnAddData(settings,row)});return this.row(rows[0])});var __details_add=function(ctx,row,data,klass){var rows=[],addRow=function(r,k){if($.isArray(r)||r instanceof $)for(var i=0,ien=r.length;ien>i;i++)addRow(r[i],k);else if(r.nodeName&&"tr"===r.nodeName.toLowerCase())rows.push(r);else{var created=$("<tr><td/></tr>").addClass(k);$("td",created).addClass(k).html(r)[0].colSpan=_fnVisbleColumns(ctx),rows.push(created[0])}};addRow(data,klass),row._details&&row._details.remove(),row._details=$(rows),row._detailsShow&&row._details.insertAfter(row.nTr)},__details_remove=function(api,idx){var ctx=api.context;if(ctx.length){var row=ctx[0].aoData[idx!==undefined?idx:api[0]];row._details&&(row._details.remove(),row._detailsShow=undefined,row._details=undefined)}},__details_display=function(api,show){var ctx=api.context;if(ctx.length&&api.length){var row=ctx[0].aoData[api[0]];row._details&&(row._detailsShow=show,show?row._details.insertAfter(row.nTr):row._details.detach(),__details_events(ctx[0]))}},__details_events=function(settings){var api=new _Api(settings),namespace=".dt.DT_details",drawEvent="draw"+namespace,colvisEvent="column-visibility"+namespace,destroyEvent="destroy"+namespace,data=settings.aoData;api.off(drawEvent+" "+colvisEvent+" "+destroyEvent),_pluck(data,"_details").length>0&&(api.on(drawEvent,function(e,ctx){settings===ctx&&api.rows({page:"current"}).eq(0).each(function(idx){var row=data[idx];row._detailsShow&&row._details.insertAfter(row.nTr)})}),api.on(colvisEvent,function(e,ctx,idx,vis){if(settings===ctx)for(var row,visible=_fnVisbleColumns(ctx),i=0,ien=data.length;ien>i;i++)row=data[i],row._details&&row._details.children("td[colspan]").attr("colspan",visible)}),api.on(destroyEvent,function(e,ctx){if(settings===ctx)for(var i=0,ien=data.length;ien>i;i++)data[i]._details&&__details_remove(api,i)}))},_emp="",_child_obj=_emp+"row().child",_child_mth=_child_obj+"()";_api_register(_child_mth,function(data,klass){var ctx=this.context;return data===undefined?ctx.length&&this.length?ctx[0].aoData[this[0]]._details:undefined:(data===!0?this.child.show():data===!1?__details_remove(this):ctx.length&&this.length&&__details_add(ctx[0],ctx[0].aoData[this[0]],data,klass),this)}),_api_register([_child_obj+".show()",_child_mth+".show()"],function(show){return __details_display(this,!0),this}),_api_register([_child_obj+".hide()",_child_mth+".hide()"],function(){return __details_display(this,!1),this}),_api_register([_child_obj+".remove()",_child_mth+".remove()"],function(){return __details_remove(this),this}),_api_register(_child_obj+".isShown()",function(){var ctx=this.context;return ctx.length&&this.length?ctx[0].aoData[this[0]]._detailsShow||!1:!1});var __re_column_selector=/^(.+):(name|visIdx|visible)$/,__columnData=function(settings,column,r1,r2,rows){for(var a=[],row=0,ien=rows.length;ien>row;row++)a.push(_fnGetCellData(settings,rows[row],column));return a},__column_selector=function(settings,selector,opts){var columns=settings.aoColumns,names=_pluck(columns,"sName"),nodes=_pluck(columns,"nTh");return _selector_run(selector,function(s){var selInt=_intVal(s);if(""===s)return _range(columns.length);if(null!==selInt)return[selInt>=0?selInt:columns.length+selInt];if("function"==typeof s){var rows=_selector_row_indexes(settings,opts);return $.map(columns,function(col,idx){return s(idx,__columnData(settings,idx,0,0,rows),nodes[idx])?idx:null})}var match="string"==typeof s?s.match(__re_column_selector):"";if(!match)return $(nodes).filter(s).map(function(){return $.inArray(this,nodes)}).toArray();switch(match[2]){case"visIdx":case"visible":var idx=parseInt(match[1],10);if(0>idx){var visColumns=$.map(columns,function(col,i){return col.bVisible?i:null});return[visColumns[visColumns.length+idx]]}return[_fnVisibleToColumnIndex(settings,idx)];case"name":return $.map(names,function(name,i){return name===match[1]?i:null})}})},__setColumnVis=function(settings,column,vis,recalc){var cells,i,ien,tr,cols=settings.aoColumns,col=cols[column],data=settings.aoData;if(vis===undefined)return col.bVisible;if(col.bVisible!==vis){if(vis){var insertBefore=$.inArray(!0,_pluck(cols,"bVisible"),column+1);for(i=0,ien=data.length;ien>i;i++)tr=data[i].nTr,cells=data[i].anCells,tr&&tr.insertBefore(cells[column],cells[insertBefore]||null)}else $(_pluck(settings.aoData,"anCells",column)).detach();col.bVisible=vis,_fnDrawHead(settings,settings.aoHeader),_fnDrawHead(settings,settings.aoFooter),(recalc===undefined||recalc)&&(_fnAdjustColumnSizing(settings),(settings.oScroll.sX||settings.oScroll.sY)&&_fnScrollDraw(settings)),_fnCallbackFire(settings,null,"column-visibility",[settings,column,vis]),_fnSaveState(settings)}};_api_register("columns()",function(selector,opts){selector===undefined?selector="":$.isPlainObject(selector)&&(opts=selector,selector=""),opts=_selector_opts(opts);var inst=this.iterator("table",function(settings){return __column_selector(settings,selector,opts)},1);return inst.selector.cols=selector,inst.selector.opts=opts,inst}),_api_registerPlural("columns().header()","column().header()",function(selector,opts){return this.iterator("column",function(settings,column){return settings.aoColumns[column].nTh},1)}),_api_registerPlural("columns().footer()","column().footer()",function(selector,opts){return this.iterator("column",function(settings,column){return settings.aoColumns[column].nTf},1)}),_api_registerPlural("columns().data()","column().data()",function(){return this.iterator("column-rows",__columnData,1)}),_api_registerPlural("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(settings,column){return settings.aoColumns[column].mData},1)}),_api_registerPlural("columns().cache()","column().cache()",function(type){return this.iterator("column-rows",function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,"search"===type?"_aFilterData":"_aSortData",column)},1)}),_api_registerPlural("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,"anCells",column)},1)}),_api_registerPlural("columns().visible()","column().visible()",function(vis,calc){return this.iterator("column",function(settings,column){return vis===undefined?settings.aoColumns[column].bVisible:void __setColumnVis(settings,column,vis,calc)})}),_api_registerPlural("columns().indexes()","column().index()",function(type){return this.iterator("column",function(settings,column){return"visible"===type?_fnColumnIndexToVisible(settings,column):column},1)}),_api_register("columns.adjust()",function(){return this.iterator("table",function(settings){_fnAdjustColumnSizing(settings)},1)}),_api_register("column.index()",function(type,idx){if(0!==this.context.length){var ctx=this.context[0];if("fromVisible"===type||"toData"===type)return _fnVisibleToColumnIndex(ctx,idx);if("fromData"===type||"toVisible"===type)return _fnColumnIndexToVisible(ctx,idx)}}),_api_register("column()",function(selector,opts){return _selector_first(this.columns(selector,opts))});var __cell_selector=function(settings,selector,opts){var row,a,i,ien,j,o,host,data=settings.aoData,rows=_selector_row_indexes(settings,opts),cells=_removeEmpty(_pluck_order(data,rows,"anCells")),allCells=$([].concat.apply([],cells)),columns=settings.aoColumns.length;return _selector_run(selector,function(s){var fnSelector="function"==typeof s;if(null===s||s===undefined||fnSelector){for(a=[],i=0,ien=rows.length;ien>i;i++)for(row=rows[i],j=0;columns>j;j++)o={row:row,column:j},fnSelector?(host=settings.aoData[row],s(o,_fnGetCellData(settings,row,j),host.anCells[j])&&a.push(o)):a.push(o);return a}return $.isPlainObject(s)?[s]:allCells.filter(s).map(function(i,el){return row=el.parentNode._DT_RowIndex,{row:row,column:$.inArray(el,data[row].anCells)}}).toArray()})};_api_register("cells()",function(rowSelector,columnSelector,opts){if($.isPlainObject(rowSelector)&&(rowSelector.row===undefined?(opts=rowSelector,rowSelector=null):(opts=columnSelector,columnSelector=null)),$.isPlainObject(columnSelector)&&(opts=columnSelector,columnSelector=null),null===columnSelector||columnSelector===undefined)return this.iterator("table",function(settings){return __cell_selector(settings,rowSelector,_selector_opts(opts))});var a,i,ien,j,jen,columns=this.columns(columnSelector,opts),rows=this.rows(rowSelector,opts),cells=this.iterator("table",function(settings,idx){for(a=[],i=0,ien=rows[idx].length;ien>i;i++)for(j=0,jen=columns[idx].length;jen>j;j++)a.push({row:rows[idx][i],column:columns[idx][j]});return a},1);return $.extend(cells.selector,{cols:columnSelector,rows:rowSelector,opts:opts}),cells}),_api_registerPlural("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(settings,row,column){var cells=settings.aoData[row].anCells;return cells?cells[column]:undefined},1)}),_api_register("cells().data()",function(){return this.iterator("cell",function(settings,row,column){return _fnGetCellData(settings,row,column)},1)}),_api_registerPlural("cells().cache()","cell().cache()",function(type){return type="search"===type?"_aFilterData":"_aSortData",this.iterator("cell",function(settings,row,column){return settings.aoData[row][type][column]},1)}),_api_registerPlural("cells().render()","cell().render()",function(type){return this.iterator("cell",function(settings,row,column){return _fnGetCellData(settings,row,column,type)},1)}),_api_registerPlural("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(settings,row,column){return{row:row,column:column,columnVisible:_fnColumnIndexToVisible(settings,column)}},1)}),_api_registerPlural("cells().invalidate()","cell().invalidate()",function(src){return this.iterator("cell",function(settings,row,column){_fnInvalidate(settings,row,src,column)})}),_api_register("cell()",function(rowSelector,columnSelector,opts){return _selector_first(this.cells(rowSelector,columnSelector,opts))}),_api_register("cell().data()",function(data){var ctx=this.context,cell=this[0];return data===undefined?ctx.length&&cell.length?_fnGetCellData(ctx[0],cell[0].row,cell[0].column):undefined:(_fnSetCellData(ctx[0],cell[0].row,cell[0].column,data),_fnInvalidate(ctx[0],cell[0].row,"data",cell[0].column),this)}),_api_register("order()",function(order,dir){var ctx=this.context;return order===undefined?0!==ctx.length?ctx[0].aaSorting:undefined:("number"==typeof order?order=[[order,dir]]:$.isArray(order[0])||(order=Array.prototype.slice.call(arguments)),this.iterator("table",function(settings){settings.aaSorting=order.slice()}))}),_api_register("order.listener()",function(node,column,callback){return this.iterator("table",function(settings){_fnSortAttachListener(settings,node,column,callback)})}),_api_register(["columns().order()","column().order()"],function(dir){var that=this;return this.iterator("table",function(settings,i){var sort=[];$.each(that[i],function(j,col){sort.push([col,dir])}),settings.aaSorting=sort})}),_api_register("search()",function(input,regex,smart,caseInsen){var ctx=this.context;return input===undefined?0!==ctx.length?ctx[0].oPreviousSearch.sSearch:undefined:this.iterator("table",function(settings){settings.oFeatures.bFilter&&_fnFilterComplete(settings,$.extend({},settings.oPreviousSearch,{sSearch:input+"",bRegex:null===regex?!1:regex,bSmart:null===smart?!0:smart,bCaseInsensitive:null===caseInsen?!0:caseInsen}),1)})}),_api_registerPlural("columns().search()","column().search()",function(input,regex,smart,caseInsen){return this.iterator("column",function(settings,column){var preSearch=settings.aoPreSearchCols;return input===undefined?preSearch[column].sSearch:void(settings.oFeatures.bFilter&&($.extend(preSearch[column],{sSearch:input+"",bRegex:null===regex?!1:regex,bSmart:null===smart?!0:smart,bCaseInsensitive:null===caseInsen?!0:caseInsen}),_fnFilterComplete(settings,settings.oPreviousSearch,1)))})}),_api_register("state()",function(){return this.context.length?this.context[0].oSavedState:null}),_api_register("state.clear()",function(){return this.iterator("table",function(settings){settings.fnStateSaveCallback.call(settings.oInstance,settings,{})})}),_api_register("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),_api_register("state.save()",function(){return this.iterator("table",function(settings){_fnSaveState(settings)})}),DataTable.versionCheck=DataTable.fnVersionCheck=function(version){for(var iThis,iThat,aThis=DataTable.version.split("."),aThat=version.split("."),i=0,iLen=aThat.length;iLen>i;i++)if(iThis=parseInt(aThis[i],10)||0,iThat=parseInt(aThat[i],10)||0,iThis!==iThat)return iThis>iThat;return!0},DataTable.isDataTable=DataTable.fnIsDataTable=function(table){var t=$(table).get(0),is=!1;return $.each(DataTable.settings,function(i,o){var head=o.nScrollHead?$("table",o.nScrollHead)[0]:null,foot=o.nScrollFoot?$("table",o.nScrollFoot)[0]:null;(o.nTable===t||head===t||foot===t)&&(is=!0)}),is},DataTable.tables=DataTable.fnTables=function(visible){return $.map(DataTable.settings,function(o){return!visible||visible&&$(o.nTable).is(":visible")?o.nTable:void 0})},DataTable.util={throttle:_fnThrottle,escapeRegex:_fnEscapeRegex},DataTable.camelToHungarian=_fnCamelToHungarian,_api_register("$()",function(selector,opts){var rows=this.rows(opts).nodes(),jqRows=$(rows);return $([].concat(jqRows.filter(selector).toArray(),jqRows.find(selector).toArray()))}),$.each(["on","one","off"],function(i,key){_api_register(key+"()",function(){var args=Array.prototype.slice.call(arguments);args[0].match(/\.dt\b/)||(args[0]+=".dt");var inst=$(this.tables().nodes());return inst[key].apply(inst,args),this})}),_api_register("clear()",function(){return this.iterator("table",function(settings){_fnClearTable(settings)})}),_api_register("settings()",function(){return new _Api(this.context,this.context)}),_api_register("init()",function(){var ctx=this.context;return ctx.length?ctx[0].oInit:null}),_api_register("data()",function(){return this.iterator("table",function(settings){return _pluck(settings.aoData,"_aData")}).flatten()}),_api_register("destroy()",function(remove){return remove=remove||!1,this.iterator("table",function(settings){var ien,orig=settings.nTableWrapper.parentNode,classes=settings.oClasses,table=settings.nTable,tbody=settings.nTBody,thead=settings.nTHead,tfoot=settings.nTFoot,jqTable=$(table),jqTbody=$(tbody),jqWrapper=$(settings.nTableWrapper),rows=$.map(settings.aoData,function(r){return r.nTr});settings.bDestroying=!0,_fnCallbackFire(settings,"aoDestroyCallback","destroy",[settings]),remove||new _Api(settings).columns().visible(!0),jqWrapper.unbind(".DT").find(":not(tbody *)").unbind(".DT"),$(window).unbind(".DT-"+settings.sInstance),table!=thead.parentNode&&(jqTable.children("thead").detach(),jqTable.append(thead)),tfoot&&table!=tfoot.parentNode&&(jqTable.children("tfoot").detach(),jqTable.append(tfoot)),jqTable.detach(),jqWrapper.detach(),settings.aaSorting=[],settings.aaSortingFixed=[],_fnSortingClasses(settings),$(rows).removeClass(settings.asStripeClasses.join(" ")),$("th, td",thead).removeClass(classes.sSortable+" "+classes.sSortableAsc+" "+classes.sSortableDesc+" "+classes.sSortableNone),settings.bJUI&&($("th span."+classes.sSortIcon+", td span."+classes.sSortIcon,thead).detach(),$("th, td",thead).each(function(){var wrapper=$("div."+classes.sSortJUIWrapper,this);$(this).append(wrapper.contents()),wrapper.detach()})),!remove&&orig&&orig.insertBefore(table,settings.nTableReinsertBefore),jqTbody.children().detach(),jqTbody.append(rows),jqTable.css("width",settings.sDestroyWidth).removeClass(classes.sTable),ien=settings.asDestroyStripes.length,ien&&jqTbody.children().each(function(i){$(this).addClass(settings.asDestroyStripes[i%ien])});var idx=$.inArray(settings,DataTable.settings);-1!==idx&&DataTable.settings.splice(idx,1)})}),$.each(["column","row","cell"],function(i,type){_api_register(type+"s().every()",function(fn){return this.iterator(type,function(settings,idx,idx2){fn.call(new _Api(settings)[type](idx,idx2))})})}),DataTable.version="1.10.6",DataTable.settings=[],DataTable.models={},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null},DataTable.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(toFormat){return toFormat.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(settings){try{return JSON.parse((-1===settings.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+settings.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(settings,data){try{(-1===settings.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+settings.sInstance+"_"+location.pathname,JSON.stringify(data))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null},_fnHungarianMap(DataTable.defaults),DataTable.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},_fnHungarianMap(DataTable.defaults.column),DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:undefined,oAjaxData:undefined,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==_fnDataSource(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==_fnDataSource(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var len=this._iDisplayLength,start=this._iDisplayStart,calc=start+len,records=this.aiDisplay.length,features=this.oFeatures,paginate=features.bPaginate;return features.bServerSide?paginate===!1||-1===len?start+records:Math.min(start+len,this._iRecordsDisplay):!paginate||calc>records||-1===len?records:calc;
},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}},DataTable.ext=_ext={buttons:{},classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:DataTable.version},$.extend(_ext,{afnFiltering:_ext.search,aTypes:_ext.type.detect,ofnSearch:_ext.type.search,oSort:_ext.type.order,afnSortData:_ext.order,aoFeatures:_ext.feature,oApi:_ext.internal,oStdClasses:_ext.classes,oPagination:_ext.pager}),$.extend(DataTable.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var _empty="";_empty="";var _stateDefault=_empty+"ui-state-default",_sortIcon=_empty+"css_right ui-icon ui-icon-",_headerFooter=_empty+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";$.extend(DataTable.ext.oJUIClasses,DataTable.ext.classes,{sPageButton:"fg-button ui-button "+_stateDefault,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:_stateDefault+" sorting_asc",sSortDesc:_stateDefault+" sorting_desc",sSortable:_stateDefault+" sorting",sSortableAsc:_stateDefault+" sorting_asc_disabled",sSortableDesc:_stateDefault+" sorting_desc_disabled",sSortableNone:_stateDefault+" sorting_disabled",sSortJUIAsc:_sortIcon+"triangle-1-n",sSortJUIDesc:_sortIcon+"triangle-1-s",sSortJUI:_sortIcon+"carat-2-n-s",sSortJUIAscAllowed:_sortIcon+"carat-1-n",sSortJUIDescAllowed:_sortIcon+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+_stateDefault,sScrollFoot:"dataTables_scrollFoot "+_stateDefault,sHeaderTH:_stateDefault,sFooterTH:_stateDefault,sJUIHeader:_headerFooter+" ui-corner-tl ui-corner-tr",sJUIFooter:_headerFooter+" ui-corner-bl ui-corner-br"})}();var extPagination=DataTable.ext.pager;$.extend(extPagination,{simple:function(page,pages){return["previous","next"]},full:function(page,pages){return["first","previous","next","last"]},simple_numbers:function(page,pages){return["previous",_numbers(page,pages),"next"]},full_numbers:function(page,pages){return["first","previous",_numbers(page,pages),"next","last"]},_numbers:_numbers,numbers_length:7}),$.extend(!0,DataTable.ext.renderer,{pageButton:{_:function(settings,host,idx,buttons,page,pages){var btnDisplay,btnClass,activeEl,classes=settings.oClasses,lang=settings.oLanguage.oPaginate,counter=0,attach=function(container,buttons){var i,ien,node,button,clickHandler=function(e){_fnPageChange(settings,e.data.action,!0)};for(i=0,ien=buttons.length;ien>i;i++)if(button=buttons[i],$.isArray(button)){var inner=$("<"+(button.DT_el||"div")+"/>").appendTo(container);attach(inner,button)}else{switch(btnDisplay="",btnClass="",button){case"ellipsis":container.append('<span class="ellipsis">&#x2026;</span>');break;case"first":btnDisplay=lang.sFirst,btnClass=button+(page>0?"":" "+classes.sPageButtonDisabled);break;case"previous":btnDisplay=lang.sPrevious,btnClass=button+(page>0?"":" "+classes.sPageButtonDisabled);break;case"next":btnDisplay=lang.sNext,btnClass=button+(pages-1>page?"":" "+classes.sPageButtonDisabled);break;case"last":btnDisplay=lang.sLast,btnClass=button+(pages-1>page?"":" "+classes.sPageButtonDisabled);break;default:btnDisplay=button+1,btnClass=page===button?classes.sPageButtonActive:""}btnDisplay&&(node=$("<a>",{"class":classes.sPageButton+" "+btnClass,"aria-controls":settings.sTableId,"data-dt-idx":counter,tabindex:settings.iTabIndex,id:0===idx&&"string"==typeof button?settings.sTableId+"_"+button:null}).html(btnDisplay).appendTo(container),_fnBindAction(node,{action:button},clickHandler),counter++)}};try{activeEl=$(document.activeElement).data("dt-idx")}catch(e){}attach($(host).empty(),buttons),activeEl&&$(host).find("[data-dt-idx="+activeEl+"]").focus()}}}),$.extend(DataTable.ext.type.detect,[function(d,settings){var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal)?"num"+decimal:null},function(d,settings){if(d&&!(d instanceof Date)&&(!_re_date_start.test(d)||!_re_date_end.test(d)))return null;var parsed=Date.parse(d);return null!==parsed&&!isNaN(parsed)||_empty(d)?"date":null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal,!0)?"num-fmt"+decimal:null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal)?"html-num"+decimal:null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal,!0)?"html-num-fmt"+decimal:null},function(d,settings){return _empty(d)||"string"==typeof d&&-1!==d.indexOf("<")?"html":null}]),$.extend(DataTable.ext.type.search,{html:function(data){return _empty(data)?data:"string"==typeof data?data.replace(_re_new_lines," ").replace(_re_html,""):""},string:function(data){return _empty(data)?data:"string"==typeof data?data.replace(_re_new_lines," "):data}});var __numericReplace=function(d,decimalPlace,re1,re2){return 0===d||d&&"-"!==d?(decimalPlace&&(d=_numToDecimal(d,decimalPlace)),d.replace&&(re1&&(d=d.replace(re1,"")),re2&&(d=d.replace(re2,""))),1*d):-(1/0)};return $.extend(_ext.type.order,{"date-pre":function(d){return Date.parse(d)||0},"html-pre":function(a){return _empty(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return _empty(a)?"":"string"==typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(x,y){return y>x?-1:x>y?1:0},"string-desc":function(x,y){return y>x?1:x>y?-1:0}}),_addNumericSort(""),$.extend(!0,DataTable.ext.renderer,{header:{_:function(settings,cell,column,classes){$(settings.nTable).on("order.dt.DT",function(e,ctx,sorting,columns){if(settings===ctx){var colIdx=column.idx;cell.removeClass(column.sSortingClass+" "+classes.sSortAsc+" "+classes.sSortDesc).addClass("asc"==columns[colIdx]?classes.sSortAsc:"desc"==columns[colIdx]?classes.sSortDesc:column.sSortingClass)}})},jqueryui:function(settings,cell,column,classes){$("<div/>").addClass(classes.sSortJUIWrapper).append(cell.contents()).append($("<span/>").addClass(classes.sSortIcon+" "+column.sSortingClassJUI)).appendTo(cell),$(settings.nTable).on("order.dt.DT",function(e,ctx,sorting,columns){if(settings===ctx){var colIdx=column.idx;cell.removeClass(classes.sSortAsc+" "+classes.sSortDesc).addClass("asc"==columns[colIdx]?classes.sSortAsc:"desc"==columns[colIdx]?classes.sSortDesc:column.sSortingClass),cell.find("span."+classes.sSortIcon).removeClass(classes.sSortJUIAsc+" "+classes.sSortJUIDesc+" "+classes.sSortJUI+" "+classes.sSortJUIAscAllowed+" "+classes.sSortJUIDescAllowed).addClass("asc"==columns[colIdx]?classes.sSortJUIAsc:"desc"==columns[colIdx]?classes.sSortJUIDesc:column.sSortingClassJUI)}})}}}),DataTable.render={number:function(thousands,decimal,precision,prefix){return{display:function(d){if("number"!=typeof d&&"string"!=typeof d)return d;var negative=0>d?"-":"";d=Math.abs(parseFloat(d));var intPart=parseInt(d,10),floatPart=precision?decimal+(d-intPart).toFixed(precision).substring(2):"";return negative+(prefix||"")+intPart.toString().replace(/\B(?=(\d{3})+(?!\d))/g,thousands)+floatPart}}}},$.extend(DataTable.ext.internal,{_fnExternApiFunc:_fnExternApiFunc,_fnBuildAjax:_fnBuildAjax,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnAjaxDataSrc:_fnAjaxDataSrc,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnVisbleColumns:_fnVisbleColumns,_fnGetColumns:_fnGetColumns,_fnColumnTypes:_fnColumnTypes,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnHungarianMap:_fnHungarianMap,_fnCamelToHungarian:_fnCamelToHungarian,_fnLanguageCompat:_fnLanguageCompat,_fnBrowserDetect:_fnBrowserDetect,_fnAddData:_fnAddData,_fnAddTr:_fnAddTr,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnSplitObjNotation:_fnSplitObjNotation,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnGetDataMaster:_fnGetDataMaster,_fnClearTable:_fnClearTable,_fnDeleteIndex:_fnDeleteIndex,_fnInvalidate:_fnInvalidate,_fnGetRowElements:_fnGetRowElements,_fnCreateTr:_fnCreateTr,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnEscapeRegex:_fnEscapeRegex,_fnFilterData:_fnFilterData,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnInfoMacros:_fnInfoMacros,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLengthChange:_fnLengthChange,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnApplyToChildren:_fnApplyToChildren,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnThrottle:_fnThrottle,_fnConvertToWidth:_fnConvertToWidth,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnScrollBarWidth:_fnScrollBarWidth,_fnSortFlatten:_fnSortFlatten,_fnSort:_fnSort,_fnSortAria:_fnSortAria,_fnSortListener:_fnSortListener,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnSortData:_fnSortData,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnSettingsFromNode:_fnSettingsFromNode,_fnLog:_fnLog,_fnMap:_fnMap,_fnBindAction:_fnBindAction,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnLengthOverflow:_fnLengthOverflow,_fnRenderer:_fnRenderer,_fnDataSource:_fnDataSource,_fnRowAttributes:_fnRowAttributes,_fnCalculateEnd:function(){}}),$.fn.dataTable=DataTable,$.fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext,$.fn.DataTable=function(opts){return $(this).dataTable(opts).api()},$.each(DataTable,function(prop,val){$.fn.DataTable[prop]=val}),$.fn.dataTable})}(window,document),$.extend($.fn.dataTableExt.oStdClasses,{sPageEllipsis:"ccm-pagination-ellipses",sPageNumber:"ajaxEnabled",sPageNumbers:"inline-paging"}),$.fn.dataTableExt.oPagination.cambridge_pagination={oDefaults:{iShowPages:5},fnClickHandler:function(e){var fnCallbackDraw=e.data.fnCallbackDraw,oSettings=e.data.oSettings,sPage=e.data.sPage;return $(this).is("[disabled]")?!1:(oSettings.oApi._fnPageChange(oSettings,sPage),fnCallbackDraw(oSettings),!0)},fnInit:function(oSettings,nPager,fnCallbackDraw){var oClasses=oSettings.oClasses,oLang=oSettings.oLanguage.oPaginate,that=this,iShowPages=oSettings.oInit.iShowPages||this.oDefaults.iShowPages,iShowPagesHalf=Math.floor(iShowPages/2);$.extend(oSettings,{_iShowPages:iShowPages,_iShowPagesHalf:iShowPagesHalf});var paginationContainer=$('<div class="twelve columns listingPagination headerPagination"></div>'),leftColumn=$('<div class="four mobile-one columns pagingSide paging-col-1"></div>'),midColumn=$('<div class="four mobile-two columns paging-col-2"></div>'),rightColumn=$('<div class="four mobile-one columns dropdownSide paging-col-3"></div>'),pageMapInfo=$('<div class="paging-position"><p class="totalResourceCount"></p><span></span></div>'),navButtons=$('<ul class="buttons"></ul>'),oPrevious=$('<li class="previous"><a class="paginationOn ajaxEnabled hidden">'+oLang.sPrevious+"</a>"),oNumbers=$('<div class="'+oClasses.sPageNumbers+'"></div>'),oNext=$('<li class="next"><a class="paginationOn ajaxEnabled hidden">'+oLang.sNext+"</a></li>");navButtons.append(oPrevious,oNext),leftColumn.append(pageMapInfo),midColumn.append(oNumbers),rightColumn.append(navButtons),paginationContainer.append(leftColumn,midColumn,rightColumn),oPrevious.click({fnCallbackDraw:fnCallbackDraw,oSettings:oSettings,sPage:"previous"},that.fnClickHandler),oNext.click({fnCallbackDraw:fnCallbackDraw,oSettings:oSettings,sPage:"next"},that.fnClickHandler),$(nPager).append(paginationContainer)},fnUpdate:function(oSettings,fnCallbackDraw){var oClasses=oSettings.oClasses,that=this,tableWrapper=oSettings.nTableWrapper;this.fnUpdateState(oSettings),1===oSettings._iCurrentPage?($("."+oClasses.sPageFirst,tableWrapper).attr("disabled",!0),$("."+oClasses.sPagePrevious,tableWrapper).attr("disabled",!0)):($("."+oClasses.sPageFirst,tableWrapper).removeAttr("disabled"),$("."+oClasses.sPagePrevious,tableWrapper).removeAttr("disabled")),0===oSettings._iTotalPages||oSettings._iCurrentPage===oSettings._iTotalPages?($("."+oClasses.sPageNext,tableWrapper).attr("disabled",!0),$("."+oClasses.sPageLast,tableWrapper).attr("disabled",!0)):($("."+oClasses.sPageNext,tableWrapper).removeAttr("disabled"),$("."+oClasses.sPageLast,tableWrapper).removeAttr("disabled"));var i,oNumber,oNumbers=$("."+oClasses.sPageNumbers,tableWrapper),$pageMapInfo=$(".paging-position span"),$nextButton=$("li.next a"),$prevButton=$("li.previous a"),ellipses='<span class="'+oClasses.sPageEllipsis+'">...</span>';$(".paging-col-2");for($pageMapInfo.html("Page "+oSettings._iCurrentPage+" of "+(0===oSettings._iTotalPages?1:oSettings._iTotalPages)),oNumbers.html(""),i=oSettings._iFirstPage;i<=oSettings._iLastPage;i++)oNumber=$('<span class="paginationOn"><a>'+oSettings.fnFormatNumber(i)+"</a></span>"),oSettings._iCurrentPage===i?(oNumber.addClass("currentPage active"),oNumber.removeClass("paginationOn"),oNumber.html("<strong>"+oSettings.fnFormatNumber(i)+"</strong>")):(oNumber.removeClass("currentPage active"),oNumber.addClass("paginationOn"),oNumber.html("<a>"+oSettings.fnFormatNumber(i)+"</a>"),oNumber.click({fnCallbackDraw:fnCallbackDraw,oSettings:oSettings,sPage:i-1},that.fnClickHandler)),oNumbers.append(oNumber);if(1<oSettings._iFirstPage){var $firstPage=$('<span class="paginationOn"><a>1</a></span>'),prependEllipses=oSettings._iCurrentPage!==oSettings._iShowPages-(oSettings._iShowPagesHalf-1);$firstPage.click({fnCallbackDraw:fnCallbackDraw,oSettings:oSettings,sPage:0},that.fnClickHandler),oNumbers.prepend($firstPage,prependEllipses?ellipses:"")}if(oSettings._iLastPage<oSettings._iTotalPages){var $lastPage=$('<span class="paginationOn"><a>'+oSettings.fnFormatNumber(oSettings._iTotalPages)+"</a></span>"),appendEllipses=oSettings._iCurrentPage!==oSettings._iTotalPages-Math.ceil(oSettings._iShowPages/2);$lastPage.click({fnCallbackDraw:fnCallbackDraw,oSettings:oSettings,sPage:oSettings._iTotalPages-1},that.fnClickHandler),oNumbers.append(appendEllipses?ellipses:"",$lastPage)}oSettings._iHasNextPage?$nextButton.removeClass("hidden"):$nextButton.addClass("hidden"),oSettings._iHasPrevPage?$prevButton.removeClass("hidden"):$prevButton.addClass("hidden")},fnUpdateState:function(oSettings){var iCurrentPage=Math.ceil((oSettings._iDisplayStart+1)/oSettings._iDisplayLength),iTotalPages=Math.ceil(oSettings.fnRecordsDisplay()/oSettings._iDisplayLength),iFirstPage=iCurrentPage-oSettings._iShowPagesHalf,iLastPage=iCurrentPage+oSettings._iShowPagesHalf;iTotalPages<oSettings._iShowPages?(iFirstPage=1,iLastPage=iTotalPages):1>iFirstPage?(iFirstPage=1,iLastPage=oSettings._iShowPages):iLastPage>iTotalPages&&(iFirstPage=iTotalPages-oSettings._iShowPages+1,iLastPage=iTotalPages),$.extend(oSettings,{_iCurrentPage:iCurrentPage,_iTotalPages:iTotalPages,_iFirstPage:iFirstPage,_iLastPage:iLastPage,_iHasNextPage:iLastPage>iCurrentPage,_iHasPrevPage:iCurrentPage>iFirstPage})}},jQuery.fn.dataTableExt.oApi.fnFilterClear=function(oSettings){var i,iLen;if(oSettings.oPreviousSearch.sSearch="","undefined"!=typeof oSettings.aanFeatures.f){var n=oSettings.aanFeatures.f;for(i=0,iLen=n.length;iLen>i;i++)$("input",n[i]).val("")}for(i=0,iLen=oSettings.aoPreSearchCols.length;iLen>i;i++)oSettings.aoPreSearchCols[i].sSearch="";oSettings.oApi._fnReDraw(oSettings)},function($,window,undefined){"use strict";var $doc=$(document),Modernizr=window.Modernizr;$.fn.foundationAlerts?$doc.foundationAlerts():null,$.fn.foundationAccordion?$doc.foundationAccordion():null,$.fn.foundationTooltips?$doc.foundationTooltips():null,$("input, textarea").placeholder(),$.fn.foundationButtons?$doc.foundationButtons():null,$.fn.foundationNavigation?$doc.foundationNavigation():null,$.fn.foundationTopBar?$doc.foundationTopBar():null,$.fn.foundationCustomForms?$doc.foundationCustomForms():null,$.fn.foundationMediaQueryViewer?$doc.foundationMediaQueryViewer():null,$.fn.foundationTabs?$doc.foundationTabs():null,$("#featured").orbit(),Modernizr.touch&&$(window).load(function(){0==$doc.scrollTop()&&setTimeout(function(){window.scrollTo(0,1)},0)})}(jQuery,this),$.fn.equalHeights=function(){return this.height(Math.max.apply(this,$.map(this,function(e){return $(e).height()})))},$(function(){function countHiddenSlides(tab){var counter=0;return $("#"+tab+" > div.products-slider > div").each(function(){"none"==$(this).css("display")&&counter++}),counter}var windowWidth=$(window).width();$("#featuredContent").orbit({bullets:!0,directionalNav:!1,advanceSpeed:6e3,captions:!0,pauseOnHover:!0,startClockOnMouseOut:!0}),windowWidth>767&&$(".products-slider").each(function(){$(this).orbit({fluid:"930x375",timer:!1,bullets:!0,pauseOnHover:!0,startClockOnMouseOut:!0})}),windowWidth>767&&$("#news-slider").orbit({fluid:"429x133",timer:!1,bullets:!1,startClockOnMouseOut:!0}),$("#tab-dropdown").on("click",function(e){$(this).toggleClass("open"),$("#product-tabs").slideToggle(),e.preventDefault()}),$("#product-tabs dd").on("click",function(e){if(e.preventDefault(),$("#tab-dropdown").is(":visible")){$("#tab-dropdown").toggleClass("open");var text=$(this).find("a").text();if(767>windowWidth&&$("#product-tabs").slideToggle(),$("#selected-tab").text(text),767>windowWidth){var currentTab=$(this).find("a").attr("href").replace("#","")+"Tab",hiddenSlideCount=countHiddenSlides(currentTab),loadMore=$("#load-more-books"),loadMoreLinkName=text.toLowerCase();"all featured"==loadMoreLinkName&&(loadMoreLinkName="featured titles"),loadMore.html("More "+loadMoreLinkName),hiddenSlideCount>=1?"none"==loadMore.css("display")&&loadMore.css({display:"inline-block"}):loadMore.css({display:"none"})}}}),$(window).on("orientationchange",function(e){$(window).width()>767&&$("#product-tabs").is(":hidden")&&($("#product-tabs").show(),$("#product-tabs").css("height","65px"),$("#product-tabs").css("margin-bottom","25px")),$(window).width()<768&&($("#tab-dropdown").hasClass("open")?$("#product-tabs").show():$("#product-tabs").hide(),$("#product-tabs").css("height","auto"),$("#product-tabs").css("margin-bottom","0"))}),$(window).resize(function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||($(window).width()>767&&$("#product-tabs").is(":hidden")&&($("#product-tabs").show(),$("#product-tabs").css("height","68px"),$("#product-tabs").css("margin-bottom","22px")),$(window).width()<768&&($("#tab-dropdown").is(":visible")&&($("#tab-dropdown").hasClass("open")?$("#product-tabs").show():$("#product-tabs").hide(),$("#product-tabs").css("height","auto"),$("#product-tabs").css("margin-bottom","0")),$("#tab-dropdown").is(":hidden")&&$("#product-tabs").is(":hidden")&&$("#product-tabs").show(),$("#selected-tab").text($("#product-tabs").find("dd.active a").text())))}),$("#load-more-books").on("click",function(){var $div=$("#featured-tabs").children("li.active").find(".products-slider").children("div:hidden");return $div.first().slideDown(),1==$div.length&&$(this).fadeOut(),!1}),767>windowWidth&&($(".news-section .toggle-section").hide(),$(".closed-section").hide(),$(".toggle-title").on("click",function(){$(this).find(".toggle-icon").toggleClass("open"),$(this).next(".toggle-section").slideToggle()}))}),!CWS_ECOMMERCE_ENABLED){var alreadyClicked=!1,cartItemCount=0,currency="$",subTotal=0,hasAsp=!1,errorCallBack=function(){1>cartItemCount&&jQuery(".viewCart").hide(),jQuery("#itemAddedMessage").text("There was a problem getting your cart information."),jQuery("#itemAddedModal").reveal()},completeCallBack=function(){alreadyClicked=!1,countryChange=!0,jQuery("body").css("cursor","auto")},addToCartEvent=function(event){event.preventDefault(),0==alreadyClicked&&(alreadyClicked=!0,jQuery("body").css("cursor","wait"),addToCart(jQuery(this).data()))};jQuery(function(){function getKonakartService(){jQuery(".addToCartBtn").live("click",addToCartEvent),jQuery.ajax({url:KK_MINI_CART,dataType:"xml",success:mini_cart_successful,error:function(){jQuery("#miniCartDetail .qty").show(),jQuery("#cartQty").html("("+jQuery("#qtyValue").html()+")")},cache:!1})}function getVyreService(){jQuery(".addToCartBtn.konakartLink").length>0&&jQuery(".addToCartBtn.konakartLink").live("click",addToCartEvent),$.ajax({url:"/tools/packages/cambridge_themes/miniCart",data:{source:"Academic_v1"},success:function(data){if(0==$("#qtyValue").html()){jQuery("#cartQty").html("");var cartOpt={url:KK_MINI_CART,dataType:"xml",success:mini_cart_successful,error:function(){jQuery("#miniCartDetail .qty").show(),jQuery("#cartQty").html("("+jQuery("#qtyValue").html()+")")},cache:!1};jQuery.ajax(cartOpt),jQuery("a.viewCart").attr("href",VYRE_BASKET),jQuery("a.academicCheckout").attr("href",VYRE_BASKET);var minicartDetail='<p class="qty">You have <span id="qtyString"><span id="qtyValue">0</span>&nbsp;items</span> in your cart.</p><div id="miniCartItems"></div><div class="withItems" style="display:none;"><div id="subtotal"><h4>Subtotal: <span id="subtotalValue">0.0</span></h4></div><div class="clearfix"></div><div id="buttons"><a href="'+VYRE_BASKET+'" class="button blue large viewCart">View cart <span class="viewCartCountAcademic_v1" style="display:none;">(0)</span></a><a href="'+VYRE_BASKET+'" class="button orange large checkout academicCheckout">Checkout</a></div></div>';$("#miniCartDetail").html(minicartDetail)}else hasAsp=!0}})}"A"===VISTA_SERVICE_REGION&&"0"===IS_KK_AUS||"E"===VISTA_SERVICE_REGION&&"0"===IS_KK_ASIA?IS_KK_ACS_ENABLED>0&&getVyreService():getKonakartService()});var add_to_cart_successful=function(data,textStatus,isbn){var $cartData=jQuery(data),cartErrorMessage=$cartData.find("errorMessage").text().trim(),cartInfoMessage=$cartData.find("infoMessage").text().trim(),cartLines=processCartData(data);refresh_cart(cartLines),""!==cartErrorMessage?(jQuery("#addToCartCustom h4").html(cartErrorMessage),jQuery("#addToCartCustom h4").css("text-transform","none"),jQuery("#addToCartCustom").reveal()):""!==cartInfoMessage?(jQuery("#addToCartCustom h4").html(cartInfoMessage),jQuery("#addToCartCustom h4").css("text-transform","none"),jQuery("#addToCartCustom").reveal()):(1>cartItemCount&&jQuery(".viewCart").hide(),jQuery("#itemAddedMessage").text("Item added to your cart!"),jQuery("#itemAddedModal").reveal(),googleTagManager(isbn))},mini_cart_successful=function(data,textStatus){var cartLines=processCartData(data);refresh_cart(cartLines)},processCartData=function(xml){cartItemCount=0,currency="$",subTotal=0;var $cartData=jQuery(xml),cartLines=[];return currency=$cartData.find("symbol").text(),subTotal=$cartData.find("totalValueOverride").text(),$cartData.find("orderLines").find("orderLine").each(function(){var data=[];data.availabilityLegend=getXMLValue("availabilityLegend",this),cartItemCount+=getXMLValue("quantity",this)?parseInt(getXMLValue("quantity",this)):1,data.title=getXMLValue("title",this),data.author=getXMLValue("author",this);var price=getXMLValue("publishedPriceOverride",this);data.price=price.length>0?price:getXMLValue("originalValue",this),data.price=data.price.replace(",",""),data.discountPrice=getXMLValue("publishedPriceOverride",this),data.discountPrice=data.discountPrice.replace(",",""),data.ean=getXMLValue("ean",this),data.quantity=getXMLValue("quantity",this).replace(",",""),data.format=getXMLValue("format",this);var volumeNumber=getXMLValue("volumeNumber",this);data.volume=volumeNumber.length>0&&"0"!=volumeNumber?"Volume "+volumeNumber:"";var partNumber=getXMLValue("partNumber",this);data.part=partNumber.length>0&&"0"!=partNumber?"Part "+partNumber:"";var edition=getXMLValue("edition",this);data.edition=edition.length>0?edition+" Edition":"";var lastModified=new Date(getXMLValue("lastModified",this));data.lastModified=lastModified.getTime(),cartLines.push(data)}),cartLines.sort(function(a,b){return a.lastModified-b.lastModified}),cartLines},getXMLValue=function(key,container){return jQuery(container).find(key).text()},refresh_cart=function(cartLines){if(cartLines.length>0){var $miniCartDetail=jQuery("#miniCartDetail"),$learningQty=jQuery("p.qty #qtyString",$miniCartDetail),$miniCartItems=jQuery("#miniCartItems"),$subTotal=jQuery("#subtotalValue"),cartItemString='<span id="qtyValue">'+cartItemCount+"</span>"+(0==cartItemCount||cartItemCount>1?" items":" item");$learningQty.html(cartItemString);for(var cartItems="",itemDisplayCount=1,i=0;i<cartLines.length&&(cartItems+='<h4><a href="/'+cartLines[i].ean+'">'+cartLines[i].title+"</a></h4>",cartItems+="<p>"+cartLines[i].volume+" "+cartLines[i].part+" "+cartLines[i].edition+"<span> "+cartLines[i].author+"</span></p>",cartItems+="<p>"+cartLines[i].format+"</p>",cartItems+="<p>"+cartLines[i].availabilityLegend+" | Qty: "+cartLines[i].quantity+" | Price: "+currency+(parseFloat(cartLines[i].quantity)*parseFloat(cartLines[i].price)).toFixed(2)+"</p>",itemDisplayCount++,!(itemDisplayCount>3&&"cambridgeenglish"===CURRENT_SITE));i++);$miniCartItems.html(cartItems),$subTotal.html(currency+subTotal),jQuery("#mobileCartQty").html("("+jQuery("#qtyValue").html()+")"),jQuery(".withItems").show()}else 0==jQuery("#miniCartItems > h4").length&&jQuery(".withItems").hide(),jQuery("#miniCartDetail .qty").show();jQuery("#cartQty").html("("+jQuery("#qtyValue").html()+")")},addToCart=function(data){var params={isbn:isbn="undefined"!=typeof data.isbn?data.isbn:"",locale:"undefined"!=typeof data.country?data.country:"",page:"undefined"!=typeof data.page?data.page:"",discountCode:"undefined"!=typeof data.discountcode?data.discountcode:""};"schools"===params.page&&(params.institutiononly="undefined"!=typeof data.institutiononly?data.institutiononly:0,params.qty="undefined"!=typeof data.qty?data.qty:"");var urlTarget=location.protocol+"//"+location.host+"/wm-ecommerce-web/"+params.page+"/addtocart?"+$.param(params);jQuery.ajax({url:urlTarget,dataType:"xml",success:function(data,textStatus){add_to_cart_successful(data,textStatus,isbn)},error:errorCallBack,complete:completeCallBack,cache:!1})},getCartItems=function(callback){var urlTarget=location.protocol+"//"+location.host+"/wm-ecommerce-web/ws/getItems";$.ajax({url:urlTarget,crossDomain:!0}).done(callback)}}!function($){"use strict";var isFeedbackFormLoaded=!1;$(function(){$(document).on("click",'a[data-ajax-reveal-id="yourFeedback"]',function(event){event.preventDefault();var $containerId=$(this).data("ajax-reveal-id"),$container=$("#"+$containerId);if(isFeedbackFormLoaded)$container.reveal({open:function(){$("#featuredContent").trigger("orbit.stop")},close:revealCloseCallback});else{var $opt={url:CCM_REL+"/tools/packages/cambridge_themes/ajax_load_area",data:{pageID:CCM_CID,arHandle:"gac_feedback",isGlobal:!0},success:renderAndReveal($container)};$.ajax($opt)}});var renderAndReveal=function($container){return function(data,textStatus){$container.html(data),$container.reveal({open:revealOpenCallback,close:revealCloseCallback}),isFeedbackFormLoaded=!0}}});var revealOpenCallback=function(){$("form.rsForm.validate-form").validationEngine("attach",{maxErrorsPerField:1,promptPosition:"inline",scroll:!0,prettySelect:!0,usePrefix:"dk_container_",ajaxFormValidation:!0,ajaxFormValidationMethod:"post",onAjaxFormComplete:feedbackFormComplete}).queue(function(){"undefined"!=typeof validate_form?validate_form&&$("form.rsForm.validate-form:not('#feedback_form')").validationEngine("validate"):"undefined"!=typeof feedback_validate_form&&feedback_validate_form&&$("#feedback_form").validationEngine("validate")}),navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/i)||$(".pretty.dk[class*='validate[required]']").dropkick({change:dropkickSelectChange}),$("#featuredContent").trigger("orbit.stop")},revealCloseCallback=function(){$("#featuredContent").trigger("orbit.start")},feedbackFormComplete=function(status,form,returnObj,options){var $confirmation=$("<div/>").html("<div style='display:none;margin-bottom:10px;'><span class='success label' style='padding:5px;'>"+returnObj.statusText+"</span></div>").contents();$("#yourFeedback").prepend($confirmation),$confirmation.fadeIn().delay(2e3).fadeOut().delay(500).queue(function(){$("#yourFeedback").trigger("reveal:close"),form_reset(form)})},form_reset=function($form){$form.find(":input").each(function(){switch(this.type){case"password":case"select-multiple":case"select-one":case"text":case"textarea":case"email":$(this).val("");break;case"checkbox":case"radio":this.checked=!1}})}}(jQuery),$(function(){$("select[data-otherelement][data-otherval]").change(enableFromSelect),$("#titleSelect").change(function(){var val=$(this).val(),isbn=$("#isbn"),journalvol=$("#journalvol");"book"==val||"audioCD"==val||"cdrom"==val?(journalvol.parent().hide(),journalvol.val(""),isbn.parent().show()):"journal"==val&&(isbn.parent().hide(),isbn.val(""),journalvol.parent().show())}),$("form.rsForm.validate-form").validationEngine("attach",{promptPosition:"inline",scroll:!0,prettySelect:!0,usePrefix:"dk_container_"}).queue(function(){"undefined"!=typeof validate_form?validate_form&&$("form.rsForm.validate-form:not('#feedback_form')").validationEngine("validate"):"undefined"!=typeof feedback_validate_form&&feedback_validate_form&&$("#feedback_form").validationEngine("validate")}),$("select[class='validate[required]']").change(foundationSelectChange),$(".pretty.dk[class*='validate[required]']").dropkick({change:dropkickSelectChange}),navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/i)&&($(".custom select").css({top:2,visibility:"visible",display:"block",position:"absolute","z-index":9999,width:"100%",height:28,opacity:0}),$(document).off("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector"),$(document).on("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(e){e.preventDefault()}),$("select[data-otherelement][data-otherval]").unbind("change",enableFromSelect),$("select[data-otherelement][data-otherval]").quickChange(enableFromSelect))});var foundationSelectChange=function(value,label){""==$(this).val()?$(this).validationEngine("showPrompt","* This field is required","error","inline"):$(this).validationEngine("hide")},dropkickSelectChange=function(value,label){""==value?$("#dk_container_"+$(this).attr("id")).validationEngine("showPrompt","* This field is required","error","inline"):$("#dk_container_"+$(this).attr("id")).validationEngine("hide");
},enableFromSelect=function(){var otherelement="#"+$(this).data("otherelement"),otherval=$(this).data("otherval");$(this).val()==otherval?($(otherelement).removeAttr("disabled"),navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/i)||$(otherelement).focus()):($(otherelement).attr("disabled","disabled"),$(otherelement).val(""))};if($.fn.quickChange=function(handler){return this.each(function(){function handleChange(){self.selectedIndex!=self.qcindex&&(self.qcindex=self.selectedIndex,handler.apply(self))}var self=this;self.qcindex=self.selectedIndex;var interval;$(self).focus(function(){interval=setInterval(handleChange,100)}).blur(function(){window.clearInterval(interval)}).change(handleChange)})},function($){"use strict";var adjustNav=function(){var $mainNavLists=$(".mainNav > li");if(window.innerWidth>=768){var minimumPadding=10,$nav=$(".mainNav"),$mainNavLinks=$(".mainNav > li > a");$nav.removeClass("two-line-nav withDigitalLearning");var navItems=[],navWidth=0;$mainNavLists.each(function(){$(this).is(":visible")&&($(this).css("display","inline"),$(this).css("width","auto"),navItems.push($(this)),navWidth+=$(this).width())});var numNavItems=navItems.length,availableWidth=$nav.width(),availablePadding=availableWidth-navWidth,padding=Math.floor(availablePadding/numNavItems),factor=99.99/availableWidth,percentageWidth=0;$mainNavLists.each(function(){$(this).is(":visible")&&(percentageWidth=($(this).width()+padding)*factor,$(this).width(percentageWidth+"%"))}),$(document).width()>960&&minimumPadding>padding&&$mainNavLinks.css("font-size",parseInt($mainNavLinks.css("font-size"))-1+"px"),1>padding&&$(document).width()<960&&$mainNavLinks.css("padding-top","9px")}else $mainNavLists.width("100%")};$("#popular-links-btn").click(function(){$("#popular-links-modal").reveal()}),$(document).on("click",".clickable-on-hover",function(e){var mobileHoveredClass="mobile-hovered";(isMobile||isTablet)&&($(this).hasClass(mobileHoveredClass)||e.preventDefault(),$(".clickable-on-hover").removeClass(mobileHoveredClass),$(this).addClass(mobileHoveredClass))}),$(document).ready(function(){adjustNav()}),$(window).smartresize(function(){window.innerWidth>767?($(".clickable-on-hover").removeClass("mobile-hovered"),$(".mainNav").show()):$(".mobileHeader > .mainNavToggle").hasClass("mainNavToggleOpen")||$(".mainNav").hide(),adjustNav()})}(jQuery),CWS_ECOMMERCE_ENABLED&&"ZA"!=Locale.countryCode&&"NG"!=Locale.countryCode){var MiniCart=new function(){var self=this,hasInit=!1,qty=0,items=[],hasIoProduct=!1;self.init=function(){hasInit||(hasInit=!0,self.initPopupBody(),$("#itemAddedModal .button.viewCart").attr("href","/cart"),self.getItemsFromKk().then(function(){return new Promise(function(resolve,reject){0==items.length?reject():(self.updateQtyInLink(),self.updatePopupBody(),resolve())})})["catch"](function(msg){self.updateQtyInLink(),msg&&console.warn(msg)}))},self.initPopupBody=function(){if($("#cart.reveal-modal").length>0){var html='<p class="lead">Your Cart</p><a class="close-reveal-modal close-cart">&times;</a><p class="qty-summary">You have <span class="qty">no</span> <span class="unit">items</span> in your cart.</p><div class="items"></div><div class="subtotal hide"><h4>Subtotal: <span class="currency"></span><span class="value"></span></h4></div><div class="buttons hide"><a href="/cart" class="button blue large viewCart">View cart <span class="viewCartCountAcademic_v1" style="display:none;">(0)</span></a>'+getRightHandSideButtonHtml()+"</div>";$("#cart.reveal-modal").html(html)}},self.getItemsFromKk=function(){return new Promise(function(resolve,reject){var kkSessionId=Cambridge.getCookie("KK_SESSION_ID"),kkCustomerId=Cambridge.getCookie("KK_CUSTOMER_ID");return null==kkSessionId&&null==kkCustomerId?void reject():void $.ajax({url:"/tools/packages/cws_ecommerce/getBasketItemsPerCustomerWithOptions",type:"post",data:{},success:function(data){items=data,items.length>0&&(qty=0,items.forEach(function(item){qty+=item.quantity})),resolve()},error:function(data){reject(data.responseText)},cache:!1})})},self.getCheckoutLink=function(){$.ajax({url:"/tools/packages/cws_ecommerce/getProceedToCheckoutLink",type:"post",data:{},success:function(data){$("#mini-cart-checkout-btn").attr("href",data)},error:function(data){console.error(data)},cache:!1})},self.updateQtyInLink=function(){$("#cartQty").text("("+qty+")")},self.updatePopupBody=function(){var $modal=$("#cart.reveal-modal"),html="",subtotal=0;if($modal.find(".qty-summary .qty").html(qty),$modal.find(".qty-summary .unit").html(1===qty?"item":"items"),items.forEach(function(item){var product=item.product,qty=item.quantity,isbn=item.sku,title=product.name,format=product.custom10,price=0,attrName="pubPrice";attrName+="CA"===Locale.countryCode?"Canada_"+Locale.region:"NZ"===Locale.countryCode?"Nzd_"+Locale.region:"_"+Locale.region;for(var i=0;i<product.customAttrArray.length;i++){var attr=product.customAttrArray[i];if(attr.name===attrName){price=parseFloat(attr.value),subtotal+=price*qty;break}}html+='<div class="item"><h4><a href="/'+isbn+'">'+title+'</a></h4><p class="authors"></p><p class="format">'+format+'</p><p class="qty">Quantity: '+qty+'</p><p class="unit-total">Price: '+Locale.currencySymbol+Cambridge.formatPrice(price)+"</p></div>"}),self.getHasIoProduct()){var orderRequestFormUrl="/education/order_request_form",checkoutBtnHref="cambridgeenglish"===CURRENT_SITE?"#":orderRequestFormUrl;$modal.find(".buttons .button.viewCart").attr("href",orderRequestFormUrl),$modal.find(".buttons .button.checkout").attr("href",checkoutBtnHref)}else{var checkoutBtnHref="cambridgeenglish"===CURRENT_SITE?"#":"/cart";$modal.find(".buttons .button.viewCart").attr("href","/cart"),$modal.find(".buttons .button.checkout").attr("href",checkoutBtnHref)}$modal.find(".items").html(html),$modal.find(".subtotal .currency").html(Locale.currencySymbol),$modal.find(".subtotal .value").html(Cambridge.formatPrice(subtotal)),$modal.find(".subtotal").removeClass("hide"),$modal.find(".buttons").removeClass("hide")},self.getQuantity=function(){return qty},self.getItems=function(){return items},self.getItemById=function(id){for(var i=0;i<items.length;i++){var item=items[i];if(item.id===id)return item}},self.getHasIoProduct=function(){return hasIoProduct},self.setHasIoProduct=function(value){hasIoProduct=value};var getRightHandSideButtonHtml=function(){var html="";switch(CURRENT_SITE){case"cambridgeenglish":html='<a href="#" class="button blue large checkout academicCheckout" id="mini-cart-checkout-btn">Continue shopping</a>';break;case"education":html='<a href="/cart" class="button green large checkout academicCheckout" id="mini-cart-checkout-btn">Checkout</a>';break;default:html='<a href="/cart" class="button orange large checkout academicCheckout" id="mini-cart-checkout-btn">Checkout</a>'}return html}};$(function(){$("#cart_button").length>0&&MiniCart.init(),$("#mini-cart-checkout-btn").click(function(e){"#"===$(this).attr("href")&&(e.preventDefault(),$("#cart.reveal-modal").trigger("reveal:close"))})})}if(CWS_ECOMMERCE_ENABLED){var alreadyClicked=!1,AddToCartButton=new function(){var self=this;self.educPreventMixedBasket=function(ecommType){var qty=MiniCart.getQuantity();return qty>0&&ecommType!==EDUCATION_CART?("asp"===ecommType?$("#addToCartCustom p").html("Physical product, such as a book or CD-ROM cannot be added to your cart with an Elevate Fully Digital product already in your cart. Please proceed with your purchase of Elevate Fully Digital product as a separate order."):$("#addToCartCustom p").html("Elevate Fully Digital product cannot be added to your cart with a product of a different type already in your cart. Please proceed with your purchase of Elevate Fully Digital product as a separate order."),$("#addToCartCustom p").css("text-transform","none"),$("#addToCartCustom").reveal(),self.onSendXhrComplete(),!0):0==qty&&"asp"===ecommType||qty>0&&"asp"===EDUCATION_CART&&"asp"===ecommType?"asp":!1},self.sendXhr=function(isbn,qty,discountCode){$.ajax({url:"/tools/packages/cws_ecommerce/addToBasketWithOptions",type:"post",data:{isbn:isbn,qty:qty,discountCode:discountCode},success:function(data){MiniCart.setHasIoProduct(data.hasIoProduct),MiniCart.getItemsFromKk().then(function(){return new Promise(function(resolve,reject){0===MiniCart.getQuantity()?reject():(MiniCart.updateQtyInLink(),MiniCart.updatePopupBody(),resolve())})})["catch"](function(msg){MiniCart.updateQtyInLink(),msg&&console.warn(msg)}),self.eltGtmCallback(isbn),$("#itemAddedMessage").text("Item added to your cart!");var orderRequestFormUrl="/education/order_request_form",viewCartBtnHref=data.hasIoProduct?orderRequestFormUrl:"/cart";$("#itemAddedModal .button.viewCart").attr("href",viewCartBtnHref),$("#itemAddedModal").reveal()},error:function(data){var selector="h4";"education"===CURRENT_SITE&&(selector="p");var textContainer=$("#addToCartCustom "+selector);textContainer.html(data.responseText),textContainer.css("text-transform","none"),$("#addToCartCustom").reveal()},complete:self.onSendXhrComplete})},self.eltGtmCallback=function(isbn){try{var gtm=new GoogleTagManager;$.isFunction(gtm.addToCart)&&$.post("/tools/packages/cambridge_core/titleService",{isbn:isbn,data:"gtm_data"},function(data){gtm.addToCart(data)})}catch(err){return}},self.onSendXhrComplete=function(){alreadyClicked=!1,countryChange=!0,$("body").css("cursor","auto")}},cwsAddToCartEvent=function(e){if(e.preventDefault(),!alreadyClicked){alreadyClicked=!0;var isbn=$(this).data("isbn"),qty=1;void 0!==$(this).data("qty")&&(qty=parseInt($(this).data("qty")));var page="";void 0!==$(this).data("page")&&(page=$(this).data("page")),$("body").css("cursor","wait");var discountCode=$(this).data("discountcode"),educCart=$(this).data("educationcart");void 0!==educCart?AddToCartButton.educPreventMixedBasket(educCart)===!1?AddToCartButton.sendXhr(isbn,qty,discountCode):"asp"===AddToCartButton.educPreventMixedBasket(educCart)&&(window.location.href=$(this).attr("href")):AddToCartButton.sendXhr(isbn,qty,discountCode)}},paymentContinueShoppingButton=function(){$.ajax({url:"/tools/packages/cws_ecommerce/paymentContinueShoppingButton",type:"post",data:{},success:function(data){window.location.href=data.url}})};$(function(){$(".addToCartBtn").on("click",cwsAddToCartEvent),$("#addToCartCustom").on("click","a.continue-shopping",paymentContinueShoppingButton)})}if(CWS_ECOMMERCE_ENABLED)var Cambridge=new function(){var self=this;self.getCookie=function(name){var dc=document.cookie,prefix=name+"=",begin=dc.indexOf("; "+prefix);if(-1==begin){if(begin=dc.indexOf(prefix),0!=begin)return null}else{begin+=2;var end=document.cookie.indexOf(";",begin);-1==end&&(end=dc.length)}return unescape(dc.substring(begin+prefix.length,end))},self.setCookie=function(name,value,ttl){if(name||value){ttl=ttl||1;var d=new Date;d.setTime(d.getTime()+60*ttl*60*1e3);var expires="expires="+d.toUTCString();document.cookie=name+"="+value+"; "+expires+"; path=/"}},self.getJacket=function(isbn,isLarge){return isLarge=isLarge||!1,"https://assets.cambridge.org/"+isbn.substring(0,8)+"/"+isbn.substring(8,13)+"/"+(isLarge?"large_":"")+"cover/"+isbn+(isLarge?"i":"")+".jpg"},self.formatPrice=function(val){return val.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}};